%--------------------------------------------------------
\subsection{Pricing Engines: {\tt pricingengine.xml}}
%--------------------------------------------------------
\label{sec:configuration_pricingengines}

The pricing engine configuration file is provided to select pricing models and pricing engines by product type.

%--------------------------------------------------------
\subsubsection{Product Type: EuropeanSwaption}
%--------------------------------------------------------

Used by trade type: Swaption, for European exercise on vanilla underlying coupon types

Available Model/Engine pairs:

\begin{itemize}
\item BlackBachelier/BlackBachelierSwaptionEngine
\item LGM/Grid
\item LGM/FD
\item LGM/MC
\item LGM/AMC
\end{itemize}

Engine description:

BlackBachelier/BlackBachelierSwaptionEngine builds a BlackMultiLegOptionEngine . A sample configuration is shown in
listing \ref{lst:peconfig_EuropeanSwaption_BlackBachelier_BlackBachelierSwaptionEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EuropeanSwaption">
    <Model>BlackBachelier</Model>
    <ModelParameters/>
    <Engine>BlackBachelierSwaptionEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EuropeanSwaption, Model BlackBachelier, Engine BlackBachelierSwaptionEngine}
\label{lst:peconfig_EuropeanSwaption_BlackBachelier_BlackBachelierSwaptionEngine}
\end{longlisting}

LGM/Grid builds a NumericLgmMultiLegOptionEngine using LgmConvoluationSolver as a solver. The rollback follows the paper
``Hagan, P: Methodology for callable swaps and Bermudan exercise into swaptions''. A sample configuration is shown in
listing \ref{lst:peconfig_EuropeanSwaption_LGM_Grid}

The parameters have the following meaning:

\begin{itemize}
\item Calibration: Bootstrap, BestFit, None
\item CalibrationStrategy: CoterminalDealStrike, CoterminalATM
\item ReferenceCalibrationGrid: An optional grid, only one calibration instrument per interval is kept
\item Reversion: The mean reversion
\item ReversionType: Hagan, HullWhite
\item Volatility: The volatility (start value for calibration if calibrated)
\item VolatilityType: Hagan, HullWhite
\item ShiftHorizon: Shift horizon for LGM model as fraction of deal maturity
\item Tolerance: Error tolerance for calibration
\item sy, sx: Number of covered standard deviations (notation as in Hagan's paper)
\item ny, nx: Number of grid points for numerical integration (notation as in Hagan's paper)
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EuropeanSwaption">
    <Model>LGM</Model>
    <ModelParameters>
        <Parameter name="Calibration">Bootstrap</Parameter>
        <Parameter name="CalibrationStrategy">CoterminalDealStrike</Parameter>
        <Parameter name="ReferenceCalibrationGrid">400,3M</Parameter>
        <Parameter name="Reversion">0.0</Parameter>
        <Parameter name="ReversionType">HullWhite</Parameter>
        <Parameter name="Volatility">0.01</Parameter>
        <Parameter name="VolatilityType">Hagan</Parameter>
        <Parameter name="ShiftHorizon">0.5</Parameter>
        <Parameter name="Tolerance">0.20</Parameter>
    </ModelParameters>
    <Engine>Grid</Engine>
    <EngineParameters>
        <Parameter name="sy">5.0</Parameter>
        <Parameter name="ny">30</Parameter>
        <Parameter name="sx">5.0</Parameter>
        <Parameter name="nx">30</Parameter>
        <Parameter name="SensitivityTemplate">IR_FD</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EuropeanSwaption, Model LGM, Engine Grid}
\label{lst:peconfig_EuropeanSwaption_LGM_Grid}
\end{longlisting}

LGM/FD builds a NumericLgmMultiLegOptionEngine using LgmFdSolver as a solver using finite difference. A sample
configuration is shown in listing \ref{lst:peconfig_EuropeanSwaption_LGM_FD}

The parameters have the following meaning:

\begin{itemize}
\item Calibration: Bootstrap, BestFit, None
\item CalibrationStrategy: CoterminalDealStrike, CoterminalATM
\item ReferenceCalibrationGrid: An optional grid, only one calibration instrument per interval is kept
\item Reversion: The mean reversion
\item ReversionType: Hagan, HullWhite
\item Volatility: The volatility (start value for calibration if calibrated)
\item VolatilityType: Hagan, HullWhite
\item ShiftHorizon: Shift horizon for LGM model as fraction of deal maturity
\item Tolerance: Error tolerance for calibration
\item Scheme: The finite difference scheme to use
\item StateGridPoints: The number of grid points in state direction
\item TimeStepsPerYear: The number of time steps per year to use
\item MesherEpsilon: determines the covered probability mass, mass outside state grid is $\Phi^{-1}(1-2\epsilon)$
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EuropeanSwaption">
    <Model>LGM</Model>
    <ModelParameters>
        <Parameter name="Calibration">Bootstrap</Parameter>
        <Parameter name="CalibrationStrategy">CoterminalDealStrike</Parameter>
        <Parameter name="ReferenceCalibrationGrid">400,3M</Parameter>
        <Parameter name="Reversion">0.0</Parameter>
        <Parameter name="ReversionType">HullWhite</Parameter>
        <Parameter name="Volatility">0.01</Parameter>
        <Parameter name="VolatilityType">Hagan</Parameter>
        <Parameter name="ShiftHorizon">0.5</Parameter>
        <Parameter name="Tolerance">0.20</Parameter>
    </ModelParameters>
    <Engine>FD</Engine>
        <EngineParameters>
            <Parameter name="Scheme">Douglas</Parameter>
            <Parameter name="StateGridPoints">64</Parameter>
            <Parameter name="TimeStepsPerYear">24</Parameter>
            <Parameter name="MesherEpsilon">1E-4</Parameter>
        </EngineParameters>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EuropeanSwaption, Model LGM, Engine FD}
\label{lst:peconfig_EuropeanSwaption_LGM_FD}
\end{longlisting}

LGM/MC builds a McMultiLegOptionEngine. A sample configuration is shown in
listing \ref{lst:peconfig_EuropeanSwaption_LGM_MC}

The parameters have the following meaning:

\begin{itemize}
\item Calibration: Bootstrap, BestFit, None
\item CalibrationStrategy: CoterminalDealStrike, CoterminalATM
\item ReferenceCalibrationGrid: An optional grid, only one calibration instrument per interval is kept
\item Reversion: The mean reversion
\item ReversionType: Hagan, HullWhite
\item Volatility: The volatility (start value for calibration if calibrated)
\item VolatilityType: Hagan, HullWhite
\item ShiftHorizon: Shift horizon for LGM model as fraction of deal maturity
\item Tolerance: Error tolerance for calibration
\item Training.Sequence: The sequence type for the traning phase, can be MersenneTwister+, MersenneTwisterAntithetc+,
  Sobol+, Burley2020Sobol+, SobolBrownianBridge+, Burley2020SobolBrownianBridge+
\item Training.Seed: The seed for the random number generation in the training phase
\item Training.Samples: The number of samples to be used for the training phase
\item Pricing.Sequence: The sequence type for the pricing phase, same values allowed as for training
\item Training.BasisFunction: The type of basis function system to be used for the regression analysis, can be
  Monomial+, Laguerre+, Hermite+, Hyperbolic+, Legendre+, Chbyshev+, Chebyshev2nd+
\item BasisFunctionOrder: The order of the basis function system to be used
\item Pricing.Seed: The seed for the random number generation in the pricing
\item Pricing.Samples: The number of samples to be used for the pricing phase. If this number is zero, no pricing run is
  performed, instead the (T0) NPV is estimated from the training phase (this result is used to fill the T0 slice of the
  NPV cube)
\item BrownianBridgeOrdering: variate ordering for Brownian bridges, can be Steps+, Factors+, Diagonal+
\item SobolDirectionIntegers: direction integers for Sobol generator, can be Unit+, Jaeckel+, SobolLevitan+,
  SobolLevitanLemieux+, JoeKuoD5+, JoeKuoD6+, JoeKuoD7+, Kuo+, Kuo2+, Kuo3+
\item MinObsDate: if true the conditional expectation of each cashflow is taken from the minimum possible observation
  date (i.e. the latest exercise or simulation date before the cashflow's event date); recommended setting is true+
\item RegressorModel: Simple, LaggedFX. If not given, it defaults to Simple. Depending on the choice the regressor is
  built as follows:
  \begin{itemize}
    \item Simple: For an observation date the full model state observed on this date is included in the regressor. No
      past states are included though.
    \item LaggedFX: For an observation date the full model state observed on this date is included in the regressor. In
      addition, past FX states that are relevant for future cashflows are included. For example, for a FX resettable
      cashflow the FX state observed on the FX reset date is included.
  \end{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EuropeanSwaption">
    <Model>LGM</Model>
    <ModelParameters>
        <Parameter name="Calibration">Bootstrap</Parameter>
        <Parameter name="CalibrationStrategy">CoterminalDealStrike</Parameter>
        <Parameter name="ReferenceCalibrationGrid">400,3M</Parameter>
        <Parameter name="Reversion">0.0</Parameter>
        <Parameter name="ReversionType">HullWhite</Parameter>
        <Parameter name="Volatility">0.01</Parameter>
        <Parameter name="VolatilityType">Hagan</Parameter>
        <Parameter name="ShiftHorizon">0.5</Parameter>
        <Parameter name="Tolerance">0.20</Parameter>
    </ModelParameters>
    <Engine>MC</Engine>
    <EngineParameters>
            <Parameter name="Training.Sequence">MersenneTwisterAntithetic</Parameter>
            <Parameter name="Training.Seed">42</Parameter>
            <Parameter name="Training.Samples">10000</Parameter>
            <Parameter name="Training.BasisFunction">Monomial</Parameter>
            <Parameter name="Training.BasisFunctionOrder">6</Parameter>
            <Parameter name="Pricing.Sequence">SobolBrownianBridge</Parameter>
            <Parameter name="Pricing.Seed">17</Parameter>
            <Parameter name="Pricing.Samples">0</Parameter>
            <Parameter name="BrownianBridgeOrdering">Steps</Parameter>
            <Parameter name="SobolDirectionIntegers">JoeKuoD7</Parameter>
            <Parameter name="MinObsDate">true</Parameter>
            <Parameter name="RegressorModel">Simple</Parameter>
            <Parameter name="SensitivityTemplate">IR_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EuropeanSwaption, Model BlackBachelier, Engine BlackBachelierSwaptionEngine}
\label{lst:peconfig_EuropeanSwaption_LGM_MC}
\end{longlisting}

LGM/AMC builds a McMultiLegOptionEngine for use in AMC simulations. We refer to the AMC module documentation for further
details.

%--------------------------------------------------------
\subsubsection{Product Type: BermudanSwaption}
%--------------------------------------------------------

Used by trade type: Swaption, for Bermudan exercise on vanilla underlying coupon types

Available Model/Engine pairs:

\begin{itemize}
\item LGM/Grid
\item LGM/FD
\item LGM/MC
\item LGM/AMC
\end{itemize}

Engine description:

LGM/Grid builds a NumericLgmMultiLegOptionEngine using LgmConvoluationSolver as a solver. The rollback follows the paper
``Hagan, P: Methodology for callable swaps and Bermudan exercise into swaptions''. A sample configuration is shown in
listing \ref{lst:peconfig_BermudanSwaption_LGM_Grid}

The parameters have the following meaning:

\begin{itemize}
\item Calibration: Bootstrap, BestFit, None
\item CalibrationStrategy: CoterminalDealStrike, CoterminalATM
\item ReferenceCalibrationGrid: An optional grid, only one calibration instrument per interval is kept
\item Reversion: The mean reversion
\item ReversionType: Hagan, HullWhite
\item Volatility: The volatility (start value for calibration if calibrated)
\item VolatilityType: Hagan, HullWhite
\item ShiftHorizon: Shift horizon for LGM model as fraction of deal maturity
\item Tolerance: Error tolerance for calibration
\item sy, sx: Number of covered standard deviations (notation as in Hagan's paper)
\item ny, nx: Number of grid points for numerical integration (notation as in Hagan's paper)
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="BermudanSwaption">
    <Model>LGM</Model>
    <ModelParameters>
        <Parameter name="Calibration">Bootstrap</Parameter>
        <Parameter name="CalibrationStrategy">CoterminalDealStrike</Parameter>
        <Parameter name="ReferenceCalibrationGrid">400,3M</Parameter>
        <Parameter name="Reversion">0.0</Parameter>
        <Parameter name="ReversionType">HullWhite</Parameter>
        <Parameter name="Volatility">0.01</Parameter>
        <Parameter name="VolatilityType">Hagan</Parameter>
        <Parameter name="ShiftHorizon">0.5</Parameter>
        <Parameter name="Tolerance">0.20</Parameter>
    </ModelParameters>
    <Engine>Grid</Engine>
    <EngineParameters>
        <Parameter name="sy">5.0</Parameter>
        <Parameter name="ny">30</Parameter>
        <Parameter name="sx">5.0</Parameter>
        <Parameter name="nx">30</Parameter>
        <Parameter name="SensitivityTemplate">IR_FD</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product BermudanSwaption, Model LGM, Engine Grid}
\label{lst:peconfig_BermudanSwaption_LGM_Grid}
\end{longlisting}

LGM/FD builds a NumericLgmMultiLegOptionEngine using LgmFdSolver as a solver using finite difference. A sample
configuration is shown in listing \ref{lst:peconfig_BermudanSwaption_LGM_FD}

The parameters have the following meaning:

\begin{itemize}
\item Calibration: Bootstrap, BestFit, None
\item CalibrationStrategy: CoterminalDealStrike, CoterminalATM
\item ReferenceCalibrationGrid: An optional grid, only one calibration instrument per interval is kept
\item Reversion: The mean reversion
\item ReversionType: Hagan, HullWhite
\item Volatility: The volatility (start value for calibration if calibrated)
\item VolatilityType: Hagan, HullWhite
\item ShiftHorizon: Shift horizon for LGM model as fraction of deal maturity
\item Tolerance: Error tolerance for calibration
\item Scheme: The finite difference scheme to use
\item StateGridPoints: The number of grid points in state direction
\item TimeStepsPerYear: The number of time steps per year to use
\item MesherEpsilon: determines the covered probability mass, mass outside state grid is $\Phi^{-1}(1-2\epsilon)$
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="BermudanSwaption">
    <Model>LGM</Model>
    <ModelParameters>
        <Parameter name="Calibration">Bootstrap</Parameter>
        <Parameter name="CalibrationStrategy">CoterminalDealStrike</Parameter>
        <Parameter name="ReferenceCalibrationGrid">400,3M</Parameter>
        <Parameter name="Reversion">0.0</Parameter>
        <Parameter name="ReversionType">HullWhite</Parameter>
        <Parameter name="Volatility">0.01</Parameter>
        <Parameter name="VolatilityType">Hagan</Parameter>
        <Parameter name="ShiftHorizon">0.5</Parameter>
        <Parameter name="Tolerance">0.20</Parameter>
    </ModelParameters>
    <Engine>FD</Engine>
        <EngineParameters>
            <Parameter name="Scheme">Douglas</Parameter>
            <Parameter name="StateGridPoints">64</Parameter>
            <Parameter name="TimeStepsPerYear">24</Parameter>
            <Parameter name="MesherEpsilon">1E-4</Parameter>
        </EngineParameters>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product BermudanSwaption, Model LGM, Engine FD}
\label{lst:peconfig_BermudanSwaption_LGM_FD}
\end{longlisting}

LGM/MC builds a McMultiLegOptionEngine. A sample configuration is shown in
listing \ref{lst:peconfig_BermudanSwaption_LGM_MC}

The parameters have the following meaning:

\begin{itemize}
\item Calibration: Bootstrap, BestFit, None
\item CalibrationStrategy: CoterminalDealStrike, CoterminalATM
\item ReferenceCalibrationGrid: An optional grid, only one calibration instrument per interval is kept
\item Reversion: The mean reversion
\item ReversionType: Hagan, HullWhite
\item Volatility: The volatility (start value for calibration if calibrated)
\item VolatilityType: Hagan, HullWhite
\item ShiftHorizon: Shift horizon for LGM model as fraction of deal maturity
\item Tolerance: Error tolerance for calibration
\item Training.Sequence: The sequence type for the traning phase, can be MersenneTwister+, MersenneTwisterAntithetc+,
  Sobol+, Burley2020Sobol+, SobolBrownianBridge+, Burley2020SobolBrownianBridge+
\item Training.Seed: The seed for the random number generation in the training phase
\item Training.Samples: The number of samples to be used for the training phase
\item Pricing.Sequence: The sequence type for the pricing phase, same values allowed as for training
\item Training.BasisFunction: The type of basis function system to be used for the regression analysis, can be
  Monomial+, Laguerre+, Hermite+, Hyperbolic+, Legendre+, Chbyshev+, Chebyshev2nd+
\item BasisFunctionOrder: The order of the basis function system to be used
\item Pricing.Seed: The seed for the random number generation in the pricing
\item Pricing.Samples: The number of samples to be used for the pricing phase. If this number is zero, no pricing run is
  performed, instead the (T0) NPV is estimated from the training phase (this result is used to fill the T0 slice of the
  NPV cube)
\item BrownianBridgeOrdering: variate ordering for Brownian bridges, can be Steps+, Factors+, Diagonal+
\item SobolDirectionIntegers: direction integers for Sobol generator, can be Unit+, Jaeckel+, SobolLevitan+,
  SobolLevitanLemieux+, JoeKuoD5+, JoeKuoD6+, JoeKuoD7+, Kuo+, Kuo2+, Kuo3+
\item MinObsDate: if true the conditional expectation of each cashflow is taken from the minimum possible observation
  date (i.e. the latest exercise or simulation date before the cashflow's event date); recommended setting is true+
\item RegressorModel: Simple, LaggedFX. If not given, it defaults to Simple. Depending on the choice the regressor is
  built as follows:
  \begin{itemize}
    \item Simple: For an observation date the full model state observed on this date is included in the regressor. No
      past states are included though.
    \item LaggedFX: For an observation date the full model state observed on this date is included in the regressor. In
      addition, past FX states that are relevant for future cashflows are included. For example, for a FX resettable
      cashflow the FX state observed on the FX reset date is included.
  \end{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="BermudanSwaption">
    <Model>LGM</Model>
    <ModelParameters>
        <Parameter name="Calibration">Bootstrap</Parameter>
        <Parameter name="CalibrationStrategy">CoterminalDealStrike</Parameter>
        <Parameter name="ReferenceCalibrationGrid">400,3M</Parameter>
        <Parameter name="Reversion">0.0</Parameter>
        <Parameter name="ReversionType">HullWhite</Parameter>
        <Parameter name="Volatility">0.01</Parameter>
        <Parameter name="VolatilityType">Hagan</Parameter>
        <Parameter name="ShiftHorizon">0.5</Parameter>
        <Parameter name="Tolerance">0.20</Parameter>
    </ModelParameters>
    <Engine>MC</Engine>
    <EngineParameters>
            <Parameter name="Training.Sequence">MersenneTwisterAntithetic</Parameter>
            <Parameter name="Training.Seed">42</Parameter>
            <Parameter name="Training.Samples">10000</Parameter>
            <Parameter name="Training.BasisFunction">Monomial</Parameter>
            <Parameter name="Training.BasisFunctionOrder">6</Parameter>
            <Parameter name="Pricing.Sequence">SobolBrownianBridge</Parameter>
            <Parameter name="Pricing.Seed">17</Parameter>
            <Parameter name="Pricing.Samples">0</Parameter>
            <Parameter name="BrownianBridgeOrdering">Steps</Parameter>
            <Parameter name="SobolDirectionIntegers">JoeKuoD7</Parameter>
            <Parameter name="MinObsDate">true</Parameter>
            <Parameter name="RegressorModel">Simple</Parameter>
            <Parameter name="SensitivityTemplate">IR_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product BermudanSwaption, Model BlackBachelier, Engine BlackBachelierSwaptionEngine}
\label{lst:peconfig_BermudanSwaption_LGM_MC}
\end{longlisting}

LGM/AMC builds a McMultiLegOptionEngine for use in AMC simulations. We refer to the AMC module documentation for further
details.

%--------------------------------------------------------
\subsubsection{Product Type: AmericanSwaption}
%--------------------------------------------------------

Used by trade type: Swaption, for American exercise on vanilla underlying coupon types

Available Model/Engine pairs:

\begin{itemize}
\item LGM/FD
\item LGM/Grid (Not recommended due to inferior performance)
\item LGM/MC
\item LGM/AMC
\end{itemize}

Engine description:

LGM/FD builds a NumericLgmMultiLegOptionEngine using LgmFdSolver as a solver using finite difference. A sample
configuration is shown in listing \ref{lst:peconfig_AmericanSwaption_LGM_FD}

The parameters have the following meaning:

\begin{itemize}
\item Calibration: Bootstrap, BestFit, None
\item CalibrationStrategy: CoterminalDealStrike, CoterminalATM
\item ReferenceCalibrationGrid: An optional grid, only one calibration instrument per interval is kept
\item Reversion: The mean reversion
\item ReversionType: Hagan, HullWhite
\item Volatility: The volatility (start value for calibration if calibrated)
\item VolatilityType: Hagan, HullWhite
\item ShiftHorizon: Shift horizon for LGM model as fraction of deal maturity
\item Tolerance: Error tolerance for calibration
\item Scheme: The finite difference scheme to use
\item StateGridPoints: The number of grid points in state direction
\item TimeStepsPerYear: The number of time steps per year to use
\item MesherEpsilon: determines the covered probability mass, mass outside state grid is $\Phi^{-1}(1-2\epsilon)$
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="AmericanSwaption">
    <Model>LGM</Model>
    <ModelParameters>
        <Parameter name="Calibration">Bootstrap</Parameter>
        <Parameter name="CalibrationStrategy">CoterminalDealStrike</Parameter>
        <Parameter name="ReferenceCalibrationGrid">400,3M</Parameter>
        <Parameter name="Reversion">0.0</Parameter>
        <Parameter name="ReversionType">HullWhite</Parameter>
        <Parameter name="Volatility">0.01</Parameter>
        <Parameter name="VolatilityType">Hagan</Parameter>
        <Parameter name="ShiftHorizon">0.5</Parameter>
        <Parameter name="Tolerance">0.20</Parameter>
    </ModelParameters>
    <Engine>FD</Engine>
        <EngineParameters>
            <Parameter name="Scheme">Douglas</Parameter>
            <Parameter name="StateGridPoints">64</Parameter>
            <Parameter name="TimeStepsPerYear">24</Parameter>
            <Parameter name="MesherEpsilon">1E-4</Parameter>
        </EngineParameters>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product AmericanSwaption, Model LGM, Engine FD}
\label{lst:peconfig_AmericanSwaption_LGM_FD}
\end{longlisting}

LGM/Grid builds a NumericLgmMultiLegOptionEngine using LgmConvoluationSolver as a solver. The rollback follows the paper
``Hagan, P: Methodology for callable swaps and American exercise into swaptions''. A sample configuration is shown in
listing \ref{lst:peconfig_AmericanSwaption_LGM_Grid}. Not recommended due to inferior performance.

The parameters have the following meaning:

\begin{itemize}
\item Calibration: Bootstrap, BestFit, None
\item CalibrationStrategy: CoterminalDealStrike, CoterminalATM
\item ReferenceCalibrationGrid: An optional grid, only one calibration instrument per interval is kept
\item Reversion: The mean reversion
\item ReversionType: Hagan, HullWhite
\item Volatility: The volatility (start value for calibration if calibrated)
\item VolatilityType: Hagan, HullWhite
\item ShiftHorizon: Shift horizon for LGM model as fraction of deal maturity
\item Tolerance: Error tolerance for calibration
\item sy, sx: Number of covered standard deviations (notation as in Hagan's paper)
\item ny, nx: Number of grid points for numerical integration (notation as in Hagan's paper)
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="AmericanSwaption">
    <Model>LGM</Model>
    <ModelParameters>
        <Parameter name="Calibration">Bootstrap</Parameter>
        <Parameter name="CalibrationStrategy">CoterminalDealStrike</Parameter>
        <Parameter name="ReferenceCalibrationGrid">400,3M</Parameter>
        <Parameter name="Reversion">0.0</Parameter>
        <Parameter name="ReversionType">HullWhite</Parameter>
        <Parameter name="Volatility">0.01</Parameter>
        <Parameter name="VolatilityType">Hagan</Parameter>
        <Parameter name="ShiftHorizon">0.5</Parameter>
        <Parameter name="Tolerance">0.20</Parameter>
    </ModelParameters>
    <Engine>Grid</Engine>
    <EngineParameters>
        <Parameter name="sy">5.0</Parameter>
        <Parameter name="ny">30</Parameter>
        <Parameter name="sx">5.0</Parameter>
        <Parameter name="nx">30</Parameter>
        <Parameter name="SensitivityTemplate">IR_FD</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product AmericanSwaption, Model LGM, Engine Grid (Not recommended due to inferior performance)}
\label{lst:peconfig_AmericanSwaption_LGM_Grid}
\end{longlisting}

LGM/MC builds a McMultiLegOptionEngine. A sample configuration is shown in
listing \ref{lst:peconfig_AmericanSwaption_LGM_MC}

The parameters have the following meaning:

\begin{itemize}
\item Calibration: Bootstrap, BestFit, None
\item CalibrationStrategy: CoterminalDealStrike, CoterminalATM
\item ReferenceCalibrationGrid: An optional grid, only one calibration instrument per interval is kept
\item Reversion: The mean reversion
\item ReversionType: Hagan, HullWhite
\item Volatility: The volatility (start value for calibration if calibrated)
\item VolatilityType: Hagan, HullWhite
\item ShiftHorizon: Shift horizon for LGM model as fraction of deal maturity
\item Tolerance: Error tolerance for calibration
\item Training.Sequence: The sequence type for the traning phase, can be MersenneTwister+, MersenneTwisterAntithetc+,
  Sobol+, Burley2020Sobol+, SobolBrownianBridge+, Burley2020SobolBrownianBridge+
\item Training.Seed: The seed for the random number generation in the training phase
\item Training.Samples: The number of samples to be used for the training phase
\item Pricing.Sequence: The sequence type for the pricing phase, same values allowed as for training
\item Training.BasisFunction: The type of basis function system to be used for the regression analysis, can be
  Monomial+, Laguerre+, Hermite+, Hyperbolic+, Legendre+, Chbyshev+, Chebyshev2nd+
\item BasisFunctionOrder: The order of the basis function system to be used
\item Pricing.Seed: The seed for the random number generation in the pricing
\item Pricing.Samples: The number of samples to be used for the pricing phase. If this number is zero, no pricing run is
  performed, instead the (T0) NPV is estimated from the training phase (this result is used to fill the T0 slice of the
  NPV cube)
\item BrownianBridgeOrdering: variate ordering for Brownian bridges, can be Steps+, Factors+, Diagonal+
\item SobolDirectionIntegers: direction integers for Sobol generator, can be Unit+, Jaeckel+, SobolLevitan+,
  SobolLevitanLemieux+, JoeKuoD5+, JoeKuoD6+, JoeKuoD7+, Kuo+, Kuo2+, Kuo3+
\item MinObsDate: if true the conditional expectation of each cashflow is taken from the minimum possible observation
  date (i.e. the latest exercise or simulation date before the cashflow's event date); recommended setting is true+
\item RegressorModel: Simple, LaggedFX. If not given, it defaults to Simple. Depending on the choice the regressor is
  built as follows:
  \begin{itemize}
    \item Simple: For an observation date the full model state observed on this date is included in the regressor. No
      past states are included though.
    \item LaggedFX: For an observation date the full model state observed on this date is included in the regressor. In
      addition, past FX states that are relevant for future cashflows are included. For example, for a FX resettable
      cashflow the FX state observed on the FX reset date is included.
  \end{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="AmericanSwaption">
    <Model>LGM</Model>
    <ModelParameters>
        <Parameter name="Calibration">Bootstrap</Parameter>
        <Parameter name="CalibrationStrategy">CoterminalDealStrike</Parameter>
        <Parameter name="ReferenceCalibrationGrid">400,3M</Parameter>
        <Parameter name="Reversion">0.0</Parameter>
        <Parameter name="ReversionType">HullWhite</Parameter>
        <Parameter name="Volatility">0.01</Parameter>
        <Parameter name="VolatilityType">Hagan</Parameter>
        <Parameter name="ShiftHorizon">0.5</Parameter>
        <Parameter name="Tolerance">0.20</Parameter>
    </ModelParameters>
    <Engine>MC</Engine>
    <EngineParameters>
            <Parameter name="Training.Sequence">MersenneTwisterAntithetic</Parameter>
            <Parameter name="Training.Seed">42</Parameter>
            <Parameter name="Training.Samples">10000</Parameter>
            <Parameter name="Training.BasisFunction">Monomial</Parameter>
            <Parameter name="Training.BasisFunctionOrder">6</Parameter>
            <Parameter name="Pricing.Sequence">SobolBrownianBridge</Parameter>
            <Parameter name="Pricing.Seed">17</Parameter>
            <Parameter name="Pricing.Samples">0</Parameter>
            <Parameter name="BrownianBridgeOrdering">Steps</Parameter>
            <Parameter name="SobolDirectionIntegers">JoeKuoD7</Parameter>
            <Parameter name="MinObsDate">true</Parameter>
            <Parameter name="RegressorModel">Simple</Parameter>
            <Parameter name="SensitivityTemplate">IR_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product AmericanSwaption, Model BlackBachelier, Engine BlackBachelierSwaptionEngine}
\label{lst:peconfig_AmericanSwaption_LGM_MC}
\end{longlisting}

LGM/AMC builds a McMultiLegOptionEngine for use in AMC simulations. We refer to the AMC module documentation for further
details.

%--------------------------------------------------------
\subsubsection{Product Type: BondRepo}
%--------------------------------------------------------

Used by trade type: BondRepo

Available Model/Engine pairs:

\begin{itemize}
\item DiscountedCashflows/DiscountingRepoEngine
\item Accrual/AccrualRepoEngine
\end{itemize}

Engine description:

DiscountedCashflows/DiscountingRepoEngine builds a DiscountingBondRepoEngine. A sample configuration is shown in listing
\ref{lst:peconfig_BondRepo_DiscountedCashflows_DiscountingRepoEngine}.

The parameters have the following meaning:

\begin{itemize}
\item IncludeSecurityLeg: include the security leg in the valuation
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
   <Product type="BondRepo">
        <Model>DiscountedCashflows</Model>
        <ModelParameters>
            <Parameter name="IncludeSecurityLeg">true</Parameter>
        </ModelParameters>
        <Engine>DiscountingRepoEngine</Engine>
        <EngineParameters>
            <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
        </EngineParameters>
    </Product>
\end{minted}
\caption{Configuration for Product BondRepo, Model DiscountedCashflows, Engine DiscountingRepoEngine}
\label{lst:peconfig_BondRepo_DiscountedCashflows_DiscountingRepoEngine}
\end{longlisting}

Accrual/AccrualRepoEngine builds a AccrualBondRepoEngine. A sample configuration is shown in listing
\ref{lst:peconfig_BondRepo_Accrual_AccrualBondRepoEngine}.

The parameters have the following meaning:

\begin{itemize}
\item IncludeSecurityLeg: include the security leg in the valuation
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
   <Product type="BondRepo">
        <Model>Accrual</Model>
        <ModelParameters>
            <Parameter name="IncludeSecurityLeg">true</Parameter>
        </ModelParameters>
        <Engine>AccrualRepoEngine</Engine>
        <EngineParameters>
            <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
        </EngineParameters>
    </Product>
\end{minted}
\caption{Configuration for Product BondRepo, Model Accrual, Engine DiscountingBondRepoEngine}
\label{lst:peconfig_BondRepo_Accrual_AccrualBondRepoEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: BondTRS}
%--------------------------------------------------------

Used by trade type: BondTRS

Available Model/Engine pairs: DiscountedCashflows/DiscountingBondTRSEngine

Engine description:

DiscountedCashflows/DiscountingBondTRSEngine builds a DisountingBondTRSEngine. A sample configuration is shown in listing \ref{lst:peconfig_BondTRS_DiscountedCashflows_DiscountedCashflows/DiscountingBondTRSEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="BondTRS">
    <Model>DiscountedCashflows</Model>
    <ModelParameters/>
    <Engine>DiscountingBondTRSEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product BondTRS , Model DiscountedCashflows, Engine DiscountingBondTRSEngine}
\label{lst:peconfig_BondTRS_DiscountedCashflows_DiscountedCashflows/DiscountingBondTRSEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CapFloor}
%--------------------------------------------------------

Used by trade type: CapFloor on underlying Ibor with subperiods (all other underlying use their respective coupon pricers)

Available Model/Engine pairs: IborCapModel/IborCapEngine

Engine description:

IborCapModel/IborCapEngine builds a BlackCapFloorEngine or BachelierCapFloorEngine depending on the input volatility
type. A sample configuration is shown in listing \ref{lst:peconfig_CapFloor_IborCapModel_IborCapEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CapFloor">
    <Model>IborCapModel</Model>
    <ModelParameters/>
    <Engine>IborCapEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CapFloor, Model IborCapModel, Engine IborCapEngine}
\label{lst:peconfig_lst:peconfig_CapFloor_IborCapModel_IborCapEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CapFlooredOvernightIndexedCouponLeg}
%--------------------------------------------------------

Used by trade type: any trade with a cap / floored OIS leg

Available Model/Engine pairs: BlackOrBachelier/BlackOvernightIndexedCouponPricer

Engine description:

BlackOrBachelier/BlackOvernightIndexedCouponPricer builds a BlackOvernightIndexedCouponPricer. A sample configuration is
shown in listing \ref{lst:peconfig_CapFlooredOvernightIndexedCouponLeg_BlackOrBachelier_BlackOvernightIndexedCouponPricer}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CapFlooredOvernightIndexedCouponLeg">
    <Model>BlackOrBachelier</Model>
    <ModelParameters/>
    <Engine>BlackOvernightIndexedCouponPricer</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CapFlooredOvernightIndexedCouponLeg, Model BlackOrBachelier, Engine BlackOvernightIndexedCouponPricer}
\label{lst:peconfig_CapFlooredOvernightIndexedCouponLeg_BlackOrBachelier_BlackOvernightIndexedCouponPricer}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CappedFlooredCpiLegCoupons}
%--------------------------------------------------------

Used by trade type: any trade with a cap / floored CPI leg (coupons)

Available Model/Engine pairs: Black/BlackAnalytic

Engine description:

Black/BlackAnalytic builds a BlackCPICouponPricer or BachelierCPICouponPricer, depending on the volatility input. A sample configuration is
shown in listing \ref{lst:peconfig_CapFlooredCpiLegCoupons_Black_BlackAnalytic}

The parameters have the following meaning:

\begin{itemize}
\item useLastFixingDate: if true, use the last known fixing date as the base date of the volatility structure, otherwise
  use observation lag        
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CapFlooredCpiLegCoupons">
    <Model>Black</Model>
    <ModelParameters/>
    <Engine>BlackAnalytic</Engine>
    <EngineParameters>
          <Parameter name="useLastFixingDate">true</Parameter>
      <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CapFlooredCpiLegCoupons, Model Black, Engine BlackAnalytic}
\label{lst:peconfig_CapFlooredCpiLegCoupons_Black_BlackAnalytic}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CappedFlooredCpiLegCashFlows}
%--------------------------------------------------------

Used by trade type: any trade with a cap / floored CPI leg (cashflows)

Available Model/Engine pairs: Black/BlackAnalytic

Engine description:

Black/BlackAnalytic builds a BlackCPICashFLowPricer or BachelierCPICashFlowPricer, depending on the volatility input. A sample configuration is
shown in listing \ref{lst:peconfig_CappedFlooredCpiLegCashFlows_Black_BlackAnalytic}

The parameters have the following meaning:

\begin{itemize}
\item useLastFixingDate: if true, use the last known fixing date as the base date of the volatility structure, otherwise
  use observation lag        
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CappedFlooredCpiLegCashFlows">
    <Model>Black</Model>
    <ModelParameters/>
    <Engine>BlackAnalytic</Engine>
    <EngineParameters>
          <Parameter name="useLastFixingDate">true</Parameter>
      <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CapFlooredCpiLegCoupons, Model Black, Engine BlackAnalytic}
\label{lst:peconfig_CappedFlooredCpiLegCashFlows_Black_BlackAnalytic}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CpiCapFloor}
%--------------------------------------------------------

Used by trade type: CapFloor with underlying leg of leg type CPI.

Available Model/Engine pairs: CpiCapModel/CpiCapEngine

Engine description:

CpiCapModel/CpiCapEngine builds a CPIBlackCapFloorEngine or CPIBachelierCapFloorEngine depneding on the volatility type
of the market surface. A sample configuration is shown in listing
\ref{lst:peconfig_CpiCapFloor_CpiCapModel_CpiCapEngine}.

The parameters have the following meaning:

\begin{itemize}
\item useLastFixingDate: if true, use the last known fixing date as the base date of the volatility structure, otherwise
  use observation lag
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CpiCapFloor">
    <Model>CpiCapModel</Model>
    <ModelParameters/>
    <Engine>CpiCapEngine</Engine>
    <EngineParameters>
        <Parameter name="useLastFixingDate">true</Parameter>
        <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CpiCapFloor, Model CpiCapModel, Engine CpiCapEngine}
\label{lst:peconfig_CpiCapFloor_CpiCapModel_CpiCapEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CommodityAsianOptionArithmeticPrice}
%--------------------------------------------------------

Used by trade type: CommodityAsianOption if payoffType2 is Arithmetric and payoffType is Asian

Available Model/Engine pairs:

\begin{itemize}
  \item BlackScholesMerton/MCDiscreteArithmeticAPEngine
  \item BlackScholesMerton/TurnbullWakemanAsianEngine
  \item ScriptedTrade/ScriptedTrade
\end{itemize}

Engine description:

BlackScholesMerton/MCDiscreteArithmeticAPEngine builds a MCDiscreteArithmeticAPEngine using Sobol sequences. A sample
configuration is shown in listing
\ref{lst:peconfig_CommodityAsianOptionArithmeticPrice_BlackScholesMerton_MCDiscreteArithmeticAPEngine}.

The parameters have the following meaning:

\begin{itemize}
\item BrownianBridge: whether to use Brownian Bridge for MC simulation
\item AntitheticVariate: whether to use antithetic variates for MC simulation
\item ControlVariate: whether to use control variate for MC simulation
\item RequiredSamples: minimum number of samples for MC simulation, if 0 (not specified) RequiredTolerance must be given
\item RequiredTolernace: max tolerance for MC error, if 0 (not specified) RequiredSamples must be given
\item MaxSamples: max number of samples for MC simulation
\item Seed: seed for random number generator
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAsianOptionArithmeticPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>MCDiscreteArithmeticAPEngine</Engine>
    <EngineParameters>
        <Parameter name="BrownianBridge">true</Parameter>    
        <Parameter name="AntitheticVariate">true</Parameter>    
        <Parameter name="ControlVariate">true</Parameter>    
        <Parameter name="RequiredSamples">10000</Parameter>    
        <Parameter name="RequiredTolerance">0</Parameter>    
        <Parameter name="MaxSamples">0</Parameter>    
        <Parameter name="Seed">42</Parameter>    
        <Parameter name="SensitivityTemplate">COMM_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAsianOptionArithmeticPrice, Model BlackScholesMerton, Engine MCDiscreteArithmeticAPEngine}
\label{lst:peconfig_CommodityAsianOptionArithmeticPrice_BlackScholesMerton_MCDiscreteArithmeticAPEngine}
\end{longlisting}

BlackScholesMerton/TurnbullWakemanAsianEngine builds a TurnbullWakemanAsianEngine. A sample configuration is shown in
listing \ref{lst:peconfig_CommodityAsianOptionArithmeticPrice_BlackScholesMerton_TurnbullWakemanAsianEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAsianOptionArithmeticPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>TurnbullWakemanAsianEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAsianOptionArithmeticPrice, Model BlackScholesMerton, Engine TurnbullWakemanAsianEngine}
\label{lst:peconfig_CommodityAsianOptionArithmeticPrice_BlackScholesMerton_TurnbullWakemanAsianEngine}
\end{longlisting}

ScriptedTrade/ScriptedTrade delegates to the scripted trade engine and the associated pricing engine configuration for
Product Type ScriptedTrade, see there for details. A sample configuration is given in listing
\ref{lst:peconfig_CommodityAsianOptionArithmeticPrice_ScriptedTrade_ScriptedTrade}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAsianOptionArithmeticPrice">
    <Model>ScriptedTrade</Model>
    <ModelParameters/>
    <Engine>ScriptedTrade</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAsianOptionArithmeticPrice, Model ScriptedTrade, Engine ScriptedTrade}
\label{lst:peconfig_CommodityAsianOptionArithmeticPrice_ScriptedTrade_ScriptedTrade}
\end{longlisting}


%--------------------------------------------------------
\subsubsection{Product Type: CommodityAsianOptionArithmeticStrike}
%--------------------------------------------------------

Used by trade type: CommodityAsianOption if payoffType2 is Arithmetric and payoffType is AverageStrike

Available Model/Engine pairs:

\begin{itemize}
\item BlackScholesMerton/MCDiscreteArithmeticASEngine
\item ScriptedTrade/ScriptedTrade
\end{itemize}
  
Engine description:

BlackScholesMerton/MCDiscreteArithmeticASEngine builds a MCDiscreteArithmeticASEngine using Sobol sequences. A sample
configuration is shown in listing
\ref{lst:peconfig_CommodityAsianOptionArithmeticStrike_BlackScholesMerton_MCDiscreteArithmeticASEngine}.

The parameters have the following meaning:

\begin{itemize}
\item BrownianBridge: whether to use Brownian Bridge for MC simulation
\item AntitheticVariate: whether to use antithetic variates for MC simulation
\item ControlVariate: whether to use control variate for MC simulation
\item RequiredSamples: minimum number of samples for MC simulation, if 0 (not specified) RequiredTolerance must be given
\item RequiredTolernace: max tolerance for MC error, if 0 (not specified) RequiredSamples must be given
\item MaxSamples: max number of samples for MC simulation
\item Seed: seed for random number generator
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAsianOptionArithmeticStrike">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>MCDiscreteArithmeticASEngine</Engine>
    <EngineParameters>
        <Parameter name="BrownianBridge">true</Parameter>    
        <Parameter name="AntitheticVariate">true</Parameter>    
        <Parameter name="ControlVariate">true</Parameter>    
        <Parameter name="RequiredSamples">10000</Parameter>    
        <Parameter name="RequiredTolerance">0</Parameter>    
        <Parameter name="MaxSamples">0</Parameter>    
        <Parameter name="Seed">42</Parameter>    
        <Parameter name="SensitivityTemplate">COMM_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAsianOptionArithmeticStrike, Model BlackScholesMerton, Engine MCDiscreteArithmeticASEngine}
\label{lst:peconfig_CommodityAsianOptionArithmeticStrike_BlackScholesMerton_MCDiscreteArithmeticASEngine}
\end{longlisting}

ScriptedTrade/ScriptedTrade delegates to the scripted trade engine and the associated pricing engine configuration for
Product Type ScriptedTrade, see there for details. A sample configuration is given in listing
\ref{lst:peconfig_CommodityAsianOptionArithmeticStrike_ScriptedTrade_ScriptedTrade}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAsianOptionArithmeticStrike">
    <Model>ScriptedTrade</Model>
    <ModelParameters/>
    <Engine>ScriptedTrade</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAsianOptionArithmeticStrike, Model ScriptedTrade, Engine ScriptedTrade}
\label{lst:peconfig_CommodityAsianOptionArithmeticStrike_ScriptedTrade_ScriptedTrade}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CommodityAsianOptionGeometricPrice}
%--------------------------------------------------------

Used by trade type: CommodityAsianOption if payoffType2 is Geometric and payoffType is Asian

Available Model/Engine pairs:

\begin{itemize}
  \item BlackScholesMerton/MCDiscreteGeometricAPEngine
  \item BlackScholesMerton/AnalyticDiscreteGeometricAPEngine
  \item BlackScholesMerton/AnalyticContinuousGeometricAPEngine
  \item ScriptedTrade/ScriptedTrade
\end{itemize}

Engine description:

BlackScholesMerton/MCDiscreteGeometricAPEngine builds a MCDiscreteGeometricAPEngine using Sobol sequences. A sample
configuration is shown in listing
\ref{lst:peconfig_CommodityAsianOptionGeometricPrice_BlackScholesMerton_MCDiscreteGeomtetricAPEngine}.

The parameters have the following meaning:

\begin{itemize}
\item BrownianBridge: whether to use Brownian Bridge for MC simulation
\item AntitheticVariate: whether to use antithetic variates for MC simulation
\item ControlVariate: whether to use control variate for MC simulation
\item RequiredSamples: minimum number of samples for MC simulation, if 0 (not specified) RequiredTolerance must be given
\item RequiredTolernace: max tolerance for MC error, if 0 (not specified) RequiredSamples must be given
\item MaxSamples: max number of samples for MC simulation
\item Seed: seed for random number generator
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAsianOptionGeometricPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>MCDiscreteGeometricAPEngine</Engine>
    <EngineParameters>
        <Parameter name="BrownianBridge">true</Parameter>    
        <Parameter name="AntitheticVariate">true</Parameter>    
        <Parameter name="ControlVariate">true</Parameter>    
        <Parameter name="RequiredSamples">10000</Parameter>    
        <Parameter name="RequiredTolerance">0</Parameter>    
        <Parameter name="MaxSamples">0</Parameter>    
        <Parameter name="Seed">42</Parameter>    
        <Parameter name="SensitivityTemplate">COMM_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAsianOptionGeometricPrice, Model BlackScholesMerton, Engine MCDiscreteGeometricAPEngine}
\label{lst:peconfig_CommodityAsianOptionGeometricPrice_BlackScholesMerton_MCDiscreteGeomtetricAPEngine}
\end{longlisting}

BlackScholesMerton/AnalyticDiscreteGeometricAPEngine builds a AnalyticDiscreteGeometricAveragePriceAsianEngine. A sample
configuration is shown in listing
\ref{lst:peconfig_CommodityAsianOptionGeometricPrice_BlackScholesMerton_AnalyticDiscreteGeomtetricAPEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAsianOptionGeometricPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>AnalyticDiscreteGeometricAPEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAsianOptionGeometricPrice, Model BlackScholesMerton, Engine AnalyticDiscreteGeomtetricAPEngine}
\label{lst:peconfig_CommodityAsianOptionGeometricPrice_BlackScholesMerton_AnalyticDiscreteGeomtetricAPEngine}
\end{longlisting}

BlackScholesMerton/AnalyticContinuousGeometricAPEngine builds a AnalyticContinuousGeometricAveragePriceAsianEngine. A sample
configuration is shown in listing
\ref{lst:peconfig_CommodityAsianOptionGeometricPrice_BlackScholesMerton_AnalyticContinuousGeomtetricAPEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAsianOptionGeometricPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>AnalyticContinuousGeometricAPEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAsianOptionGeometricPrice, Model BlackScholesMerton, Engine AnalyticContinuousGeomtetricAPEngine}
\label{lst:peconfig_CommodityAsianOptionGeometricPrice_BlackScholesMerton_AnalyticContinuousGeomtetricAPEngine}
\end{longlisting}

ScriptedTrade/ScriptedTrade delegates to the scripted trade engine and the associated pricing engine configuration for
Product Type ScriptedTrade, see there for details. A sample configuration is given in listing
\ref{lst:peconfig_CommodityAsianOptionGeometricPrice_ScriptedTrade_ScriptedTrade}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAsianOptionGeometricPrice">
    <Model>ScriptedTrade</Model>
    <ModelParameters/>
    <Engine>ScriptedTrade</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAsianOptionGeometricPrice, Model ScriptedTrade, Engine ScriptedTrade}
\label{lst:peconfig_CommodityAsianOptionGeometricPrice_ScriptedTrade_ScriptedTrade}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CommodityAsianOptionGeometricStrike}
%--------------------------------------------------------

Used by trade type: CommodityAsianOption if payoffType2 is Geometric and payoffType is AverageStrike

Available Model/Engine pairs:

\begin{itemize}
  \item BlackScholesMerton/MCDiscreteGeometricASEngine
  \item BlackScholesMerton/AnalyticDiscreteGeometricASEngine
  \item ScriptedTrade/ScriptedTrade
\end{itemize}

Engine description:

BlackScholesMerton/MCDiscreteGeometricASEngine builds a MCDiscreteGeometricASEngine using Sobol sequences. A sample
configuration is shown in listing
\ref{lst:peconfig_CommodityAsianOptionGeometricStrike_BlackScholesMerton_MCDiscreteGeomtetricASEngine}.

The parameters have the following meaning:

\begin{itemize}
\item BrownianBridge: whether to use Brownian Bridge for MC simulation
\item AntitheticVariate: whether to use antithetic variates for MC simulation
\item ControlVariate: whether to use control variate for MC simulation
\item RequiredSamples: minimum number of samples for MC simulation, if 0 (not specified) RequiredTolerance must be given
\item RequiredTolernace: max tolerance for MC error, if 0 (not specified) RequiredSamples must be given
\item MaxSamples: max number of samples for MC simulation
\item Seed: seed for random number generator
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAsianOptionGeometricStrike">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>MCDiscreteGeometricASEngine</Engine>
    <EngineParameters>
        <Parameter name="BrownianBridge">true</Parameter>    
        <Parameter name="AntitheticVariate">true</Parameter>    
        <Parameter name="ControlVariate">true</Parameter>    
        <Parameter name="RequiredSamples">10000</Parameter>    
        <Parameter name="RequiredTolerance">0</Parameter>    
        <Parameter name="MaxSamples">0</Parameter>    
        <Parameter name="Seed">42</Parameter>    
        <Parameter name="SensitivityTemplate">COMM_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAsianOptionGeometricStrike, Model BlackScholesMerton, Engine MCDiscreteGeometricASEngine}
\label{lst:peconfig_CommodityAsianOptionGeometricStrike_BlackScholesMerton_MCDiscreteGeomtetricASEngine}
\end{longlisting}

BlackScholesMerton/AnalyticDiscreteGeometricASEngine builds a AnalyticDiscreteGeometricAverageStrikeAsianEngine. A sample
configuration is shown in listing
\ref{lst:peconfig_CommodityAsianOptionGeometricStrike_BlackScholesMerton_AnalyticDiscreteGeomtetricASEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAsianOptionGeometricStrike">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>AnalyticDiscreteGeometricASEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAsianOptionGeometricStrike, Model BlackScholesMerton, Engine AnalyticDiscreteGeomtetricASEngine}
\label{lst:peconfig_CommodityAsianOptionGeometricStrike_BlackScholesMerton_AnalyticDiscreteGeomtetricASEngine}
\end{longlisting}

ScriptedTrade/ScriptedTrade delegates to the scripted trade engine and the associated pricing engine configuration for
Product Type ScriptedTrade, see there for details. A sample configuration is given in listing
\ref{lst:peconfig_CommodityAsianOptionGeometricStrike_ScriptedTrade_ScriptedTrade}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAsianOptionGeometricStrike">
    <Model>ScriptedTrade</Model>
    <ModelParameters/>
    <Engine>ScriptedTrade</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAsianOptionGeometricStrike, Model ScriptedTrade, Engine ScriptedTrade}
\label{lst:peconfig_CommodityAsianOptionGeometricStrike_ScriptedTrade_ScriptedTrade}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CommoditySpreadOption}
%--------------------------------------------------------

Used by trade type: CommoditySpreadOption

Available Model/Engine pairs: BlackScholes/CommoditySpreadOptionEngine

Engine description:

BlackScholes/CommoditySpreadOptionEngine builds a CommoditySpreadOptionAnalyticalEngine, which uses the Kirk
approximation described in Iain J. Clark, Commodity Option Pricing, Section 2.9. The correlation between two commodities
resp. the intra-asset correlation between two future contracts is parametrized as

$$\rho(s, t) = e^{-\beta |s-t|}$$

where $s$ and $t$ are times to futures expiry. A sample configuration is shown in listing
\ref{lst:peconfig_CommoditySpreadOption_BlackScholes_CommoditySpreadOptionEngine}.

The parameters have the following meaning:

\begin{itemize}
\item beta: the parameter ``beta'' in the correlation parametrization
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommoditySpreadOption">
    <Model>BlackScholes</Model>
    <ModelParameters/>
    <Engine>CommoditySpreadOptionEngine</Engine>
    <EngineParameters>
        <Parameter name="beta">2.05</Parameter>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
    </Product>
\end{minted}
\caption{Configuration for Product CommoditySpreadOption, Model BlackScholes, Engine CommoditySpreadOptionEngine}
\label{lst:peconfig_CommoditySpreadOption_BlackScholes_CommoditySpreadOptionEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CommodityOption}
%--------------------------------------------------------

Used by trade type: CommodityOption

Available Model/Engine pairs: BlackScholes/AnalyticEuropeanEngine

Engine description:

BlackScholes/AnalyticEuropeanEngine builds a AnalyticEuropeanEngine. A sample configuration is shown in listing
\ref{lst:peconfig_CommodityOption_BlackScholes_AnalyticEuropeanEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityOption">
    <Model>BlackScholes</Model>
    <ModelParameters/>
    <Engine>AnalyticEuropeanEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityOption, Model BlackScholes, Engine AnalyticEuropeanEngine}
\label{lst:peconfig_CommodityOption_BlackScholes_AnalyticEuropeanEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CommodityOptionForward}
%--------------------------------------------------------

Used by trade type: CommodityOption if a future is referenced

Available Model/Engine pairs: BlackScholes/AnalyticEuropeanForwardEngine

Engine description:

BlackScholes/AnalyticEuropeanForwardEngine builds a AnalyticEuropeanForwardEngine. A sample configuration is shown in listing
\ref{lst:peconfig_CommodityOptionForward_BlackScholes_AnalyticForwardEuropeanEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityOptionForward">
    <Model>BlackScholes</Model>
    <ModelParameters/>
    <Engine>AnalyticForwardEuropeanEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityOptionForward, Model BlackScholes, Engine AnalyticForwardEuropeanEngine}
\label{lst:peconfig_CommodityOptionForward_BlackScholes_AnalyticForwardEuropeanEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CommodityOptionEuropeanCS}
%--------------------------------------------------------

Used by trade type: CommodityOption if cash settled

Available Model/Engine pairs: BlackScholes/AnalyticCashSettledEuropeanEngine

Engine description:

BlackScholes/AnalyticCashSettledEuropeanEngine builds a AnalyticCashSettledEuropeanEngine. A sample configuration is shown in listing
\ref{lst:peconfig_CommodityOptionEuropeanCS_BlackScholes_AnalyticCashSettledEuropeanEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityOptionEuropeanCS">
    <Model>BlackScholes</Model>
    <ModelParameters/>
    <Engine>AnalyticCashSettledEuropeanEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityOptionEuropeanCS, Model BlackScholes, Engine AnalyticCashSettledEuropeanEngine}
\label{lst:peconfig_CommodityOptionEuropeanCS_BlackScholes_AnalyticCashSettledEuropeanEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CommodityOptionAmerican}
%--------------------------------------------------------

Used by trade type: CommodityOption if exercise stly is american

Available Model/Engine pairs:

\begin{itemize}
\item BlackScholes/FdBlackScholesVanillaEngine
\item BlackScholes/BaroneAdesiWhaleyApproximationEngine
\end{itemize}

Engine description:

BlackScholes/FdBlackScholesVanillaEngine builds a FdBlackScholesVanillaEngine. A sample configuration is shown in listing
\ref{lst:peconfig_CommodityOptionAmerican_BlackScholes_FdBlackScholesVanillaEngine}

The parameters have the following meaning:

\begin{itemize}
\item Scheme: The finite difference scheme to use
\item TimeStepsPerYear: Time grid specification
\item XGrid: State grid specification
\item DampingSteps: Number of damping steps taken by FD solver
\item EnforceMonotoneVariance [optional]: If true variance is modified to be monotone if needed, defaults to true
\item TimeGridMinimumSize [optional]: Minimum number in resulting time grid, defaults to $1$ if not given
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityOptionAmerican">
    <Model>BlackScholes</Model>
    <ModelParameters/>
    <Engine>FdBlackScholesVanillaEngine</Engine>
    <EngineParameters>
        <Parameter name="Scheme">Douglas</Parameter>
        <Parameter name="TimeGridPerYear">100</Parameter>
        <Parameter name="XGrid">100</Parameter>
        <Parameter name="DampingSteps">0</Parameter>
        <Parameter name="EnforceMonotoneVariance">true</Parameter>
        <Parameter name="SensitivityTemplate">COMM_FD</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityOptionAmerican, Model BlackScholes, Engine FdBlackScholesVanillaEngine}
\label{lst:peconfig_CommodityOptionAmerican_BlackScholes_FdBlackScholesVanillaEngine}
\end{longlisting}

BlackScholes/BaroneAdesiWhaleyApproximationEngine builds a BaroneAdesiWhaleyApproximationEngine. A sample configuration is shown in listing
\ref{lst:peconfig_CommodityOptionAmerican_BlackScholes_BaroneAdesiWhaleyApproximationEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityOptionAmerican">
    <Model>BlackScholes</Model>
    <ModelParameters/>
    <Engine>BaroneAdesiWhaleyApproximationEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityOptionAmerican, Model BlackScholes, Engine BaroneAdesiWhaleyApproximationEngine}
\label{lst:peconfig_CommodityOptionAmerican_BlackScholes_BaroneAdesiWhaleyApproximationEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CommoditySwap}
%--------------------------------------------------------

Used by trade type: CommoditySwap

Available Model/Engine pairs: DiscountedCashflows/CommoditySwapEngine

Engine description:

DiscountedCashflows/CommoditySwapEngine builds a DiscountingSwapEngine. A sample configuration is shown in listing
\ref{lst:peconfig_CommoditySwap_DiscountedCashflows_CommoditySwapEngine}

The parameters have the following meaning:

\begin{itemize}
\item 
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommoditySwap">
    <Model>DiscountedCashflows</Model>
    <ModelParameters/>
    <Engine>CommoditySwapEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommoditySwap, Model DiscountedCashflows, Engine CommoditySwapEngine}
\label{lst:peconfig_CommoditySwap_DiscountedCashflows_CommoditySwapEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CommoditySwaption}
%--------------------------------------------------------

Used by trade type: CommoditySwaption

Available Model/Engine pairs:

\begin{itemize}
\item Black/AnalyticalApproximation
\item Black/MonteCarlo
\end{itemize}

Engine description:

Black/AnalyticalApproximation builds a CommoditySwaptionEngine using moment matching. The correlation between two future
contracts is parametrized as

$$\rho(s, t) = e^{-\beta |s-t|}$$

where $s$ and $t$ are times to futures expiry. A sample configuration is shown in listing
\ref{lst:peconfig_CommoditySwaption_Black_AnalyticalApproximation}

The parameters have the following meaning:

\begin{itemize}
\item beta: the parameter ``beta'' in the correlation parametrization
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommoditySwaption">
    <Model>Black</Model>
    <ModelParameters/>
    <Engine>AnalyticalApproximation</Engine>
    <EngineParameters>
        <Parameter name="beta">2.05</Parameter>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommoditySwaption, Model Black, Engine AnalyticalApproximation}
\label{lst:peconfig_CommoditySwaption_Black_AnalyticalApproximation}
\end{longlisting}

Black/MonteCarlo builds a CommoditySwaptionMonteCarloEngine using Sobol sequences. The same correlation parametrization
as above is used. A sample configuration is shown in listing
\ref{lst:peconfig_CommoditySwaption_Black_MonteCarlo}

The parameters have the following meaning:

\begin{itemize}
\item beta: the parameter ``beta'' in the correlation parametrization
\item samples: the number of MC samples to use
\item seed: the seed to use
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommoditySwaption">
    <Model>Black</Model>
    <ModelParameters/>
    <Engine>MonteCarlo</Engine>
    <EngineParameters>
        <Parameter name="beta">2.05</Parameter>
        <Parameter name="samples">10000</Parameter>
        <Parameter name="seed">42</Parameter>    
        <Parameter name="SensitivityTemplate">COMM_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommoditySwaption, Model Black, Engine MonteCarlo}
\label{lst:peconfig_CommoditySwaption_Black_MonteCarlo}
\end{longlisting}
    
%--------------------------------------------------------
\subsubsection{Product Type: EquityAsianOptionArithmeticPrice}
%--------------------------------------------------------

Used by trade type: EquityAsianOption if payoffType2 is Arithmetric and payoffType is Asian

Available Model/Engine pairs:

\begin{itemize}
  \item BlackScholesMerton/MCDiscreteArithmeticAPEngine
  \item BlackScholesMerton/TurnbullWakemanAsianEngine
  \item ScriptedTrade/ScriptedTrade
\end{itemize}

Engine description:

BlackScholesMerton/MCDiscreteArithmeticAPEngine builds a MCDiscreteArithmeticAPEngine using Sobol sequences. A sample
configuration is shown in listing
\ref{lst:peconfig_EquityAsianOptionArithmeticPrice_BlackScholesMerton_MCDiscreteArithmeticAPEngine}.

The parameters have the following meaning:

\begin{itemize}
\item BrownianBridge: whether to use Brownian Bridge for MC simulation
\item AntitheticVariate: whether to use antithetic variates for MC simulation
\item ControlVariate: whether to use control variate for MC simulation
\item RequiredSamples: minimum number of samples for MC simulation, if 0 (not specified) RequiredTolerance must be given
\item RequiredTolernace: max tolerance for MC error, if 0 (not specified) RequiredSamples must be given
\item MaxSamples: max number of samples for MC simulation
\item Seed: seed for random number generator
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityAsianOptionArithmeticPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>MCDiscreteArithmeticAPEngine</Engine>
    <EngineParameters>
        <Parameter name="BrownianBridge">true</Parameter>    
        <Parameter name="AntitheticVariate">true</Parameter>    
        <Parameter name="ControlVariate">true</Parameter>    
        <Parameter name="RequiredSamples">10000</Parameter>    
        <Parameter name="RequiredTolerance">0</Parameter>    
        <Parameter name="MaxSamples">0</Parameter>    
        <Parameter name="Seed">42</Parameter>    
        <Parameter name="SensitivityTemplate">EQ_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityAsianOptionArithmeticPrice, Model BlackScholesMerton, Engine MCDiscreteArithmeticAPEngine}
\label{lst:peconfig_EquityAsianOptionArithmeticPrice_BlackScholesMerton_MCDiscreteArithmeticAPEngine}
\end{longlisting}

BlackScholesMerton/TurnbullWakemanAsianEngine builds a TurnbullWakemanAsianEngine. A sample configuration is shown in
listing \ref{lst:peconfig_EquityAsianOptionArithmeticPrice_BlackScholesMerton_TurnbullWakemanAsianEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityAsianOptionArithmeticPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>TurnbullWakemanAsianEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">EQ_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityAsianOptionArithmeticPrice, Model BlackScholesMerton, Engine TurnbullWakemanAsianEngine}
\label{lst:peconfig_EquityAsianOptionArithmeticPrice_BlackScholesMerton_TurnbullWakemanAsianEngine}
\end{longlisting}

ScriptedTrade/ScriptedTrade delegates to the scripted trade engine and the associated pricing engine configuration for
Product Type ScriptedTrade, see there for details. A sample configuration is given in listing
\ref{lst:peconfig_EquityAsianOptionArithmeticPrice_ScriptedTrade_ScriptedTrade}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityAsianOptionArithmeticPrice">
    <Model>ScriptedTrade</Model>
    <ModelParameters/>
    <Engine>ScriptedTrade</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">EQ_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityAsianOptionArithmeticPrice, Model ScriptedTrade, Engine ScriptedTrade}
\label{lst:peconfig_EquityAsianOptionArithmeticPrice_ScriptedTrade_ScriptedTrade}
\end{longlisting}


%--------------------------------------------------------
\subsubsection{Product Type: EquityAsianOptionArithmeticStrike}
%--------------------------------------------------------

Used by trade type: EquityAsianOption if payoffType2 is Arithmetric and payoffType is AverageStrike

Available Model/Engine pairs:

\begin{itemize}
\item BlackScholesMerton/MCDiscreteArithmeticASEngine
\item ScriptedTrade/ScriptedTrade
\end{itemize}
  
Engine description:

BlackScholesMerton/MCDiscreteArithmeticASEngine builds a MCDiscreteArithmeticASEngine using Sobol sequences. A sample
configuration is shown in listing
\ref{lst:peconfig_EquityAsianOptionArithmeticStrike_BlackScholesMerton_MCDiscreteArithmeticASEngine}.

The parameters have the following meaning:

\begin{itemize}
\item BrownianBridge: whether to use Brownian Bridge for MC simulation
\item AntitheticVariate: whether to use antithetic variates for MC simulation
\item ControlVariate: whether to use control variate for MC simulation
\item RequiredSamples: minimum number of samples for MC simulation, if 0 (not specified) RequiredTolerance must be given
\item RequiredTolernace: max tolerance for MC error, if 0 (not specified) RequiredSamples must be given
\item MaxSamples: max number of samples for MC simulation
\item Seed: seed for random number generator
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityAsianOptionArithmeticStrike">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>MCDiscreteArithmeticASEngine</Engine>
    <EngineParameters>
        <Parameter name="BrownianBridge">true</Parameter>    
        <Parameter name="AntitheticVariate">true</Parameter>    
        <Parameter name="ControlVariate">true</Parameter>    
        <Parameter name="RequiredSamples">10000</Parameter>    
        <Parameter name="RequiredTolerance">0</Parameter>    
        <Parameter name="MaxSamples">0</Parameter>    
        <Parameter name="Seed">42</Parameter>    
        <Parameter name="SensitivityTemplate">EQ_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityAsianOptionArithmeticStrike, Model BlackScholesMerton, Engine MCDiscreteArithmeticASEngine}
\label{lst:peconfig_EquityAsianOptionArithmeticStrike_BlackScholesMerton_MCDiscreteArithmeticASEngine}
\end{longlisting}

ScriptedTrade/ScriptedTrade delegates to the scripted trade engine and the associated pricing engine configuration for
Product Type ScriptedTrade, see there for details. A sample configuration is given in listing
\ref{lst:peconfig_EquityAsianOptionArithmeticStrike_ScriptedTrade_ScriptedTrade}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityAsianOptionArithmeticStrike">
    <Model>ScriptedTrade</Model>
    <ModelParameters/>
    <Engine>ScriptedTrade</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">EQ_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityAsianOptionArithmeticStrike, Model ScriptedTrade, Engine ScriptedTrade}
\label{lst:peconfig_EquityAsianOptionArithmeticStrike_ScriptedTrade_ScriptedTrade}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: EquityAsianOptionGeometricPrice}
%--------------------------------------------------------

Used by trade type: EquityAsianOption if payoffType2 is Geometric and payoffType is Asian

Available Model/Engine pairs:

\begin{itemize}
  \item BlackScholesMerton/MCDiscreteGeometricAPEngine
  \item BlackScholesMerton/AnalyticDiscreteGeometricAPEngine
  \item BlackScholesMerton/AnalyticContinuousGeometricAPEngine
  \item ScriptedTrade/ScriptedTrade
\end{itemize}

Engine description:

BlackScholesMerton/MCDiscreteGeometricAPEngine builds a MCDiscreteGeometricAPEngine using Sobol sequences. A sample
configuration is shown in listing
\ref{lst:peconfig_EquityAsianOptionGeometricPrice_BlackScholesMerton_MCDiscreteGeomtetricAPEngine}.

The parameters have the following meaning:

\begin{itemize}
\item BrownianBridge: whether to use Brownian Bridge for MC simulation
\item AntitheticVariate: whether to use antithetic variates for MC simulation
\item ControlVariate: whether to use control variate for MC simulation
\item RequiredSamples: minimum number of samples for MC simulation, if 0 (not specified) RequiredTolerance must be given
\item RequiredTolernace: max tolerance for MC error, if 0 (not specified) RequiredSamples must be given
\item MaxSamples: max number of samples for MC simulation
\item Seed: seed for random number generator
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityAsianOptionGeometricPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>MCDiscreteGeometricAPEngine</Engine>
    <EngineParameters>
        <Parameter name="BrownianBridge">true</Parameter>    
        <Parameter name="AntitheticVariate">true</Parameter>    
        <Parameter name="ControlVariate">true</Parameter>    
        <Parameter name="RequiredSamples">10000</Parameter>    
        <Parameter name="RequiredTolerance">0</Parameter>    
        <Parameter name="MaxSamples">0</Parameter>    
        <Parameter name="Seed">42</Parameter>    
        <Parameter name="SensitivityTemplate">EQ_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityAsianOptionGeometricPrice, Model BlackScholesMerton, Engine MCDiscreteGeometricAPEngine}
\label{lst:peconfig_EquityAsianOptionGeometricPrice_BlackScholesMerton_MCDiscreteGeomtetricAPEngine}
\end{longlisting}

BlackScholesMerton/AnalyticDiscreteGeometricAPEngine builds a AnalyticDiscreteGeometricAveragePriceAsianEngine. A sample
configuration is shown in listing
\ref{lst:peconfig_EquityAsianOptionGeometricPrice_BlackScholesMerton_AnalyticDiscreteGeomtetricAPEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityAsianOptionGeometricPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>AnalyticDiscreteGeometricAPEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">EQ_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityAsianOptionGeometricPrice, Model BlackScholesMerton, Engine AnalyticDiscreteGeomtetricAPEngine}
\label{lst:peconfig_EquityAsianOptionGeometricPrice_BlackScholesMerton_AnalyticDiscreteGeomtetricAPEngine}
\end{longlisting}

BlackScholesMerton/AnalyticContinuousGeometricAPEngine builds a AnalyticContinuousGeometricAveragePriceAsianEngine. A sample
configuration is shown in listing
\ref{lst:peconfig_EquityAsianOptionGeometricPrice_BlackScholesMerton_AnalyticContinuousGeomtetricAPEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityAsianOptionGeometricPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>AnalyticContinuousGeometricAPEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">EQ_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityAsianOptionGeometricPrice, Model BlackScholesMerton, Engine AnalyticContinuousGeomtetricAPEngine}
\label{lst:peconfig_EquityAsianOptionGeometricPrice_BlackScholesMerton_AnalyticContinuousGeomtetricAPEngine}
\end{longlisting}

ScriptedTrade/ScriptedTrade delegates to the scripted trade engine and the associated pricing engine configuration for
Product Type ScriptedTrade, see there for details. A sample configuration is given in listing
\ref{lst:peconfig_EquityAsianOptionGeometricPrice_ScriptedTrade_ScriptedTrade}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityAsianOptionGeometricPrice">
    <Model>ScriptedTrade</Model>
    <ModelParameters/>
    <Engine>ScriptedTrade</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">EQ_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityAsianOptionGeometricPrice, Model ScriptedTrade, Engine ScriptedTrade}
\label{lst:peconfig_EquityAsianOptionGeometricPrice_ScriptedTrade_ScriptedTrade}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: EquityAsianOptionGeometricStrike}
%--------------------------------------------------------

Used by trade type: EquityAsianOption if payoffType2 is Geometric and payoffType is AverageStrike

Available Model/Engine pairs:

\begin{itemize}
  \item BlackScholesMerton/MCDiscreteGeometricASEngine
  \item BlackScholesMerton/AnalyticDiscreteGeometricASEngine
  \item ScriptedTrade/ScriptedTrade
\end{itemize}

Engine description:

BlackScholesMerton/MCDiscreteGeometricASEngine builds a MCDiscreteGeometricASEngine using Sobol sequences. A sample
configuration is shown in listing
\ref{lst:peconfig_EquityAsianOptionGeometricStrike_BlackScholesMerton_MCDiscreteGeomtetricASEngine}.

The parameters have the following meaning:

\begin{itemize}
\item BrownianBridge: whether to use Brownian Bridge for MC simulation
\item AntitheticVariate: whether to use antithetic variates for MC simulation
\item ControlVariate: whether to use control variate for MC simulation
\item RequiredSamples: minimum number of samples for MC simulation, if 0 (not specified) RequiredTolerance must be given
\item RequiredTolernace: max tolerance for MC error, if 0 (not specified) RequiredSamples must be given
\item MaxSamples: max number of samples for MC simulation
\item Seed: seed for random number generator
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityAsianOptionGeometricStrike">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>MCDiscreteGeometricASEngine</Engine>
    <EngineParameters>
        <Parameter name="BrownianBridge">true</Parameter>    
        <Parameter name="AntitheticVariate">true</Parameter>    
        <Parameter name="ControlVariate">true</Parameter>    
        <Parameter name="RequiredSamples">10000</Parameter>    
        <Parameter name="RequiredTolerance">0</Parameter>    
        <Parameter name="MaxSamples">0</Parameter>    
        <Parameter name="Seed">42</Parameter>    
        <Parameter name="SensitivityTemplate">EQ_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityAsianOptionGeometricStrike, Model BlackScholesMerton, Engine MCDiscreteGeometricASEngine}
\label{lst:peconfig_EquityAsianOptionGeometricStrike_BlackScholesMerton_MCDiscreteGeomtetricASEngine}
\end{longlisting}

BlackScholesMerton/AnalyticDiscreteGeometricASEngine builds a AnalyticDiscreteGeometricAverageStrikeAsianEngine. A sample
configuration is shown in listing
\ref{lst:peconfig_EquityAsianOptionGeometricStrike_BlackScholesMerton_AnalyticDiscreteGeomtetricASEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityAsianOptionGeometricStrike">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>AnalyticDiscreteGeometricASEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">EQ_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityAsianOptionGeometricStrike, Model BlackScholesMerton, Engine AnalyticDiscreteGeomtetricASEngine}
\label{lst:peconfig_EquityAsianOptionGeometricStrike_BlackScholesMerton_AnalyticDiscreteGeomtetricASEngine}
\end{longlisting}

ScriptedTrade/ScriptedTrade delegates to the scripted trade engine and the associated pricing engine configuration for
Product Type ScriptedTrade, see there for details. A sample configuration is given in listing
\ref{lst:peconfig_EquityAsianOptionGeometricStrike_ScriptedTrade_ScriptedTrade}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityAsianOptionGeometricStrike">
    <Model>ScriptedTrade</Model>
    <ModelParameters/>
    <Engine>ScriptedTrade</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">EQ_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityAsianOptionGeometricStrike, Model ScriptedTrade, Engine ScriptedTrade}
\label{lst:peconfig_EquityAsianOptionGeometricStrike_ScriptedTrade_ScriptedTrade}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: EquityEuropeanCompositeOption}
%--------------------------------------------------------

Used by trade type: EquityOption if a composite option is built

Available Model/Engine pairs: BlackScholes/AnalyticEuropeanEngine

Engine description:

BlackScholes/AnalyticEuropeanEngine builds a AnalyticEuropeanEngine (with a vol composed from the relevant equity and fx
vol surfaces). A sample configuration is shown in listing
\ref{lst:peconfig_EquityEuropeanCompositeOption_BlackScholes_AnalyticEuropeanEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityEuropeanCompositeOption">
    <Model>BlackScholes</Model>
    <ModelParameters/>
    <Engine>AnalyticEuropeanEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">EQ_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityEuropeanCompositeOption, Model BlackScholes, Engine AnalyticEuropeanEngine}
\label{lst:peconfig_EquityEuropeanCompositeOption_BlackScholes_AnalyticEuropeanEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: EquityFutureOption}
%--------------------------------------------------------

Used by trade type: EquityFuturesOption

Available Model/Engine pairs: BlackScholes/AnalyticEuroepanForwardEngine

Engine description:

BlackScholes/AnalyticEuroepanForwardEngine builds a AnalyticEuropeanForwardEngine. A sample configuration is shown in
listing \ref{lst:peconfig_EquityFutureOption_BlackScholes_AnalyticEuropeanForwardEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
  <Product type="EquityFutureOption">
    <Model>BlackScholes</Model>
    <ModelParameters />
    <Engine>AnalyticEuropeanForwardEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
  </Product>
\end{minted}
\caption{Configuration for Product EquiytFutureOption, Model BlackScholes, Engine AnalyticEuropeanForwardEngine}
\label{lst:peconfig_EquityFutureOption_BlackScholes_AnalyticEuropeanForwardEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: EquityOption}
%--------------------------------------------------------

Used by trade type: EquityOption

Available Model/Engine pairs: BlackScholesMerton/AnalyticEuropeanEngine

Engine description:

BlackScholesMerton/AnalyticEuropeanEngine builds a AnalyticEuropeanEngine. A sample configuration is shown in listing
\ref{lst:peconfig_EquityOption_BlackScholesMerton_AnalyticEuropeanEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityOption">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>AnalyticEuropeanEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityOption, Model BlackScholesMerton, Engine AnalyticEuropeanEngine}
\label{lst:peconfig_EquityOption_BlackScholesMerton_AnalyticEuropeanEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: EquityOptionEuropeanCS}
%--------------------------------------------------------

Used by trade type: EquityOption if cash settled

Available Model/Engine pairs: BlackScholesMerton/AnalyticCashSettledEuropeanEngine

Engine description:

BlackScholesMerton/AnalyticCashSettledEuropeanEngine builds a AnalyticCashSettledEuropeanEngine. A sample configuration is shown in listing
\ref{lst:peconfig_EquityOptionEuropeanCS_BlackScholesMerton_AnalyticCashSettledEuropeanEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityOptionEuropeanCS">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>AnalyticCashSettledEuropeanEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityOptionEuropeanCS, Model BlackScholesMerton, Engine AnalyticCashSettledEuropeanEngine}
\label{lst:peconfig_EquityOptionEuropeanCS_BlackScholesMerton_AnalyticCashSettledEuropeanEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: EquityOptionAmerican}
%--------------------------------------------------------

Used by trade type: EquityOption if exercise stly is american

Available Model/Engine pairs:

\begin{itemize}
\item BlackScholesMerton/FdBlackScholesVanillaEngine
\item BlackScholesMerton/BaroneAdesiWhaleyApproximationEngine
\end{itemize}

Engine description:

BlackScholesMerton/FdBlackScholesVanillaEngine builds a FdBlackScholesVanillaEngine. A sample configuration is shown in listing
\ref{lst:peconfig_EquityOptionAmerican_BlackScholesMerton_FdBlackScholesVanillaEngine}

The parameters have the following meaning:

\begin{itemize}
\item Scheme: The finite difference scheme to use
\item TimeStepsPerYear: Time grid specification
\item XGrid: State grid specification
\item DampingSteps: Number of damping steps taken by FD solver
\item EnforceMonotoneVariance [optional]: If true variance is modified to be monotone if needed, defaults to true
\item TimeGridMinimumSize [optional]: Minimum number in resulting time grid, defaults to $1$ if not given
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityOptionAmerican">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>FdBlackScholesVanillaEngine</Engine>
    <EngineParameters>
        <Parameter name="Scheme">Douglas</Parameter>
        <Parameter name="TimeGridPerYear">100</Parameter>
        <Parameter name="XGrid">100</Parameter>
        <Parameter name="DampingSteps">0</Parameter>
        <Parameter name="EnforceMonotoneVariance">true</Parameter>
        <Parameter name="SensitivityTemplate">COMM_FD</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityOptionAmerican, Model BlackScholesMerton, Engine FdBlackScholesVanillaEngine}
\label{lst:peconfig_EquityOptionAmerican_BlackScholesMerton_FdBlackScholesVanillaEngine}
\end{longlisting}

BlackScholesMerton/BaroneAdesiWhaleyApproximationEngine builds a BaroneAdesiWhaleyApproximationEngine. A sample configuration is shown in listing
\ref{lst:peconfig_EquityOptionAmerican_BlackScholesMerton_BaroneAdesiWhaleyApproximationEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityOptionAmerican">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>BaroneAdesiWhaleyApproximationEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityOptionAmerican, Model BlackScholesMerton, Engine BaroneAdesiWhaleyApproximationEngine}
\label{lst:peconfig_EquityOptionAmerican_BlackScholesMerton_BaroneAdesiWhaleyApproximationEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: FxAsianOptionArithmeticPrice}
%--------------------------------------------------------

Used by trade type: FxAsianOption if payoffType2 is Arithmetric and payoffType is Asian

Available Model/Engine pairs:

\begin{itemize}
  \item BlackScholesMerton/MCDiscreteArithmeticAPEngine
  \item BlackScholesMerton/TurnbullWakemanAsianEngine
  \item ScriptedTrade/ScriptedTrade
\end{itemize}

Engine description:

BlackScholesMerton/MCDiscreteArithmeticAPEngine builds a MCDiscreteArithmeticAPEngine using Sobol sequences. A sample
configuration is shown in listing
\ref{lst:peconfig_FxAsianOptionArithmeticPrice_BlackScholesMerton_MCDiscreteArithmeticAPEngine}.

The parameters have the following meaning:

\begin{itemize}
\item BrownianBridge: whether to use Brownian Bridge for MC simulation
\item AntitheticVariate: whether to use antithetic variates for MC simulation
\item ControlVariate: whether to use control variate for MC simulation
\item RequiredSamples: minimum number of samples for MC simulation, if 0 (not specified) RequiredTolerance must be given
\item RequiredTolernace: max tolerance for MC error, if 0 (not specified) RequiredSamples must be given
\item MaxSamples: max number of samples for MC simulation
\item Seed: seed for random number generator
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxAsianOptionArithmeticPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>MCDiscreteArithmeticAPEngine</Engine>
    <EngineParameters>
        <Parameter name="BrownianBridge">true</Parameter>    
        <Parameter name="AntitheticVariate">true</Parameter>    
        <Parameter name="ControlVariate">true</Parameter>    
        <Parameter name="RequiredSamples">10000</Parameter>    
        <Parameter name="RequiredTolerance">0</Parameter>    
        <Parameter name="MaxSamples">0</Parameter>    
        <Parameter name="Seed">42</Parameter>    
        <Parameter name="SensitivityTemplate">FX_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxAsianOptionArithmeticPrice, Model BlackScholesMerton, Engine MCDiscreteArithmeticAPEngine}
\label{lst:peconfig_FxAsianOptionArithmeticPrice_BlackScholesMerton_MCDiscreteArithmeticAPEngine}
\end{longlisting}

BlackScholesMerton/TurnbullWakemanAsianEngine builds a TurnbullWakemanAsianEngine. A sample configuration is shown in
listing \ref{lst:peconfig_FxAsianOptionArithmeticPrice_BlackScholesMerton_TurnbullWakemanAsianEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxAsianOptionArithmeticPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>TurnbullWakemanAsianEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">FX_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxAsianOptionArithmeticPrice, Model BlackScholesMerton, Engine TurnbullWakemanAsianEngine}
\label{lst:peconfig_FxAsianOptionArithmeticPrice_BlackScholesMerton_TurnbullWakemanAsianEngine}
\end{longlisting}

ScriptedTrade/ScriptedTrade delegates to the scripted trade engine and the associated pricing engine configuration for
Product Type ScriptedTrade, see there for details. A sample configuration is given in listing
\ref{lst:peconfig_FxAsianOptionArithmeticPrice_ScriptedTrade_ScriptedTrade}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxAsianOptionArithmeticPrice">
    <Model>ScriptedTrade</Model>
    <ModelParameters/>
    <Engine>ScriptedTrade</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">FX_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxAsianOptionArithmeticPrice, Model ScriptedTrade, Engine ScriptedTrade}
\label{lst:peconfig_FxAsianOptionArithmeticPrice_ScriptedTrade_ScriptedTrade}
\end{longlisting}


%--------------------------------------------------------
\subsubsection{Product Type: FxAsianOptionArithmeticStrike}
%--------------------------------------------------------

Used by trade type: FxAsianOption if payoffType2 is Arithmetric and payoffType is AverageStrike

Available Model/Engine pairs:

\begin{itemize}
\item BlackScholesMerton/MCDiscreteArithmeticASEngine
\item ScriptedTrade/ScriptedTrade
\end{itemize}
  
Engine description:

BlackScholesMerton/MCDiscreteArithmeticASEngine builds a MCDiscreteArithmeticASEngine using Sobol sequences. A sample
configuration is shown in listing
\ref{lst:peconfig_FxAsianOptionArithmeticStrike_BlackScholesMerton_MCDiscreteArithmeticASEngine}.

The parameters have the following meaning:

\begin{itemize}
\item BrownianBridge: whether to use Brownian Bridge for MC simulation
\item AntitheticVariate: whether to use antithetic variates for MC simulation
\item ControlVariate: whether to use control variate for MC simulation
\item RequiredSamples: minimum number of samples for MC simulation, if 0 (not specified) RequiredTolerance must be given
\item RequiredTolernace: max tolerance for MC error, if 0 (not specified) RequiredSamples must be given
\item MaxSamples: max number of samples for MC simulation
\item Seed: seed for random number generator
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxAsianOptionArithmeticStrike">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>MCDiscreteArithmeticASEngine</Engine>
    <EngineParameters>
        <Parameter name="BrownianBridge">true</Parameter>    
        <Parameter name="AntitheticVariate">true</Parameter>    
        <Parameter name="ControlVariate">true</Parameter>    
        <Parameter name="RequiredSamples">10000</Parameter>    
        <Parameter name="RequiredTolerance">0</Parameter>    
        <Parameter name="MaxSamples">0</Parameter>    
        <Parameter name="Seed">42</Parameter>    
        <Parameter name="SensitivityTemplate">FX_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxAsianOptionArithmeticStrike, Model BlackScholesMerton, Engine MCDiscreteArithmeticASEngine}
\label{lst:peconfig_FxAsianOptionArithmeticStrike_BlackScholesMerton_MCDiscreteArithmeticASEngine}
\end{longlisting}

ScriptedTrade/ScriptedTrade delegates to the scripted trade engine and the associated pricing engine configuration for
Product Type ScriptedTrade, see there for details. A sample configuration is given in listing
\ref{lst:peconfig_FxAsianOptionArithmeticStrike_ScriptedTrade_ScriptedTrade}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxAsianOptionArithmeticStrike">
    <Model>ScriptedTrade</Model>
    <ModelParameters/>
    <Engine>ScriptedTrade</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">FX_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxAsianOptionArithmeticStrike, Model ScriptedTrade, Engine ScriptedTrade}
\label{lst:peconfig_FxAsianOptionArithmeticStrike_ScriptedTrade_ScriptedTrade}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: FxAsianOptionGeometricPrice}
%--------------------------------------------------------

Used by trade type: FxAsianOption if payoffType2 is Geometric and payoffType is Asian

Available Model/Engine pairs:

\begin{itemize}
  \item BlackScholesMerton/MCDiscreteGeometricAPEngine
  \item BlackScholesMerton/AnalyticDiscreteGeometricAPEngine
  \item BlackScholesMerton/AnalyticContinuousGeometricAPEngine
  \item ScriptedTrade/ScriptedTrade
\end{itemize}

Engine description:

BlackScholesMerton/MCDiscreteGeometricAPEngine builds a MCDiscreteGeometricAPEngine using Sobol sequences. A sample
configuration is shown in listing
\ref{lst:peconfig_FxAsianOptionGeometricPrice_BlackScholesMerton_MCDiscreteGeomtetricAPEngine}.

The parameters have the following meaning:

\begin{itemize}
\item BrownianBridge: whether to use Brownian Bridge for MC simulation
\item AntitheticVariate: whether to use antithetic variates for MC simulation
\item ControlVariate: whether to use control variate for MC simulation
\item RequiredSamples: minimum number of samples for MC simulation, if 0 (not specified) RequiredTolerance must be given
\item RequiredTolernace: max tolerance for MC error, if 0 (not specified) RequiredSamples must be given
\item MaxSamples: max number of samples for MC simulation
\item Seed: seed for random number generator
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxAsianOptionGeometricPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>MCDiscreteGeometricAPEngine</Engine>
    <EngineParameters>
        <Parameter name="BrownianBridge">true</Parameter>    
        <Parameter name="AntitheticVariate">true</Parameter>    
        <Parameter name="ControlVariate">true</Parameter>    
        <Parameter name="RequiredSamples">10000</Parameter>    
        <Parameter name="RequiredTolerance">0</Parameter>    
        <Parameter name="MaxSamples">0</Parameter>    
        <Parameter name="Seed">42</Parameter>    
        <Parameter name="SensitivityTemplate">FX_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxAsianOptionGeometricPrice, Model BlackScholesMerton, Engine MCDiscreteGeometricAPEngine}
\label{lst:peconfig_FxAsianOptionGeometricPrice_BlackScholesMerton_MCDiscreteGeomtetricAPEngine}
\end{longlisting}

BlackScholesMerton/AnalyticDiscreteGeometricAPEngine builds a AnalyticDiscreteGeometricAveragePriceAsianEngine. A sample
configuration is shown in listing
\ref{lst:peconfig_FxAsianOptionGeometricPrice_BlackScholesMerton_AnalyticDiscreteGeomtetricAPEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxAsianOptionGeometricPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>AnalyticDiscreteGeometricAPEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">FX_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxAsianOptionGeometricPrice, Model BlackScholesMerton, Engine AnalyticDiscreteGeomtetricAPEngine}
\label{lst:peconfig_FxAsianOptionGeometricPrice_BlackScholesMerton_AnalyticDiscreteGeomtetricAPEngine}
\end{longlisting}

BlackScholesMerton/AnalyticContinuousGeometricAPEngine builds a AnalyticContinuousGeometricAveragePriceAsianEngine. A sample
configuration is shown in listing
\ref{lst:peconfig_FxAsianOptionGeometricPrice_BlackScholesMerton_AnalyticContinuousGeomtetricAPEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxAsianOptionGeometricPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>AnalyticContinuousGeometricAPEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">FX_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxAsianOptionGeometricPrice, Model BlackScholesMerton, Engine AnalyticContinuousGeomtetricAPEngine}
\label{lst:peconfig_FxAsianOptionGeometricPrice_BlackScholesMerton_AnalyticContinuousGeomtetricAPEngine}
\end{longlisting}

ScriptedTrade/ScriptedTrade delegates to the scripted trade engine and the associated pricing engine configuration for
Product Type ScriptedTrade, see there for details. A sample configuration is given in listing
\ref{lst:peconfig_FxAsianOptionGeometricPrice_ScriptedTrade_ScriptedTrade}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxAsianOptionGeometricPrice">
    <Model>ScriptedTrade</Model>
    <ModelParameters/>
    <Engine>ScriptedTrade</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">FX_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxAsianOptionGeometricPrice, Model ScriptedTrade, Engine ScriptedTrade}
\label{lst:peconfig_FxAsianOptionGeometricPrice_ScriptedTrade_ScriptedTrade}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: FxAsianOptionGeometricStrike}
%--------------------------------------------------------

Used by trade type: FxAsianOption if payoffType2 is Geometric and payoffType is AverageStrike

Available Model/Engine pairs:

\begin{itemize}
  \item BlackScholesMerton/MCDiscreteGeometricASEngine
  \item BlackScholesMerton/AnalyticDiscreteGeometricASEngine
  \item ScriptedTrade/ScriptedTrade
\end{itemize}

Engine description:

BlackScholesMerton/MCDiscreteGeometricASEngine builds a MCDiscreteGeometricASEngine using Sobol sequences. A sample
configuration is shown in listing
\ref{lst:peconfig_FxAsianOptionGeometricStrike_BlackScholesMerton_MCDiscreteGeomtetricASEngine}.

The parameters have the following meaning:

\begin{itemize}
\item BrownianBridge: whether to use Brownian Bridge for MC simulation
\item AntitheticVariate: whether to use antithetic variates for MC simulation
\item ControlVariate: whether to use control variate for MC simulation
\item RequiredSamples: minimum number of samples for MC simulation, if 0 (not specified) RequiredTolerance must be given
\item RequiredTolernace: max tolerance for MC error, if 0 (not specified) RequiredSamples must be given
\item MaxSamples: max number of samples for MC simulation
\item Seed: seed for random number generator
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxAsianOptionGeometricStrike">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>MCDiscreteGeometricASEngine</Engine>
    <EngineParameters>
        <Parameter name="BrownianBridge">true</Parameter>    
        <Parameter name="AntitheticVariate">true</Parameter>    
        <Parameter name="ControlVariate">true</Parameter>    
        <Parameter name="RequiredSamples">10000</Parameter>    
        <Parameter name="RequiredTolerance">0</Parameter>    
        <Parameter name="MaxSamples">0</Parameter>    
        <Parameter name="Seed">42</Parameter>    
        <Parameter name="SensitivityTemplate">FX_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxAsianOptionGeometricStrike, Model BlackScholesMerton, Engine MCDiscreteGeometricASEngine}
\label{lst:peconfig_FxAsianOptionGeometricStrike_BlackScholesMerton_MCDiscreteGeomtetricASEngine}
\end{longlisting}

BlackScholesMerton/AnalyticDiscreteGeometricASEngine builds a AnalyticDiscreteGeometricAverageStrikeAsianEngine. A sample
configuration is shown in listing
\ref{lst:peconfig_FxAsianOptionGeometricStrike_BlackScholesMerton_AnalyticDiscreteGeomtetricASEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxAsianOptionGeometricStrike">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>AnalyticDiscreteGeometricASEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">FX_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxAsianOptionGeometricStrike, Model BlackScholesMerton, Engine AnalyticDiscreteGeomtetricASEngine}
\label{lst:peconfig_FxAsianOptionGeometricStrike_BlackScholesMerton_AnalyticDiscreteGeomtetricASEngine}
\end{longlisting}

ScriptedTrade/ScriptedTrade delegates to the scripted trade engine and the associated pricing engine configuration for
Product Type ScriptedTrade, see there for details. A sample configuration is given in listing
\ref{lst:peconfig_FxAsianOptionGeometricStrike_ScriptedTrade_ScriptedTrade}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxAsianOptionGeometricStrike">
    <Model>ScriptedTrade</Model>
    <ModelParameters/>
    <Engine>ScriptedTrade</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">FX_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxAsianOptionGeometricStrike, Model ScriptedTrade, Engine ScriptedTrade}
\label{lst:peconfig_FxAsianOptionGeometricStrike_ScriptedTrade_ScriptedTrade}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: FxDigitalOption}
%--------------------------------------------------------

Used by trade type: FxDigitalOption

Available Model/Engine pairs: GarmanKohlhagen/AnalyticEuropeanEngine

Engine description:

GarmanKohlhagen/AnalyticEuropeanEngine builds a AnalyticEuropeanEngine. A sample configuration is shown in listing
\ref{lst:peconfig_FxDigitalOption_GarmanKohlhagen_AnalyticEuropeanEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
 <Product type="FxDigitalOption">
    <Model>GarmanKohlhagen</Model>
    <ModelParameters/>
    <Engine>AnalyticEuropeanEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">FX_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxDigitalOption, Model GarmanKohlhagen, Engine AnalyticEuropeanEngine}
\label{lst:peconfig_FxDigitalOption_GarmanKohlhagen_AnalyticEuropeanEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: FxDigitalOptionEuropeanCS}
%--------------------------------------------------------

Used by trade type: FxDigitalOption if cash settled, FxEuropeanBarrierOption

Available Model/Engine pairs: GarmanKohlhagen/AnalyticCashSettledEuropeanEngine

Engine description:

GarmanKohlhagen/AnalyticCashSettledEuropeanEngine builds a AnalyticCashSettledEuropeanEngine. A sample configuration is
shown in listing \ref{lst:peconfig_FxDigitalOptionEuropeanCS_GarmanKohlhagen_AnalyticCashSettledEuropeanEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxDigitalOptionEuropeanCS">
    <Model>GarmanKohlhagen</Model>
    <ModelParameters/>
    <Engine>AnalyticCashSettledEuropeanEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">FX_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxDigitalOptionEuropeanCS, Model GarmanKohlhagen, Engine AnalyticCashSettledEuropeanEngine}
\label{lst:peconfig_FxDigitalOptionEuropeanCS_GarmanKohlhagen_AnalyticCashSettledEuropeanEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: FxDigitalBarrierOption}
%--------------------------------------------------------

Used by trade type: FxDigitalBarrierOption

Available Model/Engine pairs: GarmanKohlhagen/FdBlackScholesBarrierEngine

Engine description:

GarmanKohlhagen/FdBlackScholesBarrierEngine builds a FdBlackScholesBarrierEngine. A sample configuration is shown in
listing \ref{lst:peconfig_FxDigitalBarrierOption_GarmanKohlhagen_FdBlackScholesBarrierEngine}

The parameters have the following meaning:

\begin{itemize}
\item Scheme: The finite difference scheme to use
\item TimeStepsPerYear: Time grid specification
\item XGrid: State grid specification
\item DampingSteps: Number of damping steps taken by FD solver
\item EnforceMonotoneVariance [optional]: If true variance is modified to be monotone if needed, defaults to true
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxDigitalBarrierOption">
    <Model>GarmanKohlhagen</Model>
    <ModelParameters/>
    <Engine>FdBlackScholesBarrierEngine</Engine>
    <EngineParameters>
        <Parameter name="Scheme">Douglas</Parameter>
        <Parameter name="TimeGridPerYear">100</Parameter>
        <Parameter name="XGrid">100</Parameter>
        <Parameter name="DampingSteps">0</Parameter>
        <Parameter name="SensitivityTemplate">FX_FD</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxDigitalBarrierOption, Model GarmanKohlhagen, Engine FdBlackScholesBarrierEngine}
\label{lst:peconfig_FxDigitalBarrierOption_GarmanKohlhagen_FdBlackScholesBarrierEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: FxForward}
%--------------------------------------------------------

Used by trade type: FxForward

Available Model/Engine pairs:

\begin{itemize}
\item DiscountedCashflows/DiscountingFxForwardEngine
\item CrossAssetModel/AMC (for use in AMC simulations only)
\end{itemize}

Engine description:

DiscountedCashflows/DiscountingFxForwardEngine builds a DiscountingFxForwardEngine. A sample configuration is shown in
listing \ref{lst:peconfig_FxForward_DiscountedCashflows_DiscountingFxForwardEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxForward">
    <Model>DiscountedCashflows</Model>
    <ModelParameters/>
    <Engine>DiscountingFxForwardEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">FX_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxForward, Model DiscountedCashflows, Engine DiscountingFxForwardEngine}
\label{lst:peconfig_FxForward_DiscountedCashflows_DiscountingFxForwardEngine}
\end{longlisting}

CrossAssetModel/AMC builds a McCamFxForwardEngine for use in AMC simulations. We refer to the AMC module documentation
for further details.

%--------------------------------------------------------
\subsubsection{Product Type: FxOption}
%--------------------------------------------------------

Used by trade type: FxOption

Available Model/Engine pairs:

\begin{itemize}
\item GarmanKohlhagen/AnalyticEuropeanEngine
\item CrossAssetModel/AMC (for use in AMC simulations only)
\end{itemize}

Engine description:

GarmanKohlhagen/AnalyticEuropeanEngine builds a AnalyticEuropeanEngine. A sample configuration is shown in listing
\ref{lst:peconfig_FxOption_GarmanKohlhagen_AnalyticEuropeanEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxOption">
    <Model>GarmanKohlhagen</Model>
    <ModelParameters/>
    <Engine>AnalyticEuropeanEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxOption, Model GarmanKohlhagen, Engine AnalyticEuropeanEngine}
\label{lst:peconfig_FxOption_GarmanKohlhagen_AnalyticEuropeanEngine}
\end{longlisting}

CrossAssetModel/AMC builds a McCamFxOptionEngine for use in AMC simulations. We refer to the AMC module documentation
for further details.

%--------------------------------------------------------
\subsubsection{Product Type: FxOptionEuropeanCS}
%--------------------------------------------------------

Used by trade type: FxOption if cash settled

Available Model/Engine pairs: GarmanKohlhagen/AnalyticCashSettledEuropeanEngine

Engine description:

GarmanKohlhagen/AnalyticCashSettledEuropeanEngine builds a AnalyticCashSettledEuropeanEngine. A sample configuration is shown in listing
\ref{lst:peconfig_FxOptionEuropeanCS_GarmanKohlhagen_AnalyticCashSettledEuropeanEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxOptionEuropeanCS">
    <Model>GarmanKohlhagen</Model>
    <ModelParameters/>
    <Engine>AnalyticCashSettledEuropeanEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxOptionEuropeanCS, Model GarmanKohlhagen, Engine AnalyticCashSettledEuropeanEngine}
\label{lst:peconfig_FxOptionEuropeanCS_GarmanKohlhagen_AnalyticCashSettledEuropeanEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: FxOptionAmerican}
%--------------------------------------------------------

Used by trade type: FxOption if exercise stly is american

Available Model/Engine pairs:

\begin{itemize}
\item GarmanKohlhagen/FdGarmanKohlhagenVanillaEngine
\item GarmanKohlhagen/BaroneAdesiWhaleyApproximationEngine
\end{itemize}

Engine description:

GarmanKohlhagen/FdBlackScholesVanillaEngine builds a FdBlackScholesVanillaEngine. A sample configuration is shown in listing
\ref{lst:peconfig_FxOptionAmerican_GarmanKohlhagen_FdBlackScholesVanillaEngine}

The parameters have the following meaning:

\begin{itemize}
\item Scheme: The finite difference scheme to use
\item TimeStepsPerYear: Time grid specification
\item XGrid: State grid specification
\item DampingSteps: Number of damping steps taken by FD solver
\item EnforceMonotoneVariance [optional]: If true variance is modified to be monotone if needed, defaults to true
\item TimeGridMinimumSize [optional]: Minimum number in resulting time grid, defaults to $1$ if not given
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxOptionAmerican">
    <Model>GarmanKohlhagen</Model>
    <ModelParameters/>
    <Engine>FdBlackScholesVanillaEngine</Engine>
    <EngineParameters>
        <Parameter name="Scheme">Douglas</Parameter>
        <Parameter name="TimeGridPerYear">100</Parameter>
        <Parameter name="XGrid">100</Parameter>
        <Parameter name="DampingSteps">0</Parameter>
        <Parameter name="EnforceMonotoneVariance">true</Parameter>
        <Parameter name="SensitivityTemplate">COMM_FD</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxOptionAmerican, Model GarmanKohlhagen, Engine FdBlackScholesVanillaEngine}
\label{lst:peconfig_FxOptionAmerican_GarmanKohlhagen_FdBlackScholesVanillaEngine}
\end{longlisting}

GarmanKohlhagen/BaroneAdesiWhaleyApproximationEngine builds a BaroneAdesiWhaleyApproximationEngine. A sample configuration is shown in listing
\ref{lst:peconfig_FxOptionAmerican_GarmanKohlhagen_BaroneAdesiWhaleyApproximationEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxOptionAmerican">
    <Model>GarmanKohlhagen</Model>
    <ModelParameters/>
    <Engine>BaroneAdesiWhaleyApproximationEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxOptionAmerican, Model GarmanKohlhagen, Engine BaroneAdesiWhaleyApproximationEngine}
\label{lst:peconfig_FxOptionAmerican_GarmanKohlhagen_BaroneAdesiWhaleyApproximationEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: FxTouchOption}
%--------------------------------------------------------

Used by trade type: FxTouchOption

Available Model/Engine pairs: GarmanKohlhagen/AnalyticDigitalAmericanEngine

Engine description:

GarmanKohlhagen/AnalyticDigitalAmericanEngine builds a AnalyticDigitalAmericanEngine (one touch) or
AnalyticDigitalAmericanKOEngine (no touch). A sample configuration is shown in listing
\ref{lst:peconfig_FxTouchOption_GarmanKohlhagen_AnalyticDigitalAmericanEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxTouchOption">
    <Model>GarmanKohlhagen</Model>
    <ModelParameters/>
    <Engine>AnalyticDigitalAmericanEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">FX_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product , Model , Engine }
\label{lst:peconfig_FxTouchOption_GarmanKohlhagen_AnalyticDigitalAmericanEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: MultiLegOption}
%--------------------------------------------------------

Used by trade type: MultiLegOption

Available Model/Engine pairs:

\begin{itemize}
\item CrossAssetModel/MC
\item CrossAssetModel/AMC
\end{itemize}

Engine description:

CrossAssetModel/MC builds a McMultiLegOptionEngine. A sample configuration is shown in listing
\ref{lst:peconfig_MultiLegOption_CrossAssetModel_MC}

The parameters have the following meaning:

\begin{itemize}
\item IrCalibration: Bootstrap, BestFit, None
\item IrCalibrationStrategy: CoterminalDealStrike, CoterminalATM
\item ReferenceCalibrationGrid: An optional grid, only one calibration instrument per interval is kept
\item IrReversion: The mean reversion (given per ccy)
\item IrReversionType: Hagan, HullWhite (given per ccy)
\item IrVolatility: The volatility (start value for calibration if calibrated, given per ccy)
\item IrVolatilityType: Hagan, HullWhite (given per ccy)
\item FxVolatility: The fx volatility (start value for calibration if calibrated, given per ccy)
\item Corr\_Key1\_key2: The correlations for ir/fx keys (multiple entries possible)
\item ShiftHorizon: Shift horizon for LGM model as fraction of deal maturity
\item Tolerance: Error tolerance for calibration
\item Training.Sequence: The sequence type for the traning phase, can be MersenneTwister+, MersenneTwisterAntithetc+,
  Sobol+, Burley2020Sobol+, SobolBrownianBridge+, Burley2020SobolBrownianBridge+
\item Training.Seed: The seed for the random number generation in the training phase
\item Training.Samples: The number of samples to be used for the training phase
\item Pricing.Sequence: The sequence type for the pricing phase, same values allowed as for training
\item Training.BasisFunction: The type of basis function system to be used for the regression analysis, can be
  Monomial+, Laguerre+, Hermite+, Hyperbolic+, Legendre+, Chbyshev+, Chebyshev2nd+
\item BasisFunctionOrder: The order of the basis function system to be used
\item Pricing.Seed: The seed for the random number generation in the pricing
\item Pricing.Samples: The number of samples to be used for the pricing phase. If this number is zero, no pricing run is
  performed, instead the (T0) NPV is estimated from the training phase (this result is used to fill the T0 slice of the
  NPV cube)
\item BrownianBridgeOrdering: variate ordering for Brownian bridges, can be Steps+, Factors+, Diagonal+
\item SobolDirectionIntegers: direction integers for Sobol generator, can be Unit+, Jaeckel+, SobolLevitan+,
  SobolLevitanLemieux+, JoeKuoD5+, JoeKuoD6+, JoeKuoD7+, Kuo+, Kuo2+, Kuo3+
\item MinObsDate: if true the conditional expectation of each cashflow is taken from the minimum possible observation
  date (i.e. the latest exercise or simulation date before the cashflow's event date); recommended setting is true+
\item RegressorModel: Simple, LaggedFX. If not given, it defaults to Simple. Depending on the choice the regressor is
  built as follows:
  \begin{itemize}
    \item Simple: For an observation date the full model state observed on this date is included in the regressor. No
      past states are included though.
    \item LaggedFX: For an observation date the full model state observed on this date is included in the regressor. In
      addition, past FX states that are relevant for future cashflows are included. For example, for a FX resettable
      cashflow the FX state observed on the FX reset date is included.
  \end{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="MultiLegOption">
    <Model>CrossAssetModel</Model>
    <ModelParameters>
        <Parameter name="IrCalibration">Bootstrap</Parameter>
        <Parameter name="IrCalibrationStrategy">CoterminalDealStrike</Parameter>
        <Parameter name="FxCalibration">Bootstrap</Parameter>
        <Parameter name="ReferenceCalibrationGrid">400,3M</Parameter>
        <Parameter name="IrReversion_EUR">0.0</Parameter>
        <Parameter name="IrReversionType_EUR">HullWhite</Parameter>
        <Parameter name="IrVolatility_EUR">0.01</Parameter>
        <Parameter name="IrVolatilityType_EUR">Hagan</Parameter>
        <Parameter name="IrReversion_GBP">0.0</Parameter>
        <Parameter name="IrReversionType_GBP">HullWhite</Parameter>
        <Parameter name="IrVolatility_GBP">0.01</Parameter>
        <Parameter name="IrVolatilityType_GBP">Hagan</Parameter>
        <Parameter name="FxVolatility_GBP">0.08</Parameter>
        <Parameter name="Corr_IR:EUR_FX:GBP">0.23</Parameter>
        <Parameter name="ShiftHorizon">0.5</Parameter>
        <Parameter name="Tolerance">0.20</Parameter>
    </ModelParameters>
    <Engine>MC</Engine>
    <EngineParameters>
            <Parameter name="Training.Sequence">MersenneTwisterAntithetic</Parameter>
            <Parameter name="Training.Seed">42</Parameter>
            <Parameter name="Training.Samples">10000</Parameter>
            <Parameter name="Training.BasisFunction">Monomial</Parameter>
            <Parameter name="Training.BasisFunctionOrder">6</Parameter>
            <Parameter name="Pricing.Sequence">SobolBrownianBridge</Parameter>
            <Parameter name="Pricing.Seed">17</Parameter>
            <Parameter name="Pricing.Samples">0</Parameter>
            <Parameter name="BrownianBridgeOrdering">Steps</Parameter>
            <Parameter name="SobolDirectionIntegers">JoeKuoD7</Parameter>
            <Parameter name="MinObsDate">true</Parameter>
            <Parameter name="RegressorModel">Simple</Parameter>
            <Parameter name="SensitivityTemplate">IR_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product MultiLegSwaption, Model BlackBachelier, Engine BlackBachelierSwaptionEngine}
\label{lst:peconfig_MultiLegSwaption_LGM_MC}
\end{longlisting}

LGM/AMC builds a McMultiLegOptionEngine for use in AMC simulations. We refer to the AMC module documentation for further
details.

% ===================== template ========================

%--------------------------------------------------------
\subsubsection{Product Type: }
%--------------------------------------------------------

Used by trade type:

Available Model/Engine pairs:

Engine description:

 builds a . A sample configuration is shown in listing \ref{lst:peconfig_}

The parameters have the following meaning:

\begin{itemize}
\item 
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}

\end{minted}
\caption{Configuration for Product , Model , Engine }
\label{lst:peconfig_}
\end{longlisting}



%--------------------------------------------------------
\subsubsection{Global Parameters}
%--------------------------------------------------------

In addition to product specific settings there is also a block with global parameters with the following meaning:

\begin{itemize}
\item ContinueOnCalibrationError: If set to true an exceedence of a prescribed model calibration tolerance (for e.g. the
  LGM model) will not cause the trade building to fail, instead a warning is logged and the trade is processed
  anyway. Optional, defaults to false.
\item Calibrate: If false, model calibration is disabled. This flag is usually not present in a user configuration, but
  only used internally for certain workflows within ORE which do not require a model calibration. Optional, defaults to
  true.
\item GenerateAdditionalResults: If false, the generation of additional results within pricing engines will be
  suppressed (for those pricing engines which support this). This flag is usually not present in a user configuration,
  but only used internally to improve the performance for processes which only rely on the NPV as a result from pricing
  engines, e.g. when repricing trades under sensitivity or stress scenarios. Option, defaults to false.
\item RunType: Set automatically. One of NPV, SensitivityDelta, SensitivityDeltaGamma, Stress, Exposure, Capital,
  TradeDetails, PortfolioAnalyser, HistoricalPnL, BondSpreadImply, AbsMaturityUpdate depending on the context for which
  a portfolio was built. Might also be left empty. This is used by some pricing engines to adapt to certain run
  types. E.g. a first order sensitivity pnl expansion might be used for a SensitivityDelta run by an engine which is
  able to compute analytical or AAD first order sensitivities.
\end{itemize}
