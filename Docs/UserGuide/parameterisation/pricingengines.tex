%--------------------------------------------------------
\subsection{Pricing Engines: {\tt pricingengine.xml}}
%--------------------------------------------------------
\label{sec:configuration_pricingengines}

The pricing engine configuration file is provided to select pricing models and pricing engines by product type.

%--------------------------------------------------------
\subsubsection{Product Type: EuropeanSwaption}
%--------------------------------------------------------

Used by trade type: Swaption, for European exercise on vanilla underlying coupon types

Available Model/Engine pairs:

\begin{itemize}
\item BlackBachelier/BlackBachelierSwaptionEngine
\item LGM/Grid
\item LGM/FD
\item LGM/MC
\item LGM/AMC
\end{itemize}

Engine description:

BlackBachelier/BlackBachelierSwaptionEngine builds a BlackMultiLegOptionEngine . A sample configuration is shown in
listing \ref{lst:peconfig_EuropeanSwaption_BlackBachelier_BlackBachelierSwaptionEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EuropeanSwaption">
    <Model>BlackBachelier</Model>
    <ModelParameters/>
    <Engine>BlackBachelierSwaptionEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EuropeanSwaption, Model BlackBachelier, Engine BlackBachelierSwaptionEngine}
\label{lst:peconfig_EuropeanSwaption_BlackBachelier_BlackBachelierSwaptionEngine}
\end{longlisting}

LGM/Grid builds a NumericLgmMultiLegOptionEngine using LgmConvoluationSolver as a solver. The rollback follows the paper
``Hagan, P: Methodology for callable swaps and Bermudan exercise into swaptions''. A sample configuration is shown in
listing \ref{lst:peconfig_EuropeanSwaption_LGM_Grid}

The parameters have the following meaning:

\begin{itemize}
\item Calibration: Bootstrap, BestFit, None
\item CalibrationStrategy: CoterminalDealStrike, CoterminalATM
\item ReferenceCalibrationGrid: An optional grid, only one calibration instrument per interval is kept
\item Reversion: The mean reversion
\item ReversionType: Hagan, HullWhite
\item Volatility: The volatility (start value for calibration if calibrated)
\item VolatilityType: Hagan, HullWhite
\item ShiftHorizon: Shift horizon for LGM model as fraction of deal maturity
\item Tolerance: Error tolerance for calibration
\item sy, sx: Number of covered standard deviations (notation as in Hagan's paper)
\item ny, nx: Number of grid points for numerical integration (notation as in Hagan's paper)
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EuropeanSwaption">
    <Model>LGM</Model>
    <ModelParameters>
        <Parameter name="Calibration">Bootstrap</Parameter>
        <Parameter name="CalibrationStrategy">CoterminalDealStrike</Parameter>
        <Parameter name="ReferenceCalibrationGrid">400,3M</Parameter>
        <Parameter name="Reversion">0.0</Parameter>
        <Parameter name="ReversionType">HullWhite</Parameter>
        <Parameter name="Volatility">0.01</Parameter>
        <Parameter name="VolatilityType">Hagan</Parameter>
        <Parameter name="ShiftHorizon">0.5</Parameter>
        <Parameter name="Tolerance">0.20</Parameter>
    </ModelParameters>
    <Engine>Grid</Engine>
    <EngineParameters>
        <Parameter name="sy">5.0</Parameter>
        <Parameter name="ny">30</Parameter>
        <Parameter name="sx">5.0</Parameter>
        <Parameter name="nx">30</Parameter>
        <Parameter name="SensitivityTemplate">IR_FD</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EuropeanSwaption, Model LGM, Engine Grid}
\label{lst:peconfig_EuropeanSwaption_LGM_Grid}
\end{longlisting}

LGM/FD builds a NumericLgmMultiLegOptionEngine using LgmFdSolver as a solver using finite difference. A sample
configuration is shown in listing \ref{lst:peconfig_EuropeanSwaption_LGM_FD}

The parameters have the following meaning:

\begin{itemize}
\item Calibration: Bootstrap, BestFit, None
\item CalibrationStrategy: CoterminalDealStrike, CoterminalATM
\item ReferenceCalibrationGrid: An optional grid, only one calibration instrument per interval is kept
\item Reversion: The mean reversion
\item ReversionType: Hagan, HullWhite
\item Volatility: The volatility (start value for calibration if calibrated)
\item VolatilityType: Hagan, HullWhite
\item ShiftHorizon: Shift horizon for LGM model as fraction of deal maturity
\item Tolerance: Error tolerance for calibration
\item Scheme: The finite difference scheme to use
\item StateGridPoints: The number of grid points in state direction
\item TimeStepsPerYear: The number of time steps per year to use
\item MesherEpsilon: determines the covered probability mass, mass outside state grid is $\Phi^{-1}(1-2\epsilon)$
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EuropeanSwaption">
    <Model>LGM</Model>
    <ModelParameters>
        <Parameter name="Calibration">Bootstrap</Parameter>
        <Parameter name="CalibrationStrategy">CoterminalDealStrike</Parameter>
        <Parameter name="ReferenceCalibrationGrid">400,3M</Parameter>
        <Parameter name="Reversion">0.0</Parameter>
        <Parameter name="ReversionType">HullWhite</Parameter>
        <Parameter name="Volatility">0.01</Parameter>
        <Parameter name="VolatilityType">Hagan</Parameter>
        <Parameter name="ShiftHorizon">0.5</Parameter>
        <Parameter name="Tolerance">0.20</Parameter>
    </ModelParameters>
    <Engine>FD</Engine>
        <EngineParameters>
            <Parameter name="Scheme">Douglas</Parameter>
            <Parameter name="StateGridPoints">64</Parameter>
            <Parameter name="TimeStepsPerYear">24</Parameter>
            <Parameter name="MesherEpsilon">1E-4</Parameter>
        </EngineParameters>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EuropeanSwaption, Model LGM, Engine FD}
\label{lst:peconfig_EuropeanSwaption_LGM_FD}
\end{longlisting}

LGM/MC builds a McMultiLegOptionEngine. A sample configuration is shown in
listing \ref{lst:peconfig_EuropeanSwaption_LGM_MC}

The parameters have the following meaning:

\begin{itemize}
\item Calibration: Bootstrap, BestFit, None
\item CalibrationStrategy: CoterminalDealStrike, CoterminalATM
\item ReferenceCalibrationGrid: An optional grid, only one calibration instrument per interval is kept
\item Reversion: The mean reversion
\item ReversionType: Hagan, HullWhite
\item Volatility: The volatility (start value for calibration if calibrated)
\item VolatilityType: Hagan, HullWhite
\item ShiftHorizon: Shift horizon for LGM model as fraction of deal maturity
\item Tolerance: Error tolerance for calibration
\item Training.Sequence: The sequence type for the traning phase, can be MersenneTwister+, MersenneTwisterAntithetc+,
  Sobol+, Burley2020Sobol+, SobolBrownianBridge+, Burley2020SobolBrownianBridge+
\item Training.Seed: The seed for the random number generation in the training phase
\item Training.Samples: The number of samples to be used for the training phase
\item Pricing.Sequence: The sequence type for the pricing phase, same values allowed as for training
\item Training.BasisFunction: The type of basis function system to be used for the regression analysis, can be
  Monomial+, Laguerre+, Hermite+, Hyperbolic+, Legendre+, Chbyshev+, Chebyshev2nd+
\item BasisFunctionOrder: The order of the basis function system to be used
\item Pricing.Seed: The seed for the random number generation in the pricing
\item Pricing.Samples: The number of samples to be used for the pricing phase. If this number is zero, no pricing run is
  performed, instead the (T0) NPV is estimated from the training phase (this result is used to fill the T0 slice of the
  NPV cube)
\item BrownianBridgeOrdering: variate ordering for Brownian bridges, can be Steps+, Factors+, Diagonal+
\item SobolDirectionIntegers: direction integers for Sobol generator, can be Unit+, Jaeckel+, SobolLevitan+,
  SobolLevitanLemieux+, JoeKuoD5+, JoeKuoD6+, JoeKuoD7+, Kuo+, Kuo2+, Kuo3+
\item MinObsDate: if true the conditional expectation of each cashflow is taken from the minimum possible observation
  date (i.e. the latest exercise or simulation date before the cashflow's event date); recommended setting is true+
\item RegressorModel: Simple, LaggedFX. If not given, it defaults to Simple. Depending on the choice the regressor is
  built as follows:
  \begin{itemize}
    \item Simple: For an observation date the full model state observed on this date is included in the regressor. No
      past states are included though.
    \item LaggedFX: For an observation date the full model state observed on this date is included in the regressor. In
      addition, past FX states that are relevant for future cashflows are included. For example, for a FX resettable
      cashflow the FX state observed on the FX reset date is included.
  \end{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EuropeanSwaption">
    <Model>LGM</Model>
    <ModelParameters>
        <Parameter name="Calibration">Bootstrap</Parameter>
        <Parameter name="CalibrationStrategy">CoterminalDealStrike</Parameter>
        <Parameter name="ReferenceCalibrationGrid">400,3M</Parameter>
        <Parameter name="Reversion">0.0</Parameter>
        <Parameter name="ReversionType">HullWhite</Parameter>
        <Parameter name="Volatility">0.01</Parameter>
        <Parameter name="VolatilityType">Hagan</Parameter>
        <Parameter name="ShiftHorizon">0.5</Parameter>
        <Parameter name="Tolerance">0.20</Parameter>
    </ModelParameters>
    <Engine>MC</Engine>
    <EngineParameters>
        <Parameter name="Training.Sequence">MersenneTwisterAntithetic</Parameter>
        <Parameter name="Training.Seed">42</Parameter>
        <Parameter name="Training.Samples">10000</Parameter>
        <Parameter name="Training.BasisFunction">Monomial</Parameter>
        <Parameter name="Training.BasisFunctionOrder">6</Parameter>
        <Parameter name="Pricing.Sequence">SobolBrownianBridge</Parameter>
        <Parameter name="Pricing.Seed">17</Parameter>
        <Parameter name="Pricing.Samples">0</Parameter>
        <Parameter name="BrownianBridgeOrdering">Steps</Parameter>
        <Parameter name="SobolDirectionIntegers">JoeKuoD7</Parameter>
        <Parameter name="MinObsDate">true</Parameter>
        <Parameter name="RegressorModel">Simple</Parameter>
        <Parameter name="SensitivityTemplate">IR_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EuropeanSwaption, Model BlackBachelier, Engine BlackBachelierSwaptionEngine}
\label{lst:peconfig_EuropeanSwaption_LGM_MC}
\end{longlisting}

LGM/AMC builds a McMultiLegOptionEngine for use in AMC simulations. We refer to the AMC module documentation for further
details.

%--------------------------------------------------------
\subsubsection{Product Type: BermudanSwaption}
%--------------------------------------------------------

Used by trade type: Swaption, for Bermudan exercise on vanilla underlying coupon types

Available Model/Engine pairs:

\begin{itemize}
\item LGM/Grid
\item LGM/FD
\item LGM/MC
\item LGM/AMC
\end{itemize}

Engine description:

LGM/Grid builds a NumericLgmMultiLegOptionEngine using LgmConvoluationSolver as a solver. The rollback follows the paper
``Hagan, P: Methodology for callable swaps and Bermudan exercise into swaptions''. A sample configuration is shown in
listing \ref{lst:peconfig_BermudanSwaption_LGM_Grid}

The parameters have the following meaning:

\begin{itemize}
\item Calibration: Bootstrap, BestFit, None
\item CalibrationStrategy: CoterminalDealStrike, CoterminalATM
\item ReferenceCalibrationGrid: An optional grid, only one calibration instrument per interval is kept
\item Reversion: The mean reversion
\item ReversionType: Hagan, HullWhite
\item Volatility: The volatility (start value for calibration if calibrated)
\item VolatilityType: Hagan, HullWhite
\item ShiftHorizon: Shift horizon for LGM model as fraction of deal maturity
\item Tolerance: Error tolerance for calibration
\item sy, sx: Number of covered standard deviations (notation as in Hagan's paper)
\item ny, nx: Number of grid points for numerical integration (notation as in Hagan's paper)
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="BermudanSwaption">
    <Model>LGM</Model>
    <ModelParameters>
        <Parameter name="Calibration">Bootstrap</Parameter>
        <Parameter name="CalibrationStrategy">CoterminalDealStrike</Parameter>
        <Parameter name="ReferenceCalibrationGrid">400,3M</Parameter>
        <Parameter name="Reversion">0.0</Parameter>
        <Parameter name="ReversionType">HullWhite</Parameter>
        <Parameter name="Volatility">0.01</Parameter>
        <Parameter name="VolatilityType">Hagan</Parameter>
        <Parameter name="ShiftHorizon">0.5</Parameter>
        <Parameter name="Tolerance">0.20</Parameter>
    </ModelParameters>
    <Engine>Grid</Engine>
    <EngineParameters>
        <Parameter name="sy">5.0</Parameter>
        <Parameter name="ny">30</Parameter>
        <Parameter name="sx">5.0</Parameter>
        <Parameter name="nx">30</Parameter>
        <Parameter name="SensitivityTemplate">IR_FD</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product BermudanSwaption, Model LGM, Engine Grid}
\label{lst:peconfig_BermudanSwaption_LGM_Grid}
\end{longlisting}

LGM/FD builds a NumericLgmMultiLegOptionEngine using LgmFdSolver as a solver using finite difference. A sample
configuration is shown in listing \ref{lst:peconfig_BermudanSwaption_LGM_FD}

The parameters have the following meaning:

\begin{itemize}
\item Calibration: Bootstrap, BestFit, None
\item CalibrationStrategy: CoterminalDealStrike, CoterminalATM
\item ReferenceCalibrationGrid: An optional grid, only one calibration instrument per interval is kept
\item Reversion: The mean reversion
\item ReversionType: Hagan, HullWhite
\item Volatility: The volatility (start value for calibration if calibrated)
\item VolatilityType: Hagan, HullWhite
\item ShiftHorizon: Shift horizon for LGM model as fraction of deal maturity
\item Tolerance: Error tolerance for calibration
\item Scheme: The finite difference scheme to use
\item StateGridPoints: The number of grid points in state direction
\item TimeStepsPerYear: The number of time steps per year to use
\item MesherEpsilon: determines the covered probability mass, mass outside state grid is $\Phi^{-1}(1-2\epsilon)$
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="BermudanSwaption">
    <Model>LGM</Model>
    <ModelParameters>
        <Parameter name="Calibration">Bootstrap</Parameter>
        <Parameter name="CalibrationStrategy">CoterminalDealStrike</Parameter>
        <Parameter name="ReferenceCalibrationGrid">400,3M</Parameter>
        <Parameter name="Reversion">0.0</Parameter>
        <Parameter name="ReversionType">HullWhite</Parameter>
        <Parameter name="Volatility">0.01</Parameter>
        <Parameter name="VolatilityType">Hagan</Parameter>
        <Parameter name="ShiftHorizon">0.5</Parameter>
        <Parameter name="Tolerance">0.20</Parameter>
    </ModelParameters>
    <Engine>FD</Engine>
    <EngineParameters>
        <Parameter name="Scheme">Douglas</Parameter>
        <Parameter name="StateGridPoints">64</Parameter>
        <Parameter name="TimeStepsPerYear">24</Parameter>
        <Parameter name="MesherEpsilon">1E-4</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product BermudanSwaption, Model LGM, Engine FD}
\label{lst:peconfig_BermudanSwaption_LGM_FD}
\end{longlisting}

LGM/MC builds a McMultiLegOptionEngine. A sample configuration is shown in
listing \ref{lst:peconfig_BermudanSwaption_LGM_MC}

The parameters have the following meaning:

\begin{itemize}
\item Calibration: Bootstrap, BestFit, None
\item CalibrationStrategy: CoterminalDealStrike, CoterminalATM
\item ReferenceCalibrationGrid: An optional grid, only one calibration instrument per interval is kept
\item Reversion: The mean reversion
\item ReversionType: Hagan, HullWhite
\item Volatility: The volatility (start value for calibration if calibrated)
\item VolatilityType: Hagan, HullWhite
\item ShiftHorizon: Shift horizon for LGM model as fraction of deal maturity
\item Tolerance: Error tolerance for calibration
\item Training.Sequence: The sequence type for the traning phase, can be MersenneTwister+, MersenneTwisterAntithetc+,
  Sobol+, Burley2020Sobol+, SobolBrownianBridge+, Burley2020SobolBrownianBridge+
\item Training.Seed: The seed for the random number generation in the training phase
\item Training.Samples: The number of samples to be used for the training phase
\item Pricing.Sequence: The sequence type for the pricing phase, same values allowed as for training
\item Training.BasisFunction: The type of basis function system to be used for the regression analysis, can be
  Monomial+, Laguerre+, Hermite+, Hyperbolic+, Legendre+, Chbyshev+, Chebyshev2nd+
\item BasisFunctionOrder: The order of the basis function system to be used
\item Pricing.Seed: The seed for the random number generation in the pricing
\item Pricing.Samples: The number of samples to be used for the pricing phase. If this number is zero, no pricing run is
  performed, instead the (T0) NPV is estimated from the training phase (this result is used to fill the T0 slice of the
  NPV cube)
\item BrownianBridgeOrdering: variate ordering for Brownian bridges, can be Steps+, Factors+, Diagonal+
\item SobolDirectionIntegers: direction integers for Sobol generator, can be Unit+, Jaeckel+, SobolLevitan+,
  SobolLevitanLemieux+, JoeKuoD5+, JoeKuoD6+, JoeKuoD7+, Kuo+, Kuo2+, Kuo3+
\item MinObsDate: if true the conditional expectation of each cashflow is taken from the minimum possible observation
  date (i.e. the latest exercise or simulation date before the cashflow's event date); recommended setting is true+
\item RegressorModel: Simple, LaggedFX. If not given, it defaults to Simple. Depending on the choice the regressor is
  built as follows:
  \begin{itemize}
    \item Simple: For an observation date the full model state observed on this date is included in the regressor. No
      past states are included though.
    \item LaggedFX: For an observation date the full model state observed on this date is included in the regressor. In
      addition, past FX states that are relevant for future cashflows are included. For example, for a FX resettable
      cashflow the FX state observed on the FX reset date is included.
  \end{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="BermudanSwaption">
    <Model>LGM</Model>
    <ModelParameters>
        <Parameter name="Calibration">Bootstrap</Parameter>
        <Parameter name="CalibrationStrategy">CoterminalDealStrike</Parameter>
        <Parameter name="ReferenceCalibrationGrid">400,3M</Parameter>
        <Parameter name="Reversion">0.0</Parameter>
        <Parameter name="ReversionType">HullWhite</Parameter>
        <Parameter name="Volatility">0.01</Parameter>
        <Parameter name="VolatilityType">Hagan</Parameter>
        <Parameter name="ShiftHorizon">0.5</Parameter>
        <Parameter name="Tolerance">0.20</Parameter>
    </ModelParameters>
    <Engine>MC</Engine>
    <EngineParameters>
        <Parameter name="Training.Sequence">MersenneTwisterAntithetic</Parameter>
        <Parameter name="Training.Seed">42</Parameter>
        <Parameter name="Training.Samples">10000</Parameter>
        <Parameter name="Training.BasisFunction">Monomial</Parameter>
        <Parameter name="Training.BasisFunctionOrder">6</Parameter>
        <Parameter name="Pricing.Sequence">SobolBrownianBridge</Parameter>
        <Parameter name="Pricing.Seed">17</Parameter>
        <Parameter name="Pricing.Samples">0</Parameter>
        <Parameter name="BrownianBridgeOrdering">Steps</Parameter>
        <Parameter name="SobolDirectionIntegers">JoeKuoD7</Parameter>
        <Parameter name="MinObsDate">true</Parameter>
        <Parameter name="RegressorModel">Simple</Parameter>
        <Parameter name="SensitivityTemplate">IR_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product BermudanSwaption, Model BlackBachelier, Engine BlackBachelierSwaptionEngine}
\label{lst:peconfig_BermudanSwaption_LGM_MC}
\end{longlisting}

LGM/AMC builds a McMultiLegOptionEngine for use in AMC simulations. We refer to the AMC module documentation for further
details.

%--------------------------------------------------------
\subsubsection{Product Type: AmericanSwaption}
%--------------------------------------------------------

Used by trade type: Swaption, for American exercise on vanilla underlying coupon types

Available Model/Engine pairs:

\begin{itemize}
\item LGM/FD
\item LGM/Grid (Not recommended due to inferior performance)
\item LGM/MC
\item LGM/AMC
\end{itemize}

Engine description:

LGM/FD builds a NumericLgmMultiLegOptionEngine using LgmFdSolver as a solver using finite difference. A sample
configuration is shown in listing \ref{lst:peconfig_AmericanSwaption_LGM_FD}

The parameters have the following meaning:

\begin{itemize}
\item Calibration: Bootstrap, BestFit, None
\item CalibrationStrategy: CoterminalDealStrike, CoterminalATM
\item ReferenceCalibrationGrid: An optional grid, only one calibration instrument per interval is kept
\item Reversion: The mean reversion
\item ReversionType: Hagan, HullWhite
\item Volatility: The volatility (start value for calibration if calibrated)
\item VolatilityType: Hagan, HullWhite
\item ShiftHorizon: Shift horizon for LGM model as fraction of deal maturity
\item Tolerance: Error tolerance for calibration
\item Scheme: The finite difference scheme to use
\item StateGridPoints: The number of grid points in state direction
\item TimeStepsPerYear: The number of time steps per year to use
\item MesherEpsilon: determines the covered probability mass, mass outside state grid is $\Phi^{-1}(1-2\epsilon)$
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="AmericanSwaption">
    <Model>LGM</Model>
    <ModelParameters>
        <Parameter name="Calibration">Bootstrap</Parameter>
        <Parameter name="CalibrationStrategy">CoterminalDealStrike</Parameter>
        <Parameter name="ReferenceCalibrationGrid">400,3M</Parameter>
        <Parameter name="Reversion">0.0</Parameter>
        <Parameter name="ReversionType">HullWhite</Parameter>
        <Parameter name="Volatility">0.01</Parameter>
        <Parameter name="VolatilityType">Hagan</Parameter>
        <Parameter name="ShiftHorizon">0.5</Parameter>
        <Parameter name="Tolerance">0.20</Parameter>
    </ModelParameters>
    <Engine>FD</Engine>
    <EngineParameters>
        <Parameter name="Scheme">Douglas</Parameter>
        <Parameter name="StateGridPoints">64</Parameter>
        <Parameter name="TimeStepsPerYear">24</Parameter>
        <Parameter name="MesherEpsilon">1E-4</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product AmericanSwaption, Model LGM, Engine FD}
\label{lst:peconfig_AmericanSwaption_LGM_FD}
\end{longlisting}

LGM/Grid builds a NumericLgmMultiLegOptionEngine using LgmConvoluationSolver as a solver. The rollback follows the paper
``Hagan, P: Methodology for callable swaps and American exercise into swaptions''. A sample configuration is shown in
listing \ref{lst:peconfig_AmericanSwaption_LGM_Grid}. Not recommended due to inferior performance.

The parameters have the following meaning:

\begin{itemize}
\item Calibration: Bootstrap, BestFit, None
\item CalibrationStrategy: CoterminalDealStrike, CoterminalATM
\item ReferenceCalibrationGrid: An optional grid, only one calibration instrument per interval is kept
\item Reversion: The mean reversion
\item ReversionType: Hagan, HullWhite
\item Volatility: The volatility (start value for calibration if calibrated)
\item VolatilityType: Hagan, HullWhite
\item ShiftHorizon: Shift horizon for LGM model as fraction of deal maturity
\item Tolerance: Error tolerance for calibration
\item sy, sx: Number of covered standard deviations (notation as in Hagan's paper)
\item ny, nx: Number of grid points for numerical integration (notation as in Hagan's paper)
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="AmericanSwaption">
    <Model>LGM</Model>
    <ModelParameters>
        <Parameter name="Calibration">Bootstrap</Parameter>
        <Parameter name="CalibrationStrategy">CoterminalDealStrike</Parameter>
        <Parameter name="ReferenceCalibrationGrid">400,3M</Parameter>
        <Parameter name="Reversion">0.0</Parameter>
        <Parameter name="ReversionType">HullWhite</Parameter>
        <Parameter name="Volatility">0.01</Parameter>
        <Parameter name="VolatilityType">Hagan</Parameter>
        <Parameter name="ShiftHorizon">0.5</Parameter>
        <Parameter name="Tolerance">0.20</Parameter>
    </ModelParameters>
    <Engine>Grid</Engine>
    <EngineParameters>
        <Parameter name="sy">5.0</Parameter>
        <Parameter name="ny">30</Parameter>
        <Parameter name="sx">5.0</Parameter>
        <Parameter name="nx">30</Parameter>
        <Parameter name="SensitivityTemplate">IR_FD</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product AmericanSwaption, Model LGM, Engine Grid (Not recommended due to inferior performance)}
\label{lst:peconfig_AmericanSwaption_LGM_Grid}
\end{longlisting}

LGM/MC builds a McMultiLegOptionEngine. A sample configuration is shown in
listing \ref{lst:peconfig_AmericanSwaption_LGM_MC}

The parameters have the following meaning:

\begin{itemize}
\item Calibration: Bootstrap, BestFit, None
\item CalibrationStrategy: CoterminalDealStrike, CoterminalATM
\item ReferenceCalibrationGrid: An optional grid, only one calibration instrument per interval is kept
\item Reversion: The mean reversion
\item ReversionType: Hagan, HullWhite
\item Volatility: The volatility (start value for calibration if calibrated)
\item VolatilityType: Hagan, HullWhite
\item ShiftHorizon: Shift horizon for LGM model as fraction of deal maturity
\item Tolerance: Error tolerance for calibration
\item Training.Sequence: The sequence type for the traning phase, can be MersenneTwister+, MersenneTwisterAntithetc+,
  Sobol+, Burley2020Sobol+, SobolBrownianBridge+, Burley2020SobolBrownianBridge+
\item Training.Seed: The seed for the random number generation in the training phase
\item Training.Samples: The number of samples to be used for the training phase
\item Pricing.Sequence: The sequence type for the pricing phase, same values allowed as for training
\item Training.BasisFunction: The type of basis function system to be used for the regression analysis, can be
  Monomial+, Laguerre+, Hermite+, Hyperbolic+, Legendre+, Chbyshev+, Chebyshev2nd+
\item BasisFunctionOrder: The order of the basis function system to be used
\item Pricing.Seed: The seed for the random number generation in the pricing
\item Pricing.Samples: The number of samples to be used for the pricing phase. If this number is zero, no pricing run is
  performed, instead the (T0) NPV is estimated from the training phase (this result is used to fill the T0 slice of the
  NPV cube)
\item BrownianBridgeOrdering: variate ordering for Brownian bridges, can be Steps+, Factors+, Diagonal+
\item SobolDirectionIntegers: direction integers for Sobol generator, can be Unit+, Jaeckel+, SobolLevitan+,
  SobolLevitanLemieux+, JoeKuoD5+, JoeKuoD6+, JoeKuoD7+, Kuo+, Kuo2+, Kuo3+
\item MinObsDate: if true the conditional expectation of each cashflow is taken from the minimum possible observation
  date (i.e. the latest exercise or simulation date before the cashflow's event date); recommended setting is true+
\item RegressorModel: Simple, LaggedFX. If not given, it defaults to Simple. Depending on the choice the regressor is
  built as follows:
  \begin{itemize}
    \item Simple: For an observation date the full model state observed on this date is included in the regressor. No
      past states are included though.
    \item LaggedFX: For an observation date the full model state observed on this date is included in the regressor. In
      addition, past FX states that are relevant for future cashflows are included. For example, for a FX resettable
      cashflow the FX state observed on the FX reset date is included.
  \end{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="AmericanSwaption">
    <Model>LGM</Model>
    <ModelParameters>
        <Parameter name="Calibration">Bootstrap</Parameter>
        <Parameter name="CalibrationStrategy">CoterminalDealStrike</Parameter>
        <Parameter name="ReferenceCalibrationGrid">400,3M</Parameter>
        <Parameter name="Reversion">0.0</Parameter>
        <Parameter name="ReversionType">HullWhite</Parameter>
        <Parameter name="Volatility">0.01</Parameter>
        <Parameter name="VolatilityType">Hagan</Parameter>
        <Parameter name="ShiftHorizon">0.5</Parameter>
        <Parameter name="Tolerance">0.20</Parameter>
    </ModelParameters>
    <Engine>MC</Engine>
    <EngineParameters>
        <Parameter name="Training.Sequence">MersenneTwisterAntithetic</Parameter>
        <Parameter name="Training.Seed">42</Parameter>
        <Parameter name="Training.Samples">10000</Parameter>
        <Parameter name="Training.BasisFunction">Monomial</Parameter>
        <Parameter name="Training.BasisFunctionOrder">6</Parameter>
        <Parameter name="Pricing.Sequence">SobolBrownianBridge</Parameter>
        <Parameter name="Pricing.Seed">17</Parameter>
        <Parameter name="Pricing.Samples">0</Parameter>
        <Parameter name="BrownianBridgeOrdering">Steps</Parameter>
        <Parameter name="SobolDirectionIntegers">JoeKuoD7</Parameter>
        <Parameter name="MinObsDate">true</Parameter>
        <Parameter name="RegressorModel">Simple</Parameter>
        <Parameter name="SensitivityTemplate">IR_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product AmericanSwaption, Model BlackBachelier, Engine BlackBachelierSwaptionEngine}
\label{lst:peconfig_AmericanSwaption_LGM_MC}
\end{longlisting}

LGM/AMC builds a McMultiLegOptionEngine for use in AMC simulations. We refer to the AMC module documentation for further
details.

%--------------------------------------------------------
\subsubsection{Product Type: BondRepo}
%--------------------------------------------------------

Used by trade type: BondRepo

Available Model/Engine pairs:

\begin{itemize}
\item DiscountedCashflows/DiscountingRepoEngine
\item Accrual/AccrualRepoEngine
\end{itemize}

Engine description:

DiscountedCashflows/DiscountingRepoEngine builds a DiscountingBondRepoEngine. A sample configuration is shown in listing
\ref{lst:peconfig_BondRepo_DiscountedCashflows_DiscountingRepoEngine}.

The parameters have the following meaning:

\begin{itemize}
\item IncludeSecurityLeg: include the security leg in the valuation
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="BondRepo">
    <Model>DiscountedCashflows</Model>
    <ModelParameters>
        <Parameter name="IncludeSecurityLeg">true</Parameter>
    </ModelParameters>
    <Engine>DiscountingRepoEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product BondRepo, Model DiscountedCashflows, Engine DiscountingRepoEngine}
\label{lst:peconfig_BondRepo_DiscountedCashflows_DiscountingRepoEngine}
\end{longlisting}

Accrual/AccrualRepoEngine builds a AccrualBondRepoEngine. A sample configuration is shown in listing
\ref{lst:peconfig_BondRepo_Accrual_AccrualBondRepoEngine}.

The parameters have the following meaning:

\begin{itemize}
\item IncludeSecurityLeg: include the security leg in the valuation
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
Product type="BondRepo">
    <Model>Accrual</Model>
    <ModelParameters>
        <Parameter name="IncludeSecurityLeg">true</Parameter>
    </ModelParameters>
    <Engine>AccrualRepoEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product BondRepo, Model Accrual, Engine DiscountingBondRepoEngine}
\label{lst:peconfig_BondRepo_Accrual_AccrualBondRepoEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: BondTRS}
%--------------------------------------------------------

Used by trade type: BondTRS

Available Model/Engine pairs: DiscountedCashflows/DiscountingBondTRSEngine

Engine description:

DiscountedCashflows/DiscountingBondTRSEngine builds a DisountingBondTRSEngine. A sample configuration is shown in listing \ref{lst:peconfig_BondTRS_DiscountedCashflows_DiscountedCashflows/DiscountingBondTRSEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="BondTRS">
    <Model>DiscountedCashflows</Model>
    <ModelParameters/>
    <Engine>DiscountingBondTRSEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product BondTRS , Model DiscountedCashflows, Engine DiscountingBondTRSEngine}
\label{lst:peconfig_BondTRS_DiscountedCashflows_DiscountedCashflows/DiscountingBondTRSEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CapFloor}
%--------------------------------------------------------

Used by trade type: CapFloor on underlying Ibor with subperiods (all other underlying use their respective coupon pricers)

Available Model/Engine pairs: IborCapModel/IborCapEngine

Engine description:

IborCapModel/IborCapEngine builds a BlackCapFloorEngine or BachelierCapFloorEngine depending on the input volatility
type. A sample configuration is shown in listing \ref{lst:peconfig_CapFloor_IborCapModel_IborCapEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CapFloor">
    <Model>IborCapModel</Model>
    <ModelParameters/>
    <Engine>IborCapEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CapFloor, Model IborCapModel, Engine IborCapEngine}
\label{lst:peconfig_CapFloor_IborCapModel_IborCapEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CapFlooredIborLeg}
%--------------------------------------------------------

Used by trade type: any trade with a cap / floored ibor / rfr term rate leg

Available Model/Engine pairs: BlackOrBachelier/BlackIborCouponPricer

Engine description:

BlackOrBachelier/BlackIborCouponPricer builds a BlackIborCouponPricer. A sample configuration is
shown in listing \ref{lst:peconfig_CapFlooredIborLeg_BlackOrBachelier_BlackIborCouponPricer}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CapFlooredIborCouponLeg">
    <Model>BlackOrBachelier</Model>
    <ModelParameters/>
    <Engine>BlackIborCouponPricer</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CapFlooredIborLeg, Model BlackOrBachelier, Engine BlackIborCouponPricer}
\label{lst:peconfig_CapFlooredIborLeg_BlackOrBachelier_BlackIborCouponPricer}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CapFlooredOvernightIndexedCouponLeg}
%--------------------------------------------------------

Used by trade type: any trade with a cap / floored OIS leg

Available Model/Engine pairs: BlackOrBachelier/BlackOvernightIndexedCouponPricer

Engine description:

BlackOrBachelier/BlackOvernightIndexedCouponPricer builds a BlackOvernightIndexedCouponPricer. A sample configuration is
shown in listing \ref{lst:peconfig_CapFlooredOvernightIndexedCouponLeg_BlackOrBachelier_BlackOvernightIndexedCouponPricer}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CapFlooredOvernightIndexedCouponLeg">
    <Model>BlackOrBachelier</Model>
    <ModelParameters/>
    <Engine>BlackOvernightIndexedCouponPricer</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CapFlooredOvernightIndexedCouponLeg, Model BlackOrBachelier, Engine BlackOvernightIndexedCouponPricer}
\label{lst:peconfig_CapFlooredOvernightIndexedCouponLeg_BlackOrBachelier_BlackOvernightIndexedCouponPricer}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CapFlooredAverageONIndexedCouponLeg}
%--------------------------------------------------------

Used by trade type: any trade with a cap / floored OIS leg

Available Model/Engine pairs: BlackOrBachelier/BlackAverageONIndexedCouponPricer

Engine description:

BlackOrBachelier/BlackAverageONIndexedCouponPricer builds a BlackAverageONIndexedCouponPricer. A sample configuration is
shown in listing \ref{lst:peconfig_CapFlooredAverageONIndexedCouponLeg_BlackOrBachelier_BlackAverageONIndexedCouponPricer}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CapFlooredAverageONIndexedCouponLeg">
    <Model>BlackOrBachelier</Model>
    <ModelParameters/>
    <Engine>BlackAverageONIndexedCouponPricer</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CapFlooredAverageONIndexedCouponLeg, Model BlackOrBachelier, Engine BlackAverageONIndexedCouponPricer}
\label{lst:peconfig_CapFlooredAverageONIndexedCouponLeg_BlackOrBachelier_BlackAverageONIndexedCouponPricer}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CapFlooredAverageBMAIndexedCouponLeg}
%--------------------------------------------------------

Used by trade type: any trade with a cap / floored OIS leg

Available Model/Engine pairs: BlackOrBachelier/BlackAverageBMAIndexedCouponPricer

Engine description:

BlackOrBachelier/BlackAverageBMAIndexedCouponPricer builds a BlackAverageBMAIndexedCouponPricer. A sample configuration is
shown in listing \ref{lst:peconfig_CapFlooredAverageBMAIndexedCouponLeg_BlackOrBachelier_BlackAverageBMAIndexedCouponPricer}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CapFlooredAverageBMAIndexedCouponLeg">
    <Model>BlackOrBachelier</Model>
    <ModelParameters/>
    <Engine>BlackAverageBMAIndexedCouponPricer</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CapFlooredAverageBMAIndexedCouponLeg, Model BlackOrBachelier, Engine BlackAverageBMAIndexedCouponPricer}
\label{lst:peconfig_CapFlooredAverageBMAIndexedCouponLeg_BlackOrBachelier_BlackAverageBMAIndexedCouponPricer}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CappedFlooredCpiLegCoupons}
%--------------------------------------------------------

Used by trade type: any trade with a cap / floored CPI leg (coupons)

Available Model/Engine pairs: Black/BlackAnalytic

Engine description:

Black/BlackAnalytic builds a BlackCPICouponPricer or BachelierCPICouponPricer, depending on the volatility input. A sample configuration is
shown in listing \ref{lst:peconfig_CapFlooredCpiLegCoupons_Black_BlackAnalytic}

The parameters have the following meaning:

\begin{itemize}
\item useLastFixingDate: if true, use the last known fixing date as the base date of the volatility structure, otherwise
  use observation lag        
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CapFlooredCpiLegCoupons">
    <Model>Black</Model>
    <ModelParameters/>
    <Engine>BlackAnalytic</Engine>
    <EngineParameters>
          <Parameter name="useLastFixingDate">true</Parameter>
      <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CapFlooredCpiLegCoupons, Model Black, Engine BlackAnalytic}
\label{lst:peconfig_CapFlooredCpiLegCoupons_Black_BlackAnalytic}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CappedFlooredCpiLegCashFlows}
%--------------------------------------------------------

Used by trade type: any trade with a cap / floored CPI leg (cashflows)

Available Model/Engine pairs: Black/BlackAnalytic

Engine description:

Black/BlackAnalytic builds a BlackCPICashFLowPricer or BachelierCPICashFlowPricer, depending on the volatility input. A sample configuration is
shown in listing \ref{lst:peconfig_CappedFlooredCpiLegCashFlows_Black_BlackAnalytic}

The parameters have the following meaning:

\begin{itemize}
\item useLastFixingDate: if true, use the last known fixing date as the base date of the volatility structure, otherwise
  use observation lag        
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CappedFlooredCpiLegCashFlows">
    <Model>Black</Model>
    <ModelParameters/>
    <Engine>BlackAnalytic</Engine>
    <EngineParameters>
          <Parameter name="useLastFixingDate">true</Parameter>
      <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CapFlooredCpiLegCoupons, Model Black, Engine BlackAnalytic}
\label{lst:peconfig_CappedFlooredCpiLegCashFlows_Black_BlackAnalytic}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CommodityAveragePriceOption}
%--------------------------------------------------------

Used by trade type: CommodityAveragePriceOption

Available Model/Engine pairs:

\begin{itemize}
\item Black/AnalyticalApproximation
\item Black/MonteCarlo
\end{itemize}

Engine description:

Black/AnalyticalApproximation builds a CommodityAveragePriceOptionAnalyticalEngine. The correlation between two future
contracts is parametrized as

$$\rho(s, t) = e^{-\beta |s-t|}$$

where $s$ and $t$ are times to futures expiry. A sample configuration is shown in listing
\ref{lst:peconfig_CommodityAveragePriceOption_Black_AnalyticalApproximation}.

The parameters have the following meaning:

\begin{itemize}
\item beta: parameter in correlation parametrization
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAveragePriceOption">
    <Model>Black</Model>
    <ModelParameters/>
    <Engine>AnalyticalApproximation</Engine>
    <EngineParameters>
        <Parameter name="beta">0</Parameter>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAveragePriceOption, Model Black, Engine AnalyticalApproximation}
\label{lst:peconfig_CommodityAveragePriceOption_Black_AnalyticalApproximation}
\end{longlisting}

Black/MonteCarlo builds a CommodityAveragePriceOptionMonteCarloEngine. A sample configuration is shown in listing
\ref{lst:peconfig_CommodityAveragePriceOption_Black_MonteCarlo}.

The parameters have the following meaning:

\begin{itemize}
\item samples: the number of Monte Carlo Samples
\item beta: parameter in correlation parametrization
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAveragePriceOption">
    <Model>Black</Model>
    <ModelParameters/>
    <Engine>MonteCarlo</Engine>
    <EngineParameters>
        <Parameter name="samples">10000</Parameter>
        <Parameter name="beta">0</Parameter>
        <Parameter name="SensitivityTemplate">COMM_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAveragePriceOption, Model Black, Engine MonteCarlo}
\label{lst:peconfig_CommodityAveragePriceOption_Black_MonteCarlo}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CommodityAveragePriceBarrierOption}
%--------------------------------------------------------

Used by trade type: CommodityAveragePriceOption with BarrierData

Available Model/Engine pairs:

\begin{itemize}
\item Black/MonteCarlo
\end{itemize}

Engine description:

Black/MonteCarlo builds a CommodityAveragePriceOptionAnalyticalEngine. The correlation between two future contracts is
parametrized as

$$\rho(s, t) = e^{-\beta |s-t|}$$

where $s$ and $t$ are times to futures expiry. A sample configuration is shown in listing
\ref{lst:peconfig_CommodityAveragePriceBarrierOption_Black_MonteCarlo}.

The parameters have the following meaning:

\begin{itemize}
\item samples: the number of Monte Carlo Samples
\item beta: parameter in correlation parametrization
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAveragePriceBarrierOption">
    <Model>Black</Model>
    <ModelParameters/>
    <Engine>MonteCarlo</Engine>
    <EngineParameters>
        <Parameter name="samples">10000</Parameter>
        <Parameter name="beta">0</Parameter>
        <Parameter name="SensitivityTemplate">COMM_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAveragePriceBarrierOption, Model Black, Engine MonteCarlo}
\label{lst:peconfig_CommodityAveragePriceBarrierOption_Black_MonteCarlo}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CommodityForward}
%--------------------------------------------------------

Used by trade type: CommodityForward

Available Model/Engine pairs:

\begin{itemize}
\item DiscountedCashflows/DiscountingCommodityForwardEngine
\end{itemize}

Engine description:

DiscountedCashflows/DiscountingCommodityForwardEngine builds a DiscountingCommodityForwardEngine. A sample configuration is shown in listing
\ref{lst:peconfig_CommodityForward_DiscountedCashflows_DiscountingCommodityForwardEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityForward">
    <Model>DiscountedCashflows</Model>
    <ModelParameters/>
    <Engine>DiscountingCommodityForwardEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityForward, Model DiscountedCashflows, Engine DiscountingCommodityForwardEngine}
\label{lst:peconfig_CommodityForward_DiscountedCashflows_DiscountingCommodityForwardEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CreditDefaultSwap}
%--------------------------------------------------------

Used by trade type: CreditDefaultSwap

Available Model/Engine pairs:

\begin{itemize}
\item DiscountedCashflows/MidPointCdsEngine
\item DiscountedCashflows/MidPointCdsEngineMultiState
\end{itemize}

Engine description:

DiscountedCashflows/MidPointCdsEngine builds a MidPointCdsEngine. A sample configuration is shown in listing
\ref{lst:peconfig_CreditDefaultSwap_DiscountedCashflows_MidPointCdsEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CreditDefaultSwap">
    <Model>DiscountedCashflows</Model>
    <ModelParameters/>
    <Engine>MidPointCdsEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CreditDefaultSwap, Model DiscountedCashflows, Engine MidPointCdsEngine}
\label{lst:peconfig_CreditDefaultSwap_DiscountedCashflows_MidPointCdsEngine}
\end{longlisting}

DiscountedCashflows/MidPointCdsEngineMultiState builds a MidPointCdsEngineMultiState. This engine is only used in the
context of the Credit Model. We refer to the documentation of this module for further details.

%--------------------------------------------------------
\subsubsection{Product Type: CreditDefaultSwapOption}
%--------------------------------------------------------

Used by trade type: CreditDefaultSwapOption

Available Model/Engine pairs:

\begin{itemize}
\item Black/BlackCdsOptionEngine
\end{itemize}

Engine description:

Black/BlackCdsOptionEngine builds a BlackCdsOptionEngine. A sample configuration is shown in listing
\ref{lst:peconfig_CreditDefaultSwapOption_Black_BlackCdsOptionEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CreditDefaultSwapOption">
    <Model>Black</Model>
    <ModelParameters/>
    <Engine>BlackCdsOptionEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CreditDefaultSwap, Model DiscountedCashflows, Engine MidPointCdsEngine}
\label{lst:peconfig_CreditDefaultSwapOption_Black_BlackCdsOptionEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: IndexCreditDefaultSwap}
%--------------------------------------------------------

Used by trade type: IndexCreditDefaultSwap

Available Model/Engine pairs:

\begin{itemize}
\item DiscountedCashflows/MidPointIndexCdsEngine
\end{itemize}

Engine description:

DiscountedCashflows/MidPointIndexCdsEngine builds a MidPointIndexCdsEngine. A sample configuration is shown in listing
\ref{lst:peconfig_CreditDefaultSwap_DiscountedCashflows_MidPointIndexCdsEngine}.

The parameters have the following meaning:

\begin{itemize}
\item Curve: Index, Underlying
\item SensitivityDecomposition: Underlying, NotionalWeighted, LossWeighted, DeltaWeighted
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="IndexCreditDefaultSwap">
    <Model>DiscountedCashflows</Model>
    <ModelParameters/>
    <Engine>MidPointIndexCdsEngine</Engine>
    <EngineParameters>
        <Parameter name="Curve">Index</Parameter>
        <Parameter name="SensitivityDecomposition">DeltaWeighted</Parameter>
        <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CreditDefaultSwap, Model DiscountedCashflows, Engine MidPointIndexCdsEngine}
\label{lst:peconfig_CreditDefaultSwap_DiscountedCashflows_MidPointIndexCdsEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: IndexCreditDefaultSwapOption}
%--------------------------------------------------------

Used by trade type: IndexCreditDefaultSwapOption

Available Model/Engine pairs:

\begin{itemize}
\item Black/BlackIndexCdsOptionEngine
\item LognormalAdjustedIndexSpread/NumericalIntegrationEngine
\end{itemize}

Engine description:

Black/BlackIndexCdsOptionEngine builds a BlackIndexCdsOptionEngine. A sample configuration is shown in listing
\ref{lst:peconfig_CreditDefaultSwapOption_Black_BlackIndexCdsOptionEngine}.

The parameters have the following meaning:

\begin{itemize}
\item Curve: Index, Underlying
\item FepCurve: Index, Underlying
\item SensitivityDecomposition: Underlying, NotionalWeighted, LossWeighted, DeltaWeighted
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="IndexCreditDefaultSwapOption">
    <Model>DiscountedCashflows</Model>
    <ModelParameters/>
    <Engine>MidPointIndexCdsEngine</Engine>
    <EngineParameters>
        <Parameter name="Curve">Index</Parameter>
        <Parameter name="FepCurve">Index</Parameter>
        <Parameter name="SensitivityDecomposition">DeltaWeighted</Parameter>
        <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CreditDefaultSwap, Model DiscountedCashflows, Engine MidPointIndexCdsEngine}
\label{lst:peconfig_CreditDefaultSwapOption_Black_BlackIndexCdsOptionEngine}
\end{longlisting}

LognormalAdjustedIndexSpread/NumericalIntegrationEngine builds a NumericalIntegrationIndexCdsOptionEngine. A sample
configuration is shown in listing
\ref{lst:peconfig_CreditDefaultSwapOption_LognormalAdjustedIndexSpread_NumericalIntegrationEngine}.

The parameters have the following meaning:

\begin{itemize}
\item Curve: Index, Underlying
\item FepCurve: Index, Underlying
\item SensitivityDecomposition: Underlying, NotionalWeighted, LossWeighted, DeltaWeighted
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="IndexCreditDefaultSwapOption">
    <Model>DiscountedCashflows</Model>
    <ModelParameters/>
    <Engine>MidPointIndexCdsEngine</Engine>
    <EngineParameters>
        <Parameter name="Curve">Index</Parameter>
        <Parameter name="FepCurve">Index</Parameter>
        <Parameter name="SensitivityDecomposition">DeltaWeighted</Parameter>
        <Parameter name="SensitivityTemplate">IR_Semianalytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CreditDefaultSwap, Model DiscountedCashflows, Engine MidPointIndexCdsEngine}
\label{lst:peconfig_CreditDefaultSwapOption_LognormalAdjustedIndexSpread_NumericalIntegrationEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CpiCapFloor}
%--------------------------------------------------------

Used by trade type: CapFloor with underlying leg of leg type CPI.

Available Model/Engine pairs: CpiCapModel/CpiCapEngine

Engine description:

CpiCapModel/CpiCapEngine builds a CPIBlackCapFloorEngine or CPIBachelierCapFloorEngine depneding on the volatility type
of the market surface. A sample configuration is shown in listing
\ref{lst:peconfig_CpiCapFloor_CpiCapModel_CpiCapEngine}.

The parameters have the following meaning:

\begin{itemize}
\item useLastFixingDate: if true, use the last known fixing date as the base date of the volatility structure, otherwise
  use observation lag
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CpiCapFloor">
    <Model>CpiCapModel</Model>
    <ModelParameters/>
    <Engine>CpiCapEngine</Engine>
    <EngineParameters>
        <Parameter name="useLastFixingDate">true</Parameter>
        <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CpiCapFloor, Model CpiCapModel, Engine CpiCapEngine}
\label{lst:peconfig_CpiCapFloor_CpiCapModel_CpiCapEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: YYCapFloor}
%--------------------------------------------------------

Used by trade type: CapFloor with underlying leg of leg type YoY.

Available Model/Engine pairs: YYCapModel/YYCapEngine

Engine description:

YYCapModel/YYCapEngine builds a YoYInflationBlackCapFloorEngine, YoYInflationUnitDisplacedBlackCapFloorEngine,
YoYInflationBachelierCapFloorEngine depending on the volatility type of the market surface. A sample configuration is
shown in listing \ref{lst:peconfig_YYCapFloor_YYCapModel_YYCapEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CpiCapFloor">
    <Model>YYCapModel</Model>
    <ModelParameters/>
    <Engine>YYCapEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product YYCapFloor, Model YYCapModel, Engine YYCapEngine}
\label{lst:peconfig_YYCapFloor_YYCapModel_YYCapEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CappedFlooredYYLeg}
%--------------------------------------------------------

Used by trade type: any trade with a cap / floored YY leg

Available Model/Engine pairs: CapFlooredYYModel/CapFlooredYYCouponPricer

Engine description:

CapFlooredYYModel/CapFlooredYYCouponPricer builds a BlackYoYInflationCouponPricer,
UnitDisplacedBlackYoYInflationCouponPricer, BachelierYoYInflationCouponPricer, depending on the volatility input. A
sample configuration is shown in listing \ref{lst:peconfig_CapFlooredYYLeg_CapFlooredYYModel_CapFlooredYYCouponPricer}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CappedFlooredYYLeg">
    <Model>CapFlooredYYModel</Model>
    <ModelParameters/>
    <Engine>CapFlooredYYCouponPricer</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CapFlooredYYLeg, Model CapFlooredYYModel, Engine CapFlooredYYCouponPricer}
\label{lst:peconfig_CapFlooredYYLeg_CapFlooredYYModel_CapFlooredYYCouponPricer}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CappedFlooredNonStdYYLeg}
%--------------------------------------------------------

Used by trade type: any trade with a cap / floored YY leg if IrregularYoY is true in YoY leg data

Available Model/Engine pairs: CapFlooredYNonStdYYModel/CapFlooredNonStdYYCouponPricer

Engine description:

CapFlooredYNonStdYYModel/CapFlooredNonStdYYCouponPricer builds a NonStandardBlackYoYInflationCouponPricer,
NonStandardUnitDisplacedBlackYoYInflationCouponPricer, NonStandardBachelierYoYInflationCouponPricer, depending on the
volatility input. A sample configuration is shown in listing
\ref{lst:peconfig_CapFlooredNonStdYYLeg_CapFlooredNonStdYYModel_CapFlooredNonStdYYCouponPricer}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CappedFlooredNonStdYYLeg">
    <Model>CapFlooredNonStdYYModel</Model>
    <ModelParameters/>
    <Engine>CapFlooredNonStdYYCouponPricer</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CapFlooredNonStdYYLeg, Model CapFlooredNonStdYYModel, Engine
  CapFlooredNonStdYYCouponPricer}
\label{lst:peconfig_CapFlooredNonStdYYLeg_CapFlooredNonStdYYModel_CapFlooredNonStdYYCouponPricer}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CMS}
%--------------------------------------------------------

Used by trade type: any trade referencing a CMS leg, also used by CMS Spread coupon pricers

Available Model/Engine pairs:

\begin{itemize}
  \item LinearTSR/LinearTSRPricer
  \item Hagan/Analytic
  \item Hagan/Numerical
\end{itemize}

Engine description:

LinearTSR/LinearTSRPricer builds a LinearTRSPricer. A sample configuration is shown in listing
\ref{lst:peconfig_CMS_LinearTSR_LinearTSRPricer}.

The parameters have the following meaning:

\begin{itemize}
\item MeanReversion: the mean reversion for the model
\item Policy: RateBound, VegaRatio, PriceThreshold, BsStdDev
\item LowerRateBoundLogNormal, UpperRateBoundLogNormal: rate bounds for ln / sln vol input
\item LowerRateNormal, UpperRateNormal: rate bounds for normal vol input
\item VegaRatio: vega ratio for policy
\item PriceThreshold: price threshold for policy
\item BsStdDev: std devs for BsStdDev
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Prooduct type="CMS">
    <Model>LinearTSR</Model>
    <ModelParameters/>
    <Engine>LinearTSRPricer</Engine>
    <EngineParameters>
        <Parameter name="MeanReversion">0.0</Parameter>
        <Parameter name="Policy">RateBound</Parameter>
        <Parameter name="LowerRateBoundLogNormal">0.0001</Parameter>
        <Parameter name="UpperRateBoundLogNormal">2.0000</Parameter>
        <Parameter name="LowerRateBoundNormal">-2.0000</Parameter>
        <Parameter name="UpperRateBoundNormal">2.0000</Parameter>
        <Parameter name="VegaRatio">0.01</Parameter>
        <Parameter name="PriceThreshold">0.0000001</Parameter>
        <Parameter name="BsStdDev">3.0</Parameter>
        <Parameter name="SensitivityTemplate">IR_Semianalytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CMS, Model LinearTSR, Engine LinearTSRPricer}
\label{lst:peconfig_CMS_LinearTSR_LinearTSRPricer}
\end{longlisting}

Hagan/Analytic, Hagan/Numerical build AnalyticHaganPricer, NumericHaganPricer (TODO add parameters and sample config).

%--------------------------------------------------------
\subsubsection{Product Type: CMSSpread}
%--------------------------------------------------------

Used by trade type: any trade referencing a CMSSpread leg

Available Model/Engine pairs:

\begin{itemize}
  \item BrigoMercurio/Analytic
\end{itemize}

Engine description:

BrigoMercurio/Analytic builds a LognormalCmsSpreadPricer (following Brigo, Mercurio, Interest Rate Models - Theory and
Practice, section 13.16.2). A sample configuration is shown in listing
\ref{lst:peconfig_CMSSpread_BrigoMercurio_Analytic}.

The parameters have the following meaning:

\begin{itemize}
\item IntegrationPoints: Number of points for Gauss-Hermite numerical integration
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CMSSpread">
    <Model>BrigoMercurio</Model>
    <ModelParameters/>
    <Engine>Analytic</Engine>
    <EngineParameters>
        <Parameter name="IntegrationPoints">16</Parameter>
        <Parameter name="SensitivityTemplate">IR_Semianalytical</Parameter>
    </EngineParameters>
</Product>\caption{Configuration for Product CMSSpread, Model BrigoMercurio, Engine Analytic}
\end{minted}
\caption{Configuration for Product CMSSpread, Model BrigoMercurio, Engine Analytic}
\label{lst:peconfig_CMSSpread_BrigoMercurio_Analytic}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: DurationAdjustedCMS}
%--------------------------------------------------------

Used by trade type: any trade referencing a DurationAdjustedCMS leg

Available Model/Engine pairs:

\begin{itemize}
  \item LinearTSR/LinearTSRPricer
\end{itemize}

Engine description:

LinearTSR/LinearTSRPricer builds a DurationAdjustedCmsCouponTsrPricer with LinearAnnuityMapping. A sample configuration
is shown in listing \ref{lst:peconfig_DurationAdjustedCMS_LinearTSR_LinearTSRPricer}.

The parameters have the following meaning:

\begin{itemize}
\item MeanReversion: the mean reversion for the model
\item LowerRateBoundLogNormal, UpperRateBoundLogNormal: rate bounds for ln / sln vol input
\item LowerRateNormal, UpperRateNormal: rate bounds for normal vol input
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="DurationAdjustedCMS">
    <Model>LinearTSR</Model>
    <ModelParameters/>
    <Engine>LinearTSRPricer</Engine>
    <EngineParameters>
        <Parameter name="MeanReversion">0.0</Parameter>
        <Parameter name="LowerRateBoundLogNormal">0.0001</Parameter>
        <Parameter name="UpperRateBoundLogNormal">2.0000</Parameter>
        <Parameter name="LowerRateBoundNormal">-2.0000</Parameter>
        <Parameter name="UpperRateBoundNormal">2.0000</Parameter>
        <Parameter name="SensitivityTemplate">IR_Semianalytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product DurationAdjustedCMS, Model LinearTSR, Engine LinearTSRPricer}
\label{lst:peconfig_DurationAdjustedCMS_LinearTSR_LinearTSRPricer}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CommodityAsianOptionArithmeticPrice}
%--------------------------------------------------------

Used by trade type: CommodityAsianOption if payoffType2 is Arithmetric and payoffType is Asian

Available Model/Engine pairs:

\begin{itemize}
  \item BlackScholesMerton/MCDiscreteArithmeticAPEngine
  \item BlackScholesMerton/TurnbullWakemanAsianEngine
  \item ScriptedTrade/ScriptedTrade
\end{itemize}

Engine description:

BlackScholesMerton/MCDiscreteArithmeticAPEngine builds a MCDiscreteArithmeticAPEngine using Sobol sequences. A sample
configuration is shown in listing
\ref{lst:peconfig_CommodityAsianOptionArithmeticPrice_BlackScholesMerton_MCDiscreteArithmeticAPEngine}.

The parameters have the following meaning:

\begin{itemize}
\item BrownianBridge: whether to use Brownian Bridge for MC simulation
\item AntitheticVariate: whether to use antithetic variates for MC simulation
\item ControlVariate: whether to use control variate for MC simulation
\item RequiredSamples: minimum number of samples for MC simulation, if 0 (not specified) RequiredTolerance must be given
\item RequiredTolernace: max tolerance for MC error, if 0 (not specified) RequiredSamples must be given
\item MaxSamples: max number of samples for MC simulation
\item Seed: seed for random number generator
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAsianOptionArithmeticPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>MCDiscreteArithmeticAPEngine</Engine>
    <EngineParameters>
        <Parameter name="BrownianBridge">true</Parameter>    
        <Parameter name="AntitheticVariate">true</Parameter>    
        <Parameter name="ControlVariate">true</Parameter>    
        <Parameter name="RequiredSamples">10000</Parameter>    
        <Parameter name="RequiredTolerance">0</Parameter>    
        <Parameter name="MaxSamples">0</Parameter>    
        <Parameter name="Seed">42</Parameter>    
        <Parameter name="SensitivityTemplate">COMM_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAsianOptionArithmeticPrice, Model BlackScholesMerton, Engine MCDiscreteArithmeticAPEngine}
\label{lst:peconfig_CommodityAsianOptionArithmeticPrice_BlackScholesMerton_MCDiscreteArithmeticAPEngine}
\end{longlisting}

BlackScholesMerton/TurnbullWakemanAsianEngine builds a TurnbullWakemanAsianEngine. A sample configuration is shown in
listing \ref{lst:peconfig_CommodityAsianOptionArithmeticPrice_BlackScholesMerton_TurnbullWakemanAsianEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAsianOptionArithmeticPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>TurnbullWakemanAsianEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAsianOptionArithmeticPrice, Model BlackScholesMerton, Engine TurnbullWakemanAsianEngine}
\label{lst:peconfig_CommodityAsianOptionArithmeticPrice_BlackScholesMerton_TurnbullWakemanAsianEngine}
\end{longlisting}

ScriptedTrade/ScriptedTrade delegates to the scripted trade engine and the associated pricing engine configuration for
Product Type ScriptedTrade, see there for details. A sample configuration is given in listing
\ref{lst:peconfig_CommodityAsianOptionArithmeticPrice_ScriptedTrade_ScriptedTrade}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAsianOptionArithmeticPrice">
    <Model>ScriptedTrade</Model>
    <ModelParameters/>
    <Engine>ScriptedTrade</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAsianOptionArithmeticPrice, Model ScriptedTrade, Engine ScriptedTrade}
\label{lst:peconfig_CommodityAsianOptionArithmeticPrice_ScriptedTrade_ScriptedTrade}
\end{longlisting}


%--------------------------------------------------------
\subsubsection{Product Type: CommodityAsianOptionArithmeticStrike}
%--------------------------------------------------------

Used by trade type: CommodityAsianOption if payoffType2 is Arithmetric and payoffType is AverageStrike

Available Model/Engine pairs:

\begin{itemize}
\item BlackScholesMerton/MCDiscreteArithmeticASEngine
\item ScriptedTrade/ScriptedTrade
\end{itemize}
  
Engine description:

BlackScholesMerton/MCDiscreteArithmeticASEngine builds a MCDiscreteArithmeticASEngine using Sobol sequences. A sample
configuration is shown in listing
\ref{lst:peconfig_CommodityAsianOptionArithmeticStrike_BlackScholesMerton_MCDiscreteArithmeticASEngine}.

The parameters have the following meaning:

\begin{itemize}
\item BrownianBridge: whether to use Brownian Bridge for MC simulation
\item AntitheticVariate: whether to use antithetic variates for MC simulation
\item ControlVariate: whether to use control variate for MC simulation
\item RequiredSamples: minimum number of samples for MC simulation, if 0 (not specified) RequiredTolerance must be given
\item RequiredTolernace: max tolerance for MC error, if 0 (not specified) RequiredSamples must be given
\item MaxSamples: max number of samples for MC simulation
\item Seed: seed for random number generator
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAsianOptionArithmeticStrike">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>MCDiscreteArithmeticASEngine</Engine>
    <EngineParameters>
        <Parameter name="BrownianBridge">true</Parameter>    
        <Parameter name="AntitheticVariate">true</Parameter>    
        <Parameter name="ControlVariate">true</Parameter>    
        <Parameter name="RequiredSamples">10000</Parameter>    
        <Parameter name="RequiredTolerance">0</Parameter>    
        <Parameter name="MaxSamples">0</Parameter>    
        <Parameter name="Seed">42</Parameter>    
        <Parameter name="SensitivityTemplate">COMM_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAsianOptionArithmeticStrike, Model BlackScholesMerton, Engine MCDiscreteArithmeticASEngine}
\label{lst:peconfig_CommodityAsianOptionArithmeticStrike_BlackScholesMerton_MCDiscreteArithmeticASEngine}
\end{longlisting}

ScriptedTrade/ScriptedTrade delegates to the scripted trade engine and the associated pricing engine configuration for
Product Type ScriptedTrade, see there for details. A sample configuration is given in listing
\ref{lst:peconfig_CommodityAsianOptionArithmeticStrike_ScriptedTrade_ScriptedTrade}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAsianOptionArithmeticStrike">
    <Model>ScriptedTrade</Model>
    <ModelParameters/>
    <Engine>ScriptedTrade</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAsianOptionArithmeticStrike, Model ScriptedTrade, Engine ScriptedTrade}
\label{lst:peconfig_CommodityAsianOptionArithmeticStrike_ScriptedTrade_ScriptedTrade}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CommodityAsianOptionGeometricPrice}
%--------------------------------------------------------

Used by trade type: CommodityAsianOption if payoffType2 is Geometric and payoffType is Asian

Available Model/Engine pairs:

\begin{itemize}
  \item BlackScholesMerton/MCDiscreteGeometricAPEngine
  \item BlackScholesMerton/AnalyticDiscreteGeometricAPEngine
  \item BlackScholesMerton/AnalyticContinuousGeometricAPEngine
  \item ScriptedTrade/ScriptedTrade
\end{itemize}

Engine description:

BlackScholesMerton/MCDiscreteGeometricAPEngine builds a MCDiscreteGeometricAPEngine using Sobol sequences. A sample
configuration is shown in listing
\ref{lst:peconfig_CommodityAsianOptionGeometricPrice_BlackScholesMerton_MCDiscreteGeomtetricAPEngine}.

The parameters have the following meaning:

\begin{itemize}
\item BrownianBridge: whether to use Brownian Bridge for MC simulation
\item AntitheticVariate: whether to use antithetic variates for MC simulation
\item ControlVariate: whether to use control variate for MC simulation
\item RequiredSamples: minimum number of samples for MC simulation, if 0 (not specified) RequiredTolerance must be given
\item RequiredTolernace: max tolerance for MC error, if 0 (not specified) RequiredSamples must be given
\item MaxSamples: max number of samples for MC simulation
\item Seed: seed for random number generator
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAsianOptionGeometricPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>MCDiscreteGeometricAPEngine</Engine>
    <EngineParameters>
        <Parameter name="BrownianBridge">true</Parameter>    
        <Parameter name="AntitheticVariate">true</Parameter>    
        <Parameter name="ControlVariate">true</Parameter>    
        <Parameter name="RequiredSamples">10000</Parameter>    
        <Parameter name="RequiredTolerance">0</Parameter>    
        <Parameter name="MaxSamples">0</Parameter>    
        <Parameter name="Seed">42</Parameter>    
        <Parameter name="SensitivityTemplate">COMM_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAsianOptionGeometricPrice, Model BlackScholesMerton, Engine MCDiscreteGeometricAPEngine}
\label{lst:peconfig_CommodityAsianOptionGeometricPrice_BlackScholesMerton_MCDiscreteGeomtetricAPEngine}
\end{longlisting}

BlackScholesMerton/AnalyticDiscreteGeometricAPEngine builds a AnalyticDiscreteGeometricAveragePriceAsianEngine. A sample
configuration is shown in listing
\ref{lst:peconfig_CommodityAsianOptionGeometricPrice_BlackScholesMerton_AnalyticDiscreteGeomtetricAPEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAsianOptionGeometricPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>AnalyticDiscreteGeometricAPEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAsianOptionGeometricPrice, Model BlackScholesMerton, Engine AnalyticDiscreteGeomtetricAPEngine}
\label{lst:peconfig_CommodityAsianOptionGeometricPrice_BlackScholesMerton_AnalyticDiscreteGeomtetricAPEngine}
\end{longlisting}

BlackScholesMerton/AnalyticContinuousGeometricAPEngine builds a AnalyticContinuousGeometricAveragePriceAsianEngine. A sample
configuration is shown in listing
\ref{lst:peconfig_CommodityAsianOptionGeometricPrice_BlackScholesMerton_AnalyticContinuousGeomtetricAPEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAsianOptionGeometricPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>AnalyticContinuousGeometricAPEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAsianOptionGeometricPrice, Model BlackScholesMerton, Engine AnalyticContinuousGeomtetricAPEngine}
\label{lst:peconfig_CommodityAsianOptionGeometricPrice_BlackScholesMerton_AnalyticContinuousGeomtetricAPEngine}
\end{longlisting}

ScriptedTrade/ScriptedTrade delegates to the scripted trade engine and the associated pricing engine configuration for
Product Type ScriptedTrade, see there for details. A sample configuration is given in listing
\ref{lst:peconfig_CommodityAsianOptionGeometricPrice_ScriptedTrade_ScriptedTrade}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAsianOptionGeometricPrice">
    <Model>ScriptedTrade</Model>
    <ModelParameters/>
    <Engine>ScriptedTrade</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAsianOptionGeometricPrice, Model ScriptedTrade, Engine ScriptedTrade}
\label{lst:peconfig_CommodityAsianOptionGeometricPrice_ScriptedTrade_ScriptedTrade}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CommodityAsianOptionGeometricStrike}
%--------------------------------------------------------

Used by trade type: CommodityAsianOption if payoffType2 is Geometric and payoffType is AverageStrike

Available Model/Engine pairs:

\begin{itemize}
  \item BlackScholesMerton/MCDiscreteGeometricASEngine
  \item BlackScholesMerton/AnalyticDiscreteGeometricASEngine
  \item ScriptedTrade/ScriptedTrade
\end{itemize}

Engine description:

BlackScholesMerton/MCDiscreteGeometricASEngine builds a MCDiscreteGeometricASEngine using Sobol sequences. A sample
configuration is shown in listing
\ref{lst:peconfig_CommodityAsianOptionGeometricStrike_BlackScholesMerton_MCDiscreteGeomtetricASEngine}.

The parameters have the following meaning:

\begin{itemize}
\item BrownianBridge: whether to use Brownian Bridge for MC simulation
\item AntitheticVariate: whether to use antithetic variates for MC simulation
\item ControlVariate: whether to use control variate for MC simulation
\item RequiredSamples: minimum number of samples for MC simulation, if 0 (not specified) RequiredTolerance must be given
\item RequiredTolernace: max tolerance for MC error, if 0 (not specified) RequiredSamples must be given
\item MaxSamples: max number of samples for MC simulation
\item Seed: seed for random number generator
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAsianOptionGeometricStrike">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>MCDiscreteGeometricASEngine</Engine>
    <EngineParameters>
        <Parameter name="BrownianBridge">true</Parameter>    
        <Parameter name="AntitheticVariate">true</Parameter>    
        <Parameter name="ControlVariate">true</Parameter>    
        <Parameter name="RequiredSamples">10000</Parameter>    
        <Parameter name="RequiredTolerance">0</Parameter>    
        <Parameter name="MaxSamples">0</Parameter>    
        <Parameter name="Seed">42</Parameter>    
        <Parameter name="SensitivityTemplate">COMM_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAsianOptionGeometricStrike, Model BlackScholesMerton, Engine MCDiscreteGeometricASEngine}
\label{lst:peconfig_CommodityAsianOptionGeometricStrike_BlackScholesMerton_MCDiscreteGeomtetricASEngine}
\end{longlisting}

BlackScholesMerton/AnalyticDiscreteGeometricASEngine builds a AnalyticDiscreteGeometricAverageStrikeAsianEngine. A sample
configuration is shown in listing
\ref{lst:peconfig_CommodityAsianOptionGeometricStrike_BlackScholesMerton_AnalyticDiscreteGeomtetricASEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAsianOptionGeometricStrike">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>AnalyticDiscreteGeometricASEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAsianOptionGeometricStrike, Model BlackScholesMerton, Engine AnalyticDiscreteGeomtetricASEngine}
\label{lst:peconfig_CommodityAsianOptionGeometricStrike_BlackScholesMerton_AnalyticDiscreteGeomtetricASEngine}
\end{longlisting}

ScriptedTrade/ScriptedTrade delegates to the scripted trade engine and the associated pricing engine configuration for
Product Type ScriptedTrade, see there for details. A sample configuration is given in listing
\ref{lst:peconfig_CommodityAsianOptionGeometricStrike_ScriptedTrade_ScriptedTrade}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityAsianOptionGeometricStrike">
    <Model>ScriptedTrade</Model>
    <ModelParameters/>
    <Engine>ScriptedTrade</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityAsianOptionGeometricStrike, Model ScriptedTrade, Engine ScriptedTrade}
\label{lst:peconfig_CommodityAsianOptionGeometricStrike_ScriptedTrade_ScriptedTrade}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CommoditySpreadOption}
%--------------------------------------------------------

Used by trade type: CommoditySpreadOption

Available Model/Engine pairs: BlackScholes/CommoditySpreadOptionEngine

Engine description:

BlackScholes/CommoditySpreadOptionEngine builds a CommoditySpreadOptionAnalyticalEngine, which uses the Kirk
approximation described in Iain J. Clark, Commodity Option Pricing, Section 2.9. The correlation between two commodities
resp. the intra-asset correlation between two future contracts is parametrized as

$$\rho(s, t) = e^{-\beta |s-t|}$$

where $s$ and $t$ are times to futures expiry. A sample configuration is shown in listing
\ref{lst:peconfig_CommoditySpreadOption_BlackScholes_CommoditySpreadOptionEngine}.

The parameters have the following meaning:

\begin{itemize}
\item beta: the parameter ``beta'' in the correlation parametrization
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommoditySpreadOption">
    <Model>BlackScholes</Model>
    <ModelParameters/>
    <Engine>CommoditySpreadOptionEngine</Engine>
    <EngineParameters>
        <Parameter name="beta">2.05</Parameter>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
    </Product>
\end{minted}
\caption{Configuration for Product CommoditySpreadOption, Model BlackScholes, Engine CommoditySpreadOptionEngine}
\label{lst:peconfig_CommoditySpreadOption_BlackScholes_CommoditySpreadOptionEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CommodityOption}
%--------------------------------------------------------

Used by trade type: CommodityOption

Available Model/Engine pairs: BlackScholes/AnalyticEuropeanEngine

Engine description:

BlackScholes/AnalyticEuropeanEngine builds a AnalyticEuropeanEngine. A sample configuration is shown in listing
\ref{lst:peconfig_CommodityOption_BlackScholes_AnalyticEuropeanEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityOption">
    <Model>BlackScholes</Model>
    <ModelParameters/>
    <Engine>AnalyticEuropeanEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityOption, Model BlackScholes, Engine AnalyticEuropeanEngine}
\label{lst:peconfig_CommodityOption_BlackScholes_AnalyticEuropeanEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CommodityOptionForward}
%--------------------------------------------------------

Used by trade type: CommodityOption if a future is referenced

Available Model/Engine pairs: BlackScholes/AnalyticEuropeanForwardEngine

Engine description:

BlackScholes/AnalyticEuropeanForwardEngine builds a AnalyticEuropeanForwardEngine. A sample configuration is shown in listing
\ref{lst:peconfig_CommodityOptionForward_BlackScholes_AnalyticForwardEuropeanEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityOptionForward">
    <Model>BlackScholes</Model>
    <ModelParameters/>
    <Engine>AnalyticForwardEuropeanEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityOptionForward, Model BlackScholes, Engine AnalyticForwardEuropeanEngine}
\label{lst:peconfig_CommodityOptionForward_BlackScholes_AnalyticForwardEuropeanEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CommodityOptionEuropeanCS}
%--------------------------------------------------------

Used by trade type: CommodityOption if cash settled

Available Model/Engine pairs: BlackScholes/AnalyticCashSettledEuropeanEngine

Engine description:

BlackScholes/AnalyticCashSettledEuropeanEngine builds a AnalyticCashSettledEuropeanEngine. A sample configuration is shown in listing
\ref{lst:peconfig_CommodityOptionEuropeanCS_BlackScholes_AnalyticCashSettledEuropeanEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityOptionEuropeanCS">
    <Model>BlackScholes</Model>
    <ModelParameters/>
    <Engine>AnalyticCashSettledEuropeanEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityOptionEuropeanCS, Model BlackScholes, Engine AnalyticCashSettledEuropeanEngine}
\label{lst:peconfig_CommodityOptionEuropeanCS_BlackScholes_AnalyticCashSettledEuropeanEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CommodityOptionAmerican}
%--------------------------------------------------------

Used by trade type: CommodityOption if exercise stly is american

Available Model/Engine pairs:

\begin{itemize}
\item BlackScholes/FdBlackScholesVanillaEngine
\item BlackScholes/BaroneAdesiWhaleyApproximationEngine
\end{itemize}

Engine description:

BlackScholes/FdBlackScholesVanillaEngine builds a FdBlackScholesVanillaEngine. A sample configuration is shown in listing
\ref{lst:peconfig_CommodityOptionAmerican_BlackScholes_FdBlackScholesVanillaEngine}

The parameters have the following meaning:

\begin{itemize}
\item Scheme: The finite difference scheme to use
\item TimeStepsPerYear: Time grid specification
\item XGrid: State grid specification
\item DampingSteps: Number of damping steps taken by FD solver
\item EnforceMonotoneVariance [optional]: If true variance is modified to be monotone if needed, defaults to true
\item TimeGridMinimumSize [optional]: Minimum number in resulting time grid, defaults to $1$ if not given
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityOptionAmerican">
    <Model>BlackScholes</Model>
    <ModelParameters/>
    <Engine>FdBlackScholesVanillaEngine</Engine>
    <EngineParameters>
        <Parameter name="Scheme">Douglas</Parameter>
        <Parameter name="TimeGridPerYear">100</Parameter>
        <Parameter name="XGrid">100</Parameter>
        <Parameter name="DampingSteps">0</Parameter>
        <Parameter name="EnforceMonotoneVariance">true</Parameter>
        <Parameter name="SensitivityTemplate">COMM_FD</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityOptionAmerican, Model BlackScholes, Engine FdBlackScholesVanillaEngine}
\label{lst:peconfig_CommodityOptionAmerican_BlackScholes_FdBlackScholesVanillaEngine}
\end{longlisting}

BlackScholes/BaroneAdesiWhaleyApproximationEngine builds a BaroneAdesiWhaleyApproximationEngine. A sample configuration is shown in listing
\ref{lst:peconfig_CommodityOptionAmerican_BlackScholes_BaroneAdesiWhaleyApproximationEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommodityOptionAmerican">
    <Model>BlackScholes</Model>
    <ModelParameters/>
    <Engine>BaroneAdesiWhaleyApproximationEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommodityOptionAmerican, Model BlackScholes, Engine BaroneAdesiWhaleyApproximationEngine}
\label{lst:peconfig_CommodityOptionAmerican_BlackScholes_BaroneAdesiWhaleyApproximationEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CommoditySwap}
%--------------------------------------------------------

Used by trade type: CommoditySwap

Available Model/Engine pairs: DiscountedCashflows/CommoditySwapEngine

Engine description:

DiscountedCashflows/CommoditySwapEngine builds a DiscountingSwapEngine. A sample configuration is shown in listing
\ref{lst:peconfig_CommoditySwap_DiscountedCashflows_CommoditySwapEngine}

The parameters have the following meaning:

\begin{itemize}
\item 
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommoditySwap">
    <Model>DiscountedCashflows</Model>
    <ModelParameters/>
    <Engine>CommoditySwapEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommoditySwap, Model DiscountedCashflows, Engine CommoditySwapEngine}
\label{lst:peconfig_CommoditySwap_DiscountedCashflows_CommoditySwapEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: CommoditySwaption}
%--------------------------------------------------------

Used by trade type: CommoditySwaption

Available Model/Engine pairs:

\begin{itemize}
\item Black/AnalyticalApproximation
\item Black/MonteCarlo
\end{itemize}

Engine description:

Black/AnalyticalApproximation builds a CommoditySwaptionEngine using moment matching. The correlation between two future
contracts is parametrized as

$$\rho(s, t) = e^{-\beta |s-t|}$$

where $s$ and $t$ are times to futures expiry. A sample configuration is shown in listing
\ref{lst:peconfig_CommoditySwaption_Black_AnalyticalApproximation}

The parameters have the following meaning:

\begin{itemize}
\item beta: the parameter ``beta'' in the correlation parametrization
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommoditySwaption">
    <Model>Black</Model>
    <ModelParameters/>
    <Engine>AnalyticalApproximation</Engine>
    <EngineParameters>
        <Parameter name="beta">2.05</Parameter>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommoditySwaption, Model Black, Engine AnalyticalApproximation}
\label{lst:peconfig_CommoditySwaption_Black_AnalyticalApproximation}
\end{longlisting}

Black/MonteCarlo builds a CommoditySwaptionMonteCarloEngine using Sobol sequences. The same correlation parametrization
as above is used. A sample configuration is shown in listing
\ref{lst:peconfig_CommoditySwaption_Black_MonteCarlo}

The parameters have the following meaning:

\begin{itemize}
\item beta: the parameter ``beta'' in the correlation parametrization
\item samples: the number of MC samples to use
\item seed: the seed to use
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CommoditySwaption">
    <Model>Black</Model>
    <ModelParameters/>
    <Engine>MonteCarlo</Engine>
    <EngineParameters>
        <Parameter name="beta">2.05</Parameter>
        <Parameter name="samples">10000</Parameter>
        <Parameter name="seed">42</Parameter>    
        <Parameter name="SensitivityTemplate">COMM_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product CommoditySwaption, Model Black, Engine MonteCarlo}
\label{lst:peconfig_CommoditySwaption_Black_MonteCarlo}
\end{longlisting}
    
%--------------------------------------------------------
\subsubsection{Product Type: EquityAsianOptionArithmeticPrice}
%--------------------------------------------------------

Used by trade type: EquityAsianOption if payoffType2 is Arithmetric and payoffType is Asian

Available Model/Engine pairs:

\begin{itemize}
  \item BlackScholesMerton/MCDiscreteArithmeticAPEngine
  \item BlackScholesMerton/TurnbullWakemanAsianEngine
  \item ScriptedTrade/ScriptedTrade
\end{itemize}

Engine description:

BlackScholesMerton/MCDiscreteArithmeticAPEngine builds a MCDiscreteArithmeticAPEngine using Sobol sequences. A sample
configuration is shown in listing
\ref{lst:peconfig_EquityAsianOptionArithmeticPrice_BlackScholesMerton_MCDiscreteArithmeticAPEngine}.

The parameters have the following meaning:

\begin{itemize}
\item BrownianBridge: whether to use Brownian Bridge for MC simulation
\item AntitheticVariate: whether to use antithetic variates for MC simulation
\item ControlVariate: whether to use control variate for MC simulation
\item RequiredSamples: minimum number of samples for MC simulation, if 0 (not specified) RequiredTolerance must be given
\item RequiredTolernace: max tolerance for MC error, if 0 (not specified) RequiredSamples must be given
\item MaxSamples: max number of samples for MC simulation
\item Seed: seed for random number generator
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityAsianOptionArithmeticPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>MCDiscreteArithmeticAPEngine</Engine>
    <EngineParameters>
        <Parameter name="BrownianBridge">true</Parameter>    
        <Parameter name="AntitheticVariate">true</Parameter>    
        <Parameter name="ControlVariate">true</Parameter>    
        <Parameter name="RequiredSamples">10000</Parameter>    
        <Parameter name="RequiredTolerance">0</Parameter>    
        <Parameter name="MaxSamples">0</Parameter>    
        <Parameter name="Seed">42</Parameter>    
        <Parameter name="SensitivityTemplate">EQ_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityAsianOptionArithmeticPrice, Model BlackScholesMerton, Engine MCDiscreteArithmeticAPEngine}
\label{lst:peconfig_EquityAsianOptionArithmeticPrice_BlackScholesMerton_MCDiscreteArithmeticAPEngine}
\end{longlisting}

BlackScholesMerton/TurnbullWakemanAsianEngine builds a TurnbullWakemanAsianEngine. A sample configuration is shown in
listing \ref{lst:peconfig_EquityAsianOptionArithmeticPrice_BlackScholesMerton_TurnbullWakemanAsianEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityAsianOptionArithmeticPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>TurnbullWakemanAsianEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">EQ_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityAsianOptionArithmeticPrice, Model BlackScholesMerton, Engine TurnbullWakemanAsianEngine}
\label{lst:peconfig_EquityAsianOptionArithmeticPrice_BlackScholesMerton_TurnbullWakemanAsianEngine}
\end{longlisting}

ScriptedTrade/ScriptedTrade delegates to the scripted trade engine and the associated pricing engine configuration for
Product Type ScriptedTrade, see there for details. A sample configuration is given in listing
\ref{lst:peconfig_EquityAsianOptionArithmeticPrice_ScriptedTrade_ScriptedTrade}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityAsianOptionArithmeticPrice">
    <Model>ScriptedTrade</Model>
    <ModelParameters/>
    <Engine>ScriptedTrade</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">EQ_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityAsianOptionArithmeticPrice, Model ScriptedTrade, Engine ScriptedTrade}
\label{lst:peconfig_EquityAsianOptionArithmeticPrice_ScriptedTrade_ScriptedTrade}
\end{longlisting}


%--------------------------------------------------------
\subsubsection{Product Type: EquityAsianOptionArithmeticStrike}
%--------------------------------------------------------

Used by trade type: EquityAsianOption if payoffType2 is Arithmetric and payoffType is AverageStrike

Available Model/Engine pairs:

\begin{itemize}
\item BlackScholesMerton/MCDiscreteArithmeticASEngine
\item ScriptedTrade/ScriptedTrade
\end{itemize}
  
Engine description:

BlackScholesMerton/MCDiscreteArithmeticASEngine builds a MCDiscreteArithmeticASEngine using Sobol sequences. A sample
configuration is shown in listing
\ref{lst:peconfig_EquityAsianOptionArithmeticStrike_BlackScholesMerton_MCDiscreteArithmeticASEngine}.

The parameters have the following meaning:

\begin{itemize}
\item BrownianBridge: whether to use Brownian Bridge for MC simulation
\item AntitheticVariate: whether to use antithetic variates for MC simulation
\item ControlVariate: whether to use control variate for MC simulation
\item RequiredSamples: minimum number of samples for MC simulation, if 0 (not specified) RequiredTolerance must be given
\item RequiredTolernace: max tolerance for MC error, if 0 (not specified) RequiredSamples must be given
\item MaxSamples: max number of samples for MC simulation
\item Seed: seed for random number generator
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityAsianOptionArithmeticStrike">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>MCDiscreteArithmeticASEngine</Engine>
    <EngineParameters>
        <Parameter name="BrownianBridge">true</Parameter>    
        <Parameter name="AntitheticVariate">true</Parameter>    
        <Parameter name="ControlVariate">true</Parameter>    
        <Parameter name="RequiredSamples">10000</Parameter>    
        <Parameter name="RequiredTolerance">0</Parameter>    
        <Parameter name="MaxSamples">0</Parameter>    
        <Parameter name="Seed">42</Parameter>    
        <Parameter name="SensitivityTemplate">EQ_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityAsianOptionArithmeticStrike, Model BlackScholesMerton, Engine MCDiscreteArithmeticASEngine}
\label{lst:peconfig_EquityAsianOptionArithmeticStrike_BlackScholesMerton_MCDiscreteArithmeticASEngine}
\end{longlisting}

ScriptedTrade/ScriptedTrade delegates to the scripted trade engine and the associated pricing engine configuration for
Product Type ScriptedTrade, see there for details. A sample configuration is given in listing
\ref{lst:peconfig_EquityAsianOptionArithmeticStrike_ScriptedTrade_ScriptedTrade}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityAsianOptionArithmeticStrike">
    <Model>ScriptedTrade</Model>
    <ModelParameters/>
    <Engine>ScriptedTrade</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">EQ_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityAsianOptionArithmeticStrike, Model ScriptedTrade, Engine ScriptedTrade}
\label{lst:peconfig_EquityAsianOptionArithmeticStrike_ScriptedTrade_ScriptedTrade}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: EquityAsianOptionGeometricPrice}
%--------------------------------------------------------

Used by trade type: EquityAsianOption if payoffType2 is Geometric and payoffType is Asian

Available Model/Engine pairs:

\begin{itemize}
  \item BlackScholesMerton/MCDiscreteGeometricAPEngine
  \item BlackScholesMerton/AnalyticDiscreteGeometricAPEngine
  \item BlackScholesMerton/AnalyticContinuousGeometricAPEngine
  \item ScriptedTrade/ScriptedTrade
\end{itemize}

Engine description:

BlackScholesMerton/MCDiscreteGeometricAPEngine builds a MCDiscreteGeometricAPEngine using Sobol sequences. A sample
configuration is shown in listing
\ref{lst:peconfig_EquityAsianOptionGeometricPrice_BlackScholesMerton_MCDiscreteGeomtetricAPEngine}.

The parameters have the following meaning:

\begin{itemize}
\item BrownianBridge: whether to use Brownian Bridge for MC simulation
\item AntitheticVariate: whether to use antithetic variates for MC simulation
\item ControlVariate: whether to use control variate for MC simulation
\item RequiredSamples: minimum number of samples for MC simulation, if 0 (not specified) RequiredTolerance must be given
\item RequiredTolernace: max tolerance for MC error, if 0 (not specified) RequiredSamples must be given
\item MaxSamples: max number of samples for MC simulation
\item Seed: seed for random number generator
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityAsianOptionGeometricPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>MCDiscreteGeometricAPEngine</Engine>
    <EngineParameters>
        <Parameter name="BrownianBridge">true</Parameter>    
        <Parameter name="AntitheticVariate">true</Parameter>    
        <Parameter name="ControlVariate">true</Parameter>    
        <Parameter name="RequiredSamples">10000</Parameter>    
        <Parameter name="RequiredTolerance">0</Parameter>    
        <Parameter name="MaxSamples">0</Parameter>    
        <Parameter name="Seed">42</Parameter>    
        <Parameter name="SensitivityTemplate">EQ_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityAsianOptionGeometricPrice, Model BlackScholesMerton, Engine MCDiscreteGeometricAPEngine}
\label{lst:peconfig_EquityAsianOptionGeometricPrice_BlackScholesMerton_MCDiscreteGeomtetricAPEngine}
\end{longlisting}

BlackScholesMerton/AnalyticDiscreteGeometricAPEngine builds a AnalyticDiscreteGeometricAveragePriceAsianEngine. A sample
configuration is shown in listing
\ref{lst:peconfig_EquityAsianOptionGeometricPrice_BlackScholesMerton_AnalyticDiscreteGeomtetricAPEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityAsianOptionGeometricPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>AnalyticDiscreteGeometricAPEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">EQ_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityAsianOptionGeometricPrice, Model BlackScholesMerton, Engine AnalyticDiscreteGeomtetricAPEngine}
\label{lst:peconfig_EquityAsianOptionGeometricPrice_BlackScholesMerton_AnalyticDiscreteGeomtetricAPEngine}
\end{longlisting}

BlackScholesMerton/AnalyticContinuousGeometricAPEngine builds a AnalyticContinuousGeometricAveragePriceAsianEngine. A sample
configuration is shown in listing
\ref{lst:peconfig_EquityAsianOptionGeometricPrice_BlackScholesMerton_AnalyticContinuousGeomtetricAPEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityAsianOptionGeometricPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>AnalyticContinuousGeometricAPEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">EQ_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityAsianOptionGeometricPrice, Model BlackScholesMerton, Engine AnalyticContinuousGeomtetricAPEngine}
\label{lst:peconfig_EquityAsianOptionGeometricPrice_BlackScholesMerton_AnalyticContinuousGeomtetricAPEngine}
\end{longlisting}

ScriptedTrade/ScriptedTrade delegates to the scripted trade engine and the associated pricing engine configuration for
Product Type ScriptedTrade, see there for details. A sample configuration is given in listing
\ref{lst:peconfig_EquityAsianOptionGeometricPrice_ScriptedTrade_ScriptedTrade}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityAsianOptionGeometricPrice">
    <Model>ScriptedTrade</Model>
    <ModelParameters/>
    <Engine>ScriptedTrade</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">EQ_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityAsianOptionGeometricPrice, Model ScriptedTrade, Engine ScriptedTrade}
\label{lst:peconfig_EquityAsianOptionGeometricPrice_ScriptedTrade_ScriptedTrade}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: EquityAsianOptionGeometricStrike}
%--------------------------------------------------------

Used by trade type: EquityAsianOption if payoffType2 is Geometric and payoffType is AverageStrike

Available Model/Engine pairs:

\begin{itemize}
  \item BlackScholesMerton/MCDiscreteGeometricASEngine
  \item BlackScholesMerton/AnalyticDiscreteGeometricASEngine
  \item ScriptedTrade/ScriptedTrade
\end{itemize}

Engine description:

BlackScholesMerton/MCDiscreteGeometricASEngine builds a MCDiscreteGeometricASEngine using Sobol sequences. A sample
configuration is shown in listing
\ref{lst:peconfig_EquityAsianOptionGeometricStrike_BlackScholesMerton_MCDiscreteGeomtetricASEngine}.

The parameters have the following meaning:

\begin{itemize}
\item BrownianBridge: whether to use Brownian Bridge for MC simulation
\item AntitheticVariate: whether to use antithetic variates for MC simulation
\item ControlVariate: whether to use control variate for MC simulation
\item RequiredSamples: minimum number of samples for MC simulation, if 0 (not specified) RequiredTolerance must be given
\item RequiredTolernace: max tolerance for MC error, if 0 (not specified) RequiredSamples must be given
\item MaxSamples: max number of samples for MC simulation
\item Seed: seed for random number generator
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityAsianOptionGeometricStrike">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>MCDiscreteGeometricASEngine</Engine>
    <EngineParameters>
        <Parameter name="BrownianBridge">true</Parameter>    
        <Parameter name="AntitheticVariate">true</Parameter>    
        <Parameter name="ControlVariate">true</Parameter>    
        <Parameter name="RequiredSamples">10000</Parameter>    
        <Parameter name="RequiredTolerance">0</Parameter>    
        <Parameter name="MaxSamples">0</Parameter>    
        <Parameter name="Seed">42</Parameter>    
        <Parameter name="SensitivityTemplate">EQ_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityAsianOptionGeometricStrike, Model BlackScholesMerton, Engine MCDiscreteGeometricASEngine}
\label{lst:peconfig_EquityAsianOptionGeometricStrike_BlackScholesMerton_MCDiscreteGeomtetricASEngine}
\end{longlisting}

BlackScholesMerton/AnalyticDiscreteGeometricASEngine builds a AnalyticDiscreteGeometricAverageStrikeAsianEngine. A sample
configuration is shown in listing
\ref{lst:peconfig_EquityAsianOptionGeometricStrike_BlackScholesMerton_AnalyticDiscreteGeomtetricASEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityAsianOptionGeometricStrike">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>AnalyticDiscreteGeometricASEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">EQ_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityAsianOptionGeometricStrike, Model BlackScholesMerton, Engine AnalyticDiscreteGeomtetricASEngine}
\label{lst:peconfig_EquityAsianOptionGeometricStrike_BlackScholesMerton_AnalyticDiscreteGeomtetricASEngine}
\end{longlisting}

ScriptedTrade/ScriptedTrade delegates to the scripted trade engine and the associated pricing engine configuration for
Product Type ScriptedTrade, see there for details. A sample configuration is given in listing
\ref{lst:peconfig_EquityAsianOptionGeometricStrike_ScriptedTrade_ScriptedTrade}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityAsianOptionGeometricStrike">
    <Model>ScriptedTrade</Model>
    <ModelParameters/>
    <Engine>ScriptedTrade</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">EQ_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityAsianOptionGeometricStrike, Model ScriptedTrade, Engine ScriptedTrade}
\label{lst:peconfig_EquityAsianOptionGeometricStrike_ScriptedTrade_ScriptedTrade}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: EquityBarrierOption, FxBarrierOption}
%--------------------------------------------------------

Used by trade type: EquityBarrierOption resp. FxBarrierOption

Available Model/Engine pairs:

\begin{itemize}
\item BlackScholesMerton/AnalyticBarrierEngine
\item BlackScholesMerton/FdBlackScholesBarrierEngine
\end{itemize}

Engine description:

BlackScholes/AnalyticBarrierEngine builds a AnalyticBarrierEngine. A sample configuration is shown in listing
\ref{lst:peconfig_EquityBarrierOption_BlackScholesMerton_AnalyticBarrierEngine} for equity. The configuration for fx is
identical except the Model is set to GarmanKohlhagen.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityBarrierOption">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>AnalyticBarrierEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">EQ_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityBarrierOption, Model BlackScholesMertong Engine AnalyticBarrierEngine}
\label{lst:peconfig_EquityBarrierOption_BlackScholesMerton_AnalyticBarrierEngine}
\end{longlisting}

BlackScholes/FdBlackScholesBarrierEngine builds a FdBlackScholesBarrierEngine. A sample configuration is shown in
listing \ref{lst:peconfig_EquityBarrierOption_BlackScholesMerton_FdBlackScholesBarrierEngine} for equity. The
configuration for fx is identical except the Model is set to GarmanKohlhagen.

The parameters have the following meaning:

\begin{itemize}
\item Scheme: The finite difference scheme to use
\item TimeStepsPerYear: Time grid specification
\item XGrid: State grid specification
\item DampingSteps: Number of damping steps taken by FD solver
\item EnforceMonotoneVariance [optional]: If true variance is modified to be monotone if needed, defaults to true
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityBarrierOption">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>FdBlackScholesBarrierEngine</Engine>
    <EngineParameters>
        <Parameter name="Scheme">Douglas</Parameter>
        <Parameter name="TimeGridPerYear">100</Parameter>
        <Parameter name="XGrid">100</Parameter>
        <Parameter name="DampingSteps">0</Parameter>
        <Parameter name="EnforceMonotoneVariance">true</Parameter>
        <Parameter name="SensitivityTemplate">EQ_FD</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityBarrierOption, Model BlackScholesMerton, Engine FdBlackScholesBarrierEngine}
\label{lst:peconfig_EquityBarrierOption_BlackScholesMerton_FdBlackScholesBarrierEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: EquityDoubleBarrierOption, FxDoubleBarrierOption}
%--------------------------------------------------------

Used by trade type: EquityDoubleBarrierOption, FxDoubleBarrierOption

Available Model/Engine pairs: GarmanKohlhagen/AnalyticDoubleBarrierEngine (both fx and equity)

Engine description:

GarmanKohlhagen/AnalyticDoubleBarrierEngine builds a AnalyticDoubleBarrierEngine. A sample configuration is shown in
listing \ref{lst:peconfig_FxDoubleBarrierOption_GarmanKohlhagen_AnalyticDoubleBarrierEngine}. The configuration for equity
is identical.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxDoubleBarrierOption">
    <Model>GarmanKohlhagen</Model>
    <ModelParameters/>
    <Engine>AnalyticDoubleBarrierEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">FX_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxDoubleBarrierOption, Model GarmanKohlhagen, Engine AnalyticDoubleBarrierBinaryEngine}
\label{lst:peconfig_FxDoubleBarrierOption_GarmanKohlhagen_AnalyticDoubleBarrierEngine}
\end{longlisting}


%--------------------------------------------------------
\subsubsection{Product Type: EquityDigitalOption, FxDigitalOption}
%--------------------------------------------------------

Used by trade type: EquityDigitalOption, FxDigitalOption

Available Model/Engine pairs: BlackScholesMerton/AnalyticEuropeanEngine (equity)
resp. GarmanKohlhagen/AnalyticEuropeanEngine (fx)

Engine description:

BlackScholesMerton/AnalyticEuropeanEngine (equity) resp. GarmanKohlhagen/AnalyticEuropeanEngine (fx) builds a
AnalyticEuropeanEngine. A sample configuration is shown in listing
\ref{lst:peconfig_FxDigitalOption_GarmanKohlhagen_AnalyticEuropeanEngine} for fx. The configuration for equity is
identical except the Model is set to BlackScholesMerton.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
 <Product type="FxDigitalOption">
    <Model>GarmanKohlhagen</Model>
    <ModelParameters/>
    <Engine>AnalyticEuropeanEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">FX_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxDigitalOption, Model GarmanKohlhagen, Engine AnalyticEuropeanEngine}
\label{lst:peconfig_FxDigitalOption_GarmanKohlhagen_AnalyticEuropeanEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: EquityEuropeanCompositeOption}
%--------------------------------------------------------

Used by trade type: EquityOption if a composite option is built

Available Model/Engine pairs: BlackScholes/AnalyticEuropeanEngine

Engine description:

BlackScholes/AnalyticEuropeanEngine builds a AnalyticEuropeanEngine (with a vol composed from the relevant equity and fx
vol surfaces). A sample configuration is shown in listing
\ref{lst:peconfig_EquityEuropeanCompositeOption_BlackScholes_AnalyticEuropeanEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityEuropeanCompositeOption">
    <Model>BlackScholes</Model>
    <ModelParameters/>
    <Engine>AnalyticEuropeanEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">EQ_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityEuropeanCompositeOption, Model BlackScholes, Engine AnalyticEuropeanEngine}
\label{lst:peconfig_EquityEuropeanCompositeOption_BlackScholes_AnalyticEuropeanEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: EquityForward}
%--------------------------------------------------------

Used by trade type: EquityForward

Available Model/Engine pairs: DiscountedCashflows/DiscountingEquityForwardEngine

Engine description:

DiscountedCashflows/DiscountingEquityForwardEngine builds a DiscountingEquityForwardEngine. A sample configuration is
shown in listing \ref{lst:peconfig_EquityForward_DiscountedCashflows_DiscountingEquityForwardEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityForward">
    <Model>DiscountedCashflows</Model>
    <ModelParameters/>
    <Engine>DiscountingEquityForwardEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">EQ_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquiytForward, Model DiscountedCashflows, Engine DiscountingEquityForwardEngine}
\label{lst:peconfig_EquityForward_DiscountedCashflows_DiscountingEquityForwardEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: EquityFutureOption}
%--------------------------------------------------------

Used by trade type: EquityFuturesOption

Available Model/Engine pairs: BlackScholes/AnalyticEuroepanForwardEngine

Engine description:

BlackScholes/AnalyticEuroepanForwardEngine builds a AnalyticEuropeanForwardEngine. A sample configuration is shown in
listing \ref{lst:peconfig_EquityFutureOption_BlackScholes_AnalyticEuropeanForwardEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityFutureOption">
  <Model>BlackScholes</Model>
  <ModelParameters />
  <Engine>AnalyticEuropeanForwardEngine</Engine>
  <EngineParameters>
      <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
  </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquiytFutureOption, Model BlackScholes, Engine AnalyticEuropeanForwardEngine}
\label{lst:peconfig_EquityFutureOption_BlackScholes_AnalyticEuropeanForwardEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: EquityOption}
%--------------------------------------------------------

Used by trade type: EquityOption

Available Model/Engine pairs: BlackScholesMerton/AnalyticEuropeanEngine

Engine description:

BlackScholesMerton/AnalyticEuropeanEngine builds a AnalyticEuropeanEngine. A sample configuration is shown in listing
\ref{lst:peconfig_EquityOption_BlackScholesMerton_AnalyticEuropeanEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityOption">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>AnalyticEuropeanEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityOption, Model BlackScholesMerton, Engine AnalyticEuropeanEngine}
\label{lst:peconfig_EquityOption_BlackScholesMerton_AnalyticEuropeanEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: EquityOptionEuropeanCS}
%--------------------------------------------------------

Used by trade type: EquityOption if cash settled

Available Model/Engine pairs: BlackScholesMerton/AnalyticCashSettledEuropeanEngine

Engine description:

BlackScholesMerton/AnalyticCashSettledEuropeanEngine builds a AnalyticCashSettledEuropeanEngine. A sample configuration is shown in listing
\ref{lst:peconfig_EquityOptionEuropeanCS_BlackScholesMerton_AnalyticCashSettledEuropeanEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityOptionEuropeanCS">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>AnalyticCashSettledEuropeanEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityOptionEuropeanCS, Model BlackScholesMerton, Engine AnalyticCashSettledEuropeanEngine}
\label{lst:peconfig_EquityOptionEuropeanCS_BlackScholesMerton_AnalyticCashSettledEuropeanEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: EquityOptionAmerican}
%--------------------------------------------------------

Used by trade type: EquityOption if exercise stly is american

Available Model/Engine pairs:

\begin{itemize}
\item BlackScholesMerton/FdBlackScholesVanillaEngine
\item BlackScholesMerton/BaroneAdesiWhaleyApproximationEngine
\end{itemize}

Engine description:

BlackScholesMerton/FdBlackScholesVanillaEngine builds a FdBlackScholesVanillaEngine. A sample configuration is shown in listing
\ref{lst:peconfig_EquityOptionAmerican_BlackScholesMerton_FdBlackScholesVanillaEngine}

The parameters have the following meaning:

\begin{itemize}
\item Scheme: The finite difference scheme to use
\item TimeStepsPerYear: Time grid specification
\item XGrid: State grid specification
\item DampingSteps: Number of damping steps taken by FD solver
\item EnforceMonotoneVariance [optional]: If true variance is modified to be monotone if needed, defaults to true
\item TimeGridMinimumSize [optional]: Minimum number in resulting time grid, defaults to $1$ if not given
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityOptionAmerican">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>FdBlackScholesVanillaEngine</Engine>
    <EngineParameters>
        <Parameter name="Scheme">Douglas</Parameter>
        <Parameter name="TimeGridPerYear">100</Parameter>
        <Parameter name="XGrid">100</Parameter>
        <Parameter name="DampingSteps">0</Parameter>
        <Parameter name="EnforceMonotoneVariance">true</Parameter>
        <Parameter name="SensitivityTemplate">COMM_FD</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityOptionAmerican, Model BlackScholesMerton, Engine FdBlackScholesVanillaEngine}
\label{lst:peconfig_EquityOptionAmerican_BlackScholesMerton_FdBlackScholesVanillaEngine}
\end{longlisting}

BlackScholesMerton/BaroneAdesiWhaleyApproximationEngine builds a BaroneAdesiWhaleyApproximationEngine. A sample configuration is shown in listing
\ref{lst:peconfig_EquityOptionAmerican_BlackScholesMerton_BaroneAdesiWhaleyApproximationEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="EquityOptionAmerican">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>BaroneAdesiWhaleyApproximationEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product EquityOptionAmerican, Model BlackScholesMerton, Engine BaroneAdesiWhaleyApproximationEngine}
\label{lst:peconfig_EquityOptionAmerican_BlackScholesMerton_BaroneAdesiWhaleyApproximationEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: EquityTouchOption, FxTouchOption}
%--------------------------------------------------------

Used by trade type: EquityTouchOption, FxTouchOption

Available Model/Engine pairs: BlackScholesMerton/AnalyticDigitalAmericanEngine for equity
resp. GarmanKohlhagen/AnalyticDigitalAmericanEngine for fx

Engine description:

BlackScholesMerton/AnalyticDigitalAmericanEngine (equity) reps. GarmanKohlhagen/AnalyticDigitalAmericanEngine (fx)
builds a AnalyticDigitalAmericanEngine (one touch) or AnalyticDigitalAmericanKOEngine (no touch). A sample configuration
is shown in listing \ref{lst:peconfig_FxTouchOption_GarmanKohlhagen_AnalyticDigitalAmericanEngine} for fx. The
configuration for equity is the same except the Model ist set to BlackScholesMerton.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxTouchOption">
    <Model>GarmanKohlhagen</Model>
    <ModelParameters/>
    <Engine>AnalyticDigitalAmericanEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">FX_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product , Model , Engine }
\label{lst:peconfig_FxTouchOption_GarmanKohlhagen_AnalyticDigitalAmericanEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: EquityVarianceSwap, CommodityVarianceSwap, FxVarianceSwap}
%--------------------------------------------------------

Used by trade type: EquityVarianceSwap, CommodityVarianceSwap, FxVarianceSwap

Available Model/Engine pairs: BlackScholesMerton/EquityVarianceSwap (resp. Commodity, Fx)

Engine description:

BlackScholesMerton/EquityVarianceSwap (resp. Commodity, Fx) builds a GeneralisedReplicatingVarianceSwapEngine or
VolatilityFromVarianceSwapEngine depending on MomentType Variance, Volatility. A sample configuration is shown in
listing \ref{lst:peconfig_EquityVarianceSwap_BlackScholesMerton_ReplicatingVarianceSwapEngine_1} and
\ref{lst:peconfig_EquityVarianceSwap_BlackScholesMerton_ReplicatingVarianceSwapEngine_2}. The example is for Equity, but
holds equally for product types CommodityVarianceSwap, FxVarianceSwap.

The parameters have the following meaning:

\begin{itemize}
\item Scheme [Optional, default GaussLobatto]: GaussLobatto or Segment, this determines the integration scheme used
\item Bounds [Optional, default PriceThreshold]: ``Fixed'': The integration bounds are found by
  
  $$
  \text{Lower} = F e ^ {m \sigma \sqrt{T}},  \text{Upper} = F e ^ {M \sigma \sqrt{T}}
  $$

  where $m$ is the FixedMinStdDevs and $M$ is the FixedMaxStdDevs parameter listed below and $\sigma$ is the ATMF
  volatility of the underlying at maturity $T$.

  ``PriceThreshold'': The integration bounds are found by looking for the largest (smallest) strikes Lower, Upper such
  that the integrand in the replication formula above is below the PriceThreshold parameter listed below. The search
  starts at the forward level $F$ for Lower, Upper and then Lower, Upper are updated by factors $1-p$ resp. $1+p$ where
  $p$ is the PriceThresholdStep parameter below, until either the price threshold criterium is met or the number of
  updates exceeds the MaxPriceThresholdSteps parameter.

\item Accuracy [Optional, default $10^{-5}$]: Numerical accuracy tolerance for the numerical integration. This only
  applies to the GaussLobatto scheme.
\item MaxIterations [Optional, default $1000$]: The maximum number of iterations performed in the numerical
  integration. This only applies to the GaussLobatto scheme.
\item Steps [Optional, default $100$]: The number of steps in the Segment numerical integration scheme (only applies for
  this scheme).
\item PriceThreshold [Optional, default $10^{-10}$]: Used to determine the integration bounds if Bounds = PriceThredshold, see above.
\item MaxPriceThresholdSteps [Optional, default $100$]: Used to determine the integration bounds if Bounds = PriceThredshold, see above.
\item PriceThresholdStep [Option, default $0.1$]: Used to determine the integration bounds if Bounds = PriceThredshold, see above.
\item FixedMinStdDevs [Optional, default $-5$]: Used to determine the integration bounds if Bounds = Fixed, see above.
\item FixedMaxStdDevs [Optional, default $5$]: Used to determine the integration bounds, if Bounds = Fixed, see above.
\item StaticTodaysSpot [Optional, default false]: If true the contribution to the variance from the last day before the
  valuation date to the valuation date is ignored in scenario / sensitivity calculations. See below for more details.
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{listing}[ht]
\begin{minted}[fontsize=\footnotesize]{xml}
  <Product type="EquityVarianceSwap">
    <Model>BlackScholesMerton</Model>
    <ModelParameters>
      <Parameter name="StaticTodaysSpot">false</Parameter>
    </ModelParameters>
    <Engine>ReplicatingVarianceSwapEngine</Engine>
    <EngineParameters>
      <Parameter name="Scheme">Segment</Parameter>
      <Parameter name="Bounds">PriceThreshold</Parameter>
      <Parameter name="Steps">1000</Parameter>
      <Parameter name="PriceThreshold">1E-10</Parameter>
      <Parameter name="MaxPriceThresholdSteps">500</Parameter>
      <Parameter name="PriceThresholdStep">0.1</Parameter>
    </EngineParameters>
  </Product>
\end{minted}
\caption{Configuration for Product EquityVarianceSwap, Model BlackScholesMerton, Engine ReplicatingVarianceSwapEngine,
  ``Robust'' configuration using PriceThreshold if market smiles are of lower quality.}
\label{lst:peconfig_EquityVarianceSwap_BlackScholesMerton_ReplicatingVarianceSwapEngine_1}
\end{listing}

\begin{listing}[ht]
\begin{minted}[fontsize=\footnotesize]{xml}
  <Product type="EquityVarianceSwap">
    <Model>BlackScholesMerton</Model>
    <ModelParameters>
      <Parameter name="StaticTodaysSpot">false</Parameter>
    </ModelParameters>
    <Engine>ReplicatingVarianceSwapEngine</Engine>
    <EngineParameters>
      <Parameter name="Scheme">Segment</Parameter>
      <Parameter name="Bounds">Fixed</Parameter>
      <Parameter name="Steps">1000</Parameter>
      <Parameter name="FixedMinStdDevs">-5.0</Parameter>
      <Parameter name="FixedMaxStdDevs">5.0</Parameter>
    </EngineParameters>
  </Product>
\end{minted}
\caption{Configuration for Product EquityVarianceSwap, Model BlackScholesMerton, Engine ReplicatingVarianceSwapEngine,
  Alternative ``Robust'' variance swap pricing engine configuration using fixed integration bounds.}
\label{lst:peconfig_EquityVarianceSwap_BlackScholesMerton_ReplicatingVarianceSwapEngine_2}
\end{listing}

%--------------------------------------------------------
\subsubsection{Product Type: FxAsianOptionArithmeticPrice}
%--------------------------------------------------------

Used by trade type: FxAsianOption if payoffType2 is Arithmetric and payoffType is Asian

Available Model/Engine pairs:

\begin{itemize}
  \item BlackScholesMerton/MCDiscreteArithmeticAPEngine
  \item BlackScholesMerton/TurnbullWakemanAsianEngine
  \item ScriptedTrade/ScriptedTrade
\end{itemize}

Engine description:

BlackScholesMerton/MCDiscreteArithmeticAPEngine builds a MCDiscreteArithmeticAPEngine using Sobol sequences. A sample
configuration is shown in listing
\ref{lst:peconfig_FxAsianOptionArithmeticPrice_BlackScholesMerton_MCDiscreteArithmeticAPEngine}.

The parameters have the following meaning:

\begin{itemize}
\item BrownianBridge: whether to use Brownian Bridge for MC simulation
\item AntitheticVariate: whether to use antithetic variates for MC simulation
\item ControlVariate: whether to use control variate for MC simulation
\item RequiredSamples: minimum number of samples for MC simulation, if 0 (not specified) RequiredTolerance must be given
\item RequiredTolernace: max tolerance for MC error, if 0 (not specified) RequiredSamples must be given
\item MaxSamples: max number of samples for MC simulation
\item Seed: seed for random number generator
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxAsianOptionArithmeticPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>MCDiscreteArithmeticAPEngine</Engine>
    <EngineParameters>
        <Parameter name="BrownianBridge">true</Parameter>    
        <Parameter name="AntitheticVariate">true</Parameter>    
        <Parameter name="ControlVariate">true</Parameter>    
        <Parameter name="RequiredSamples">10000</Parameter>    
        <Parameter name="RequiredTolerance">0</Parameter>    
        <Parameter name="MaxSamples">0</Parameter>    
        <Parameter name="Seed">42</Parameter>    
        <Parameter name="SensitivityTemplate">FX_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxAsianOptionArithmeticPrice, Model BlackScholesMerton, Engine MCDiscreteArithmeticAPEngine}
\label{lst:peconfig_FxAsianOptionArithmeticPrice_BlackScholesMerton_MCDiscreteArithmeticAPEngine}
\end{longlisting}

BlackScholesMerton/TurnbullWakemanAsianEngine builds a TurnbullWakemanAsianEngine. A sample configuration is shown in
listing \ref{lst:peconfig_FxAsianOptionArithmeticPrice_BlackScholesMerton_TurnbullWakemanAsianEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxAsianOptionArithmeticPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>TurnbullWakemanAsianEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">FX_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxAsianOptionArithmeticPrice, Model BlackScholesMerton, Engine TurnbullWakemanAsianEngine}
\label{lst:peconfig_FxAsianOptionArithmeticPrice_BlackScholesMerton_TurnbullWakemanAsianEngine}
\end{longlisting}

ScriptedTrade/ScriptedTrade delegates to the scripted trade engine and the associated pricing engine configuration for
Product Type ScriptedTrade, see there for details. A sample configuration is given in listing
\ref{lst:peconfig_FxAsianOptionArithmeticPrice_ScriptedTrade_ScriptedTrade}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxAsianOptionArithmeticPrice">
    <Model>ScriptedTrade</Model>
    <ModelParameters/>
    <Engine>ScriptedTrade</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">FX_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxAsianOptionArithmeticPrice, Model ScriptedTrade, Engine ScriptedTrade}
\label{lst:peconfig_FxAsianOptionArithmeticPrice_ScriptedTrade_ScriptedTrade}
\end{longlisting}


%--------------------------------------------------------
\subsubsection{Product Type: FxAsianOptionArithmeticStrike}
%--------------------------------------------------------

Used by trade type: FxAsianOption if payoffType2 is Arithmetric and payoffType is AverageStrike

Available Model/Engine pairs:

\begin{itemize}
\item BlackScholesMerton/MCDiscreteArithmeticASEngine
\item ScriptedTrade/ScriptedTrade
\end{itemize}
  
Engine description:

BlackScholesMerton/MCDiscreteArithmeticASEngine builds a MCDiscreteArithmeticASEngine using Sobol sequences. A sample
configuration is shown in listing
\ref{lst:peconfig_FxAsianOptionArithmeticStrike_BlackScholesMerton_MCDiscreteArithmeticASEngine}.

The parameters have the following meaning:

\begin{itemize}
\item BrownianBridge: whether to use Brownian Bridge for MC simulation
\item AntitheticVariate: whether to use antithetic variates for MC simulation
\item ControlVariate: whether to use control variate for MC simulation
\item RequiredSamples: minimum number of samples for MC simulation, if 0 (not specified) RequiredTolerance must be given
\item RequiredTolernace: max tolerance for MC error, if 0 (not specified) RequiredSamples must be given
\item MaxSamples: max number of samples for MC simulation
\item Seed: seed for random number generator
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxAsianOptionArithmeticStrike">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>MCDiscreteArithmeticASEngine</Engine>
    <EngineParameters>
        <Parameter name="BrownianBridge">true</Parameter>    
        <Parameter name="AntitheticVariate">true</Parameter>    
        <Parameter name="ControlVariate">true</Parameter>    
        <Parameter name="RequiredSamples">10000</Parameter>    
        <Parameter name="RequiredTolerance">0</Parameter>    
        <Parameter name="MaxSamples">0</Parameter>    
        <Parameter name="Seed">42</Parameter>    
        <Parameter name="SensitivityTemplate">FX_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxAsianOptionArithmeticStrike, Model BlackScholesMerton, Engine MCDiscreteArithmeticASEngine}
\label{lst:peconfig_FxAsianOptionArithmeticStrike_BlackScholesMerton_MCDiscreteArithmeticASEngine}
\end{longlisting}

ScriptedTrade/ScriptedTrade delegates to the scripted trade engine and the associated pricing engine configuration for
Product Type ScriptedTrade, see there for details. A sample configuration is given in listing
\ref{lst:peconfig_FxAsianOptionArithmeticStrike_ScriptedTrade_ScriptedTrade}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxAsianOptionArithmeticStrike">
    <Model>ScriptedTrade</Model>
    <ModelParameters/>
    <Engine>ScriptedTrade</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">FX_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxAsianOptionArithmeticStrike, Model ScriptedTrade, Engine ScriptedTrade}
\label{lst:peconfig_FxAsianOptionArithmeticStrike_ScriptedTrade_ScriptedTrade}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: FxAsianOptionGeometricPrice}
%--------------------------------------------------------

Used by trade type: FxAsianOption if payoffType2 is Geometric and payoffType is Asian

Available Model/Engine pairs:

\begin{itemize}
  \item BlackScholesMerton/MCDiscreteGeometricAPEngine
  \item BlackScholesMerton/AnalyticDiscreteGeometricAPEngine
  \item BlackScholesMerton/AnalyticContinuousGeometricAPEngine
  \item ScriptedTrade/ScriptedTrade
\end{itemize}

Engine description:

BlackScholesMerton/MCDiscreteGeometricAPEngine builds a MCDiscreteGeometricAPEngine using Sobol sequences. A sample
configuration is shown in listing
\ref{lst:peconfig_FxAsianOptionGeometricPrice_BlackScholesMerton_MCDiscreteGeomtetricAPEngine}.

The parameters have the following meaning:

\begin{itemize}
\item BrownianBridge: whether to use Brownian Bridge for MC simulation
\item AntitheticVariate: whether to use antithetic variates for MC simulation
\item ControlVariate: whether to use control variate for MC simulation
\item RequiredSamples: minimum number of samples for MC simulation, if 0 (not specified) RequiredTolerance must be given
\item RequiredTolernace: max tolerance for MC error, if 0 (not specified) RequiredSamples must be given
\item MaxSamples: max number of samples for MC simulation
\item Seed: seed for random number generator
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxAsianOptionGeometricPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>MCDiscreteGeometricAPEngine</Engine>
    <EngineParameters>
        <Parameter name="BrownianBridge">true</Parameter>    
        <Parameter name="AntitheticVariate">true</Parameter>    
        <Parameter name="ControlVariate">true</Parameter>    
        <Parameter name="RequiredSamples">10000</Parameter>    
        <Parameter name="RequiredTolerance">0</Parameter>    
        <Parameter name="MaxSamples">0</Parameter>    
        <Parameter name="Seed">42</Parameter>    
        <Parameter name="SensitivityTemplate">FX_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxAsianOptionGeometricPrice, Model BlackScholesMerton, Engine MCDiscreteGeometricAPEngine}
\label{lst:peconfig_FxAsianOptionGeometricPrice_BlackScholesMerton_MCDiscreteGeomtetricAPEngine}
\end{longlisting}

BlackScholesMerton/AnalyticDiscreteGeometricAPEngine builds a AnalyticDiscreteGeometricAveragePriceAsianEngine. A sample
configuration is shown in listing
\ref{lst:peconfig_FxAsianOptionGeometricPrice_BlackScholesMerton_AnalyticDiscreteGeomtetricAPEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxAsianOptionGeometricPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>AnalyticDiscreteGeometricAPEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">FX_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxAsianOptionGeometricPrice, Model BlackScholesMerton, Engine AnalyticDiscreteGeomtetricAPEngine}
\label{lst:peconfig_FxAsianOptionGeometricPrice_BlackScholesMerton_AnalyticDiscreteGeomtetricAPEngine}
\end{longlisting}

BlackScholesMerton/AnalyticContinuousGeometricAPEngine builds a AnalyticContinuousGeometricAveragePriceAsianEngine. A sample
configuration is shown in listing
\ref{lst:peconfig_FxAsianOptionGeometricPrice_BlackScholesMerton_AnalyticContinuousGeomtetricAPEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxAsianOptionGeometricPrice">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>AnalyticContinuousGeometricAPEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">FX_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxAsianOptionGeometricPrice, Model BlackScholesMerton, Engine AnalyticContinuousGeomtetricAPEngine}
\label{lst:peconfig_FxAsianOptionGeometricPrice_BlackScholesMerton_AnalyticContinuousGeomtetricAPEngine}
\end{longlisting}

ScriptedTrade/ScriptedTrade delegates to the scripted trade engine and the associated pricing engine configuration for
Product Type ScriptedTrade, see there for details. A sample configuration is given in listing
\ref{lst:peconfig_FxAsianOptionGeometricPrice_ScriptedTrade_ScriptedTrade}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxAsianOptionGeometricPrice">
    <Model>ScriptedTrade</Model>
    <ModelParameters/>
    <Engine>ScriptedTrade</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">FX_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxAsianOptionGeometricPrice, Model ScriptedTrade, Engine ScriptedTrade}
\label{lst:peconfig_FxAsianOptionGeometricPrice_ScriptedTrade_ScriptedTrade}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: FxAsianOptionGeometricStrike}
%--------------------------------------------------------

Used by trade type: FxAsianOption if payoffType2 is Geometric and payoffType is AverageStrike

Available Model/Engine pairs:

\begin{itemize}
  \item BlackScholesMerton/MCDiscreteGeometricASEngine
  \item BlackScholesMerton/AnalyticDiscreteGeometricASEngine
  \item ScriptedTrade/ScriptedTrade
\end{itemize}

Engine description:

BlackScholesMerton/MCDiscreteGeometricASEngine builds a MCDiscreteGeometricASEngine using Sobol sequences. A sample
configuration is shown in listing
\ref{lst:peconfig_FxAsianOptionGeometricStrike_BlackScholesMerton_MCDiscreteGeomtetricASEngine}.

The parameters have the following meaning:

\begin{itemize}
\item BrownianBridge: whether to use Brownian Bridge for MC simulation
\item AntitheticVariate: whether to use antithetic variates for MC simulation
\item ControlVariate: whether to use control variate for MC simulation
\item RequiredSamples: minimum number of samples for MC simulation, if 0 (not specified) RequiredTolerance must be given
\item RequiredTolernace: max tolerance for MC error, if 0 (not specified) RequiredSamples must be given
\item MaxSamples: max number of samples for MC simulation
\item Seed: seed for random number generator
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxAsianOptionGeometricStrike">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>MCDiscreteGeometricASEngine</Engine>
    <EngineParameters>
        <Parameter name="BrownianBridge">true</Parameter>    
        <Parameter name="AntitheticVariate">true</Parameter>    
        <Parameter name="ControlVariate">true</Parameter>    
        <Parameter name="RequiredSamples">10000</Parameter>    
        <Parameter name="RequiredTolerance">0</Parameter>    
        <Parameter name="MaxSamples">0</Parameter>    
        <Parameter name="Seed">42</Parameter>    
        <Parameter name="SensitivityTemplate">FX_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxAsianOptionGeometricStrike, Model BlackScholesMerton, Engine MCDiscreteGeometricASEngine}
\label{lst:peconfig_FxAsianOptionGeometricStrike_BlackScholesMerton_MCDiscreteGeomtetricASEngine}
\end{longlisting}

BlackScholesMerton/AnalyticDiscreteGeometricASEngine builds a AnalyticDiscreteGeometricAverageStrikeAsianEngine. A sample
configuration is shown in listing
\ref{lst:peconfig_FxAsianOptionGeometricStrike_BlackScholesMerton_AnalyticDiscreteGeomtetricASEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxAsianOptionGeometricStrike">
    <Model>BlackScholesMerton</Model>
    <ModelParameters/>
    <Engine>AnalyticDiscreteGeometricASEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">FX_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxAsianOptionGeometricStrike, Model BlackScholesMerton, Engine AnalyticDiscreteGeomtetricASEngine}
\label{lst:peconfig_FxAsianOptionGeometricStrike_BlackScholesMerton_AnalyticDiscreteGeomtetricASEngine}
\end{longlisting}

ScriptedTrade/ScriptedTrade delegates to the scripted trade engine and the associated pricing engine configuration for
Product Type ScriptedTrade, see there for details. A sample configuration is given in listing
\ref{lst:peconfig_FxAsianOptionGeometricStrike_ScriptedTrade_ScriptedTrade}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxAsianOptionGeometricStrike">
    <Model>ScriptedTrade</Model>
    <ModelParameters/>
    <Engine>ScriptedTrade</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">FX_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxAsianOptionGeometricStrike, Model ScriptedTrade, Engine ScriptedTrade}
\label{lst:peconfig_FxAsianOptionGeometricStrike_ScriptedTrade_ScriptedTrade}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: FxDigitalOptionEuropeanCS}
%--------------------------------------------------------

Used by trade type: FxDigitalOption if cash settled, FxEuropeanBarrierOption

Available Model/Engine pairs: GarmanKohlhagen/AnalyticCashSettledEuropeanEngine

Engine description:

GarmanKohlhagen/AnalyticCashSettledEuropeanEngine builds a AnalyticCashSettledEuropeanEngine. A sample configuration is
shown in listing \ref{lst:peconfig_FxDigitalOptionEuropeanCS_GarmanKohlhagen_AnalyticCashSettledEuropeanEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxDigitalOptionEuropeanCS">
    <Model>GarmanKohlhagen</Model>
    <ModelParameters/>
    <Engine>AnalyticCashSettledEuropeanEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">FX_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxDigitalOptionEuropeanCS, Model GarmanKohlhagen, Engine AnalyticCashSettledEuropeanEngine}
\label{lst:peconfig_FxDigitalOptionEuropeanCS_GarmanKohlhagen_AnalyticCashSettledEuropeanEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: FxDigitalBarrierOption}
%--------------------------------------------------------

Used by trade type: FxDigitalBarrierOption

Available Model/Engine pairs: GarmanKohlhagen/FdBlackScholesBarrierEngine

Engine description:

GarmanKohlhagen/FdBlackScholesBarrierEngine builds a FdBlackScholesBarrierEngine. A sample configuration is shown in
listing \ref{lst:peconfig_FxDigitalBarrierOption_GarmanKohlhagen_FdBlackScholesBarrierEngine}

The parameters have the following meaning:

\begin{itemize}
\item Scheme: The finite difference scheme to use
\item TimeStepsPerYear: Time grid specification
\item XGrid: State grid specification
\item DampingSteps: Number of damping steps taken by FD solver
\item EnforceMonotoneVariance [optional]: If true variance is modified to be monotone if needed, defaults to true
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxDigitalBarrierOption">
    <Model>GarmanKohlhagen</Model>
    <ModelParameters/>
    <Engine>FdBlackScholesBarrierEngine</Engine>
    <EngineParameters>
        <Parameter name="Scheme">Douglas</Parameter>
        <Parameter name="TimeGridPerYear">100</Parameter>
        <Parameter name="XGrid">100</Parameter>
        <Parameter name="DampingSteps">0</Parameter>
        <Parameter name="SensitivityTemplate">FX_FD</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxDigitalBarrierOption, Model GarmanKohlhagen, Engine FdBlackScholesBarrierEngine}
\label{lst:peconfig_FxDigitalBarrierOption_GarmanKohlhagen_FdBlackScholesBarrierEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: FxForward}
%--------------------------------------------------------

Used by trade type: FxForward

Available Model/Engine pairs:

\begin{itemize}
\item DiscountedCashflows/DiscountingFxForwardEngine
\item CrossAssetModel/AMC (for use in AMC simulations only)
\end{itemize}

Engine description:

DiscountedCashflows/DiscountingFxForwardEngine builds a DiscountingFxForwardEngine. A sample configuration is shown in
listing \ref{lst:peconfig_FxForward_DiscountedCashflows_DiscountingFxForwardEngine}.

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxForward">
    <Model>DiscountedCashflows</Model>
    <ModelParameters/>
    <Engine>DiscountingFxForwardEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">FX_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxForward, Model DiscountedCashflows, Engine DiscountingFxForwardEngine}
\label{lst:peconfig_FxForward_DiscountedCashflows_DiscountingFxForwardEngine}
\end{longlisting}

CrossAssetModel/AMC builds a McCamFxForwardEngine for use in AMC simulations. We refer to the AMC module documentation
for further details.

%--------------------------------------------------------
\subsubsection{Product Type: FxOption}
%--------------------------------------------------------

Used by trade type: FxOption

Available Model/Engine pairs:

\begin{itemize}
\item GarmanKohlhagen/AnalyticEuropeanEngine
\item CrossAssetModel/AMC (for use in AMC simulations only)
\end{itemize}

Engine description:

GarmanKohlhagen/AnalyticEuropeanEngine builds a AnalyticEuropeanEngine. A sample configuration is shown in listing
\ref{lst:peconfig_FxOption_GarmanKohlhagen_AnalyticEuropeanEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxOption">
    <Model>GarmanKohlhagen</Model>
    <ModelParameters/>
    <Engine>AnalyticEuropeanEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxOption, Model GarmanKohlhagen, Engine AnalyticEuropeanEngine}
\label{lst:peconfig_FxOption_GarmanKohlhagen_AnalyticEuropeanEngine}
\end{longlisting}

CrossAssetModel/AMC builds a McCamFxOptionEngine for use in AMC simulations. We refer to the AMC module documentation
for further details.

%--------------------------------------------------------
\subsubsection{Product Type: FxOptionEuropeanCS}
%--------------------------------------------------------

Used by trade type: FxOption if cash settled

Available Model/Engine pairs: GarmanKohlhagen/AnalyticCashSettledEuropeanEngine

Engine description:

GarmanKohlhagen/AnalyticCashSettledEuropeanEngine builds a AnalyticCashSettledEuropeanEngine. A sample configuration is shown in listing
\ref{lst:peconfig_FxOptionEuropeanCS_GarmanKohlhagen_AnalyticCashSettledEuropeanEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxOptionEuropeanCS">
    <Model>GarmanKohlhagen</Model>
    <ModelParameters/>
    <Engine>AnalyticCashSettledEuropeanEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxOptionEuropeanCS, Model GarmanKohlhagen, Engine AnalyticCashSettledEuropeanEngine}
\label{lst:peconfig_FxOptionEuropeanCS_GarmanKohlhagen_AnalyticCashSettledEuropeanEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: FxOptionAmerican}
%--------------------------------------------------------

Used by trade type: FxOption if exercise stly is american

Available Model/Engine pairs:

\begin{itemize}
\item GarmanKohlhagen/FdGarmanKohlhagenVanillaEngine
\item GarmanKohlhagen/BaroneAdesiWhaleyApproximationEngine
\end{itemize}

Engine description:

GarmanKohlhagen/FdBlackScholesVanillaEngine builds a FdBlackScholesVanillaEngine. A sample configuration is shown in listing
\ref{lst:peconfig_FxOptionAmerican_GarmanKohlhagen_FdBlackScholesVanillaEngine}

The parameters have the following meaning:

\begin{itemize}
\item Scheme: The finite difference scheme to use
\item TimeStepsPerYear: Time grid specification
\item XGrid: State grid specification
\item DampingSteps: Number of damping steps taken by FD solver
\item EnforceMonotoneVariance [optional]: If true variance is modified to be monotone if needed, defaults to true
\item TimeGridMinimumSize [optional]: Minimum number in resulting time grid, defaults to $1$ if not given
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxOptionAmerican">
    <Model>GarmanKohlhagen</Model>
    <ModelParameters/>
    <Engine>FdBlackScholesVanillaEngine</Engine>
    <EngineParameters>
        <Parameter name="Scheme">Douglas</Parameter>
        <Parameter name="TimeGridPerYear">100</Parameter>
        <Parameter name="XGrid">100</Parameter>
        <Parameter name="DampingSteps">0</Parameter>
        <Parameter name="EnforceMonotoneVariance">true</Parameter>
        <Parameter name="SensitivityTemplate">COMM_FD</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxOptionAmerican, Model GarmanKohlhagen, Engine FdBlackScholesVanillaEngine}
\label{lst:peconfig_FxOptionAmerican_GarmanKohlhagen_FdBlackScholesVanillaEngine}
\end{longlisting}

GarmanKohlhagen/BaroneAdesiWhaleyApproximationEngine builds a BaroneAdesiWhaleyApproximationEngine. A sample configuration is shown in listing
\ref{lst:peconfig_FxOptionAmerican_GarmanKohlhagen_BaroneAdesiWhaleyApproximationEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxOptionAmerican">
    <Model>GarmanKohlhagen</Model>
    <ModelParameters/>
    <Engine>BaroneAdesiWhaleyApproximationEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">COMM_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxOptionAmerican, Model GarmanKohlhagen, Engine BaroneAdesiWhaleyApproximationEngine}
\label{lst:peconfig_FxOptionAmerican_GarmanKohlhagen_BaroneAdesiWhaleyApproximationEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: FxDoubleTouchOption}
%--------------------------------------------------------

Used by trade type: FxDoubleTouchOption

Available Model/Engine pairs: GarmanKohlhagen/AnalyticDoubleBarrierBinaryEngine

Engine description:

GarmanKohlhagen/AnalyticDoubleBarrierBinaryEngine builds a AnalyticDoubleBarrierBinaryEngine. A sample configuration is
shown in listing \ref{lst:peconfig_FxDoubleTouchOption_GarmanKohlhagen_AnalyticDoubleBarrierBinaryEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="FxDoubleTouchOption">
    <Model>GarmanKohlhagen</Model>
    <ModelParameters/>
    <Engine>AnalyticDoubleBarrierBinaryEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">FX_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product FxDoubleTouchOption, Model GarmanKohlhagen, Engine AnalyticDoubleBarrierBinaryEngine}
\label{lst:peconfig_FxDoubleTouchOption_GarmanKohlhagen_AnalyticDoubleBarrierBinaryEngine}
\end{longlisting}

%--------------------------------------------------------
\subsubsection{Product Type: MultiLegOption}
%--------------------------------------------------------

Used by trade type: MultiLegOption

Available Model/Engine pairs:

\begin{itemize}
\item CrossAssetModel/MC
\item CrossAssetModel/AMC
\end{itemize}

Engine description:

CrossAssetModel/MC builds a McMultiLegOptionEngine. A sample configuration is shown in listing
\ref{lst:peconfig_MultiLegOption_CrossAssetModel_MC}

The parameters have the following meaning:

\begin{itemize}
\item IrCalibration: Bootstrap, BestFit, None
\item IrCalibrationStrategy: CoterminalDealStrike, CoterminalATM
\item ReferenceCalibrationGrid: An optional grid, only one calibration instrument per interval is kept
\item IrReversion: The mean reversion (given per ccy)
\item IrReversionType: Hagan, HullWhite (given per ccy)
\item IrVolatility: The volatility (start value for calibration if calibrated, given per ccy)
\item IrVolatilityType: Hagan, HullWhite (given per ccy)
\item FxVolatility: The fx volatility (start value for calibration if calibrated, given per ccy)
\item Corr\_Key1\_key2: The correlations for ir/fx keys (multiple entries possible)
\item ShiftHorizon: Shift horizon for LGM model as fraction of deal maturity
\item Tolerance: Error tolerance for calibration
\item Training.Sequence: The sequence type for the traning phase, can be MersenneTwister+, MersenneTwisterAntithetc+,
  Sobol+, Burley2020Sobol+, SobolBrownianBridge+, Burley2020SobolBrownianBridge+
\item Training.Seed: The seed for the random number generation in the training phase
\item Training.Samples: The number of samples to be used for the training phase
\item Pricing.Sequence: The sequence type for the pricing phase, same values allowed as for training
\item Training.BasisFunction: The type of basis function system to be used for the regression analysis, can be
  Monomial+, Laguerre+, Hermite+, Hyperbolic+, Legendre+, Chbyshev+, Chebyshev2nd+
\item BasisFunctionOrder: The order of the basis function system to be used
\item Pricing.Seed: The seed for the random number generation in the pricing
\item Pricing.Samples: The number of samples to be used for the pricing phase. If this number is zero, no pricing run is
  performed, instead the (T0) NPV is estimated from the training phase (this result is used to fill the T0 slice of the
  NPV cube)
\item BrownianBridgeOrdering: variate ordering for Brownian bridges, can be Steps+, Factors+, Diagonal+
\item SobolDirectionIntegers: direction integers for Sobol generator, can be Unit+, Jaeckel+, SobolLevitan+,
  SobolLevitanLemieux+, JoeKuoD5+, JoeKuoD6+, JoeKuoD7+, Kuo+, Kuo2+, Kuo3+
\item MinObsDate: if true the conditional expectation of each cashflow is taken from the minimum possible observation
  date (i.e. the latest exercise or simulation date before the cashflow's event date); recommended setting is true+
\item RegressorModel: Simple, LaggedFX. If not given, it defaults to Simple. Depending on the choice the regressor is
  built as follows:
  \begin{itemize}
    \item Simple: For an observation date the full model state observed on this date is included in the regressor. No
      past states are included though.
    \item LaggedFX: For an observation date the full model state observed on this date is included in the regressor. In
      addition, past FX states that are relevant for future cashflows are included. For example, for a FX resettable
      cashflow the FX state observed on the FX reset date is included.
  \end{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="MultiLegOption">
    <Model>CrossAssetModel</Model>
    <ModelParameters>
        <Parameter name="IrCalibration">Bootstrap</Parameter>
        <Parameter name="IrCalibrationStrategy">CoterminalDealStrike</Parameter>
        <Parameter name="FxCalibration">Bootstrap</Parameter>
        <Parameter name="ReferenceCalibrationGrid">400,3M</Parameter>
        <Parameter name="IrReversion_EUR">0.0</Parameter>
        <Parameter name="IrReversionType_EUR">HullWhite</Parameter>
        <Parameter name="IrVolatility_EUR">0.01</Parameter>
        <Parameter name="IrVolatilityType_EUR">Hagan</Parameter>
        <Parameter name="IrReversion_GBP">0.0</Parameter>
        <Parameter name="IrReversionType_GBP">HullWhite</Parameter>
        <Parameter name="IrVolatility_GBP">0.01</Parameter>
        <Parameter name="IrVolatilityType_GBP">Hagan</Parameter>
        <Parameter name="FxVolatility_GBP">0.08</Parameter>
        <Parameter name="Corr_IR:EUR_FX:GBP">0.23</Parameter>
        <Parameter name="ShiftHorizon">0.5</Parameter>
        <Parameter name="Tolerance">0.20</Parameter>
    </ModelParameters>
    <Engine>MC</Engine>
    <EngineParameters>
        <Parameter name="Training.Sequence">MersenneTwisterAntithetic</Parameter>
        <Parameter name="Training.Seed">42</Parameter>
        <Parameter name="Training.Samples">10000</Parameter>
        <Parameter name="Training.BasisFunction">Monomial</Parameter>
        <Parameter name="Training.BasisFunctionOrder">6</Parameter>
        <Parameter name="Pricing.Sequence">SobolBrownianBridge</Parameter>
        <Parameter name="Pricing.Seed">17</Parameter>
        <Parameter name="Pricing.Samples">0</Parameter>
        <Parameter name="BrownianBridgeOrdering">Steps</Parameter>
        <Parameter name="SobolDirectionIntegers">JoeKuoD7</Parameter>
        <Parameter name="MinObsDate">true</Parameter>
        <Parameter name="RegressorModel">Simple</Parameter>
        <Parameter name="SensitivityTemplate">IR_MC</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product MultiLegSwaption, Model CrossAssetModel, Engine MC}
\label{lst:peconfig_MultiLegOption_CrossAssetModel_MC}
\end{longlisting}

LGM/AMC builds a McMultiLegOptionEngine for use in AMC simulations. We refer to the AMC module documentation for further
details.

%--------------------------------------------------------
\subsubsection{Product Type: Swap}
%--------------------------------------------------------

Used by trade type: Swap for single-currency swaps

Available Model/Engine pairs:

\begin{itemize}
\item DiscountedCashflows/DiscountingSwapEngine
\item DiscountedCashflows/DiscountingSwapEngineOptimised  
\item CrossAssetModel/AMC
\end{itemize}

Engine description:

DiscountedCashflows/DiscountingSwapEngine builds a DiscountingSwapEngine. A sample configuration is shown in listing
\ref{lst:peconfig_Swap_DiscountedCashflows_DiscountingSwapEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="Swap">
    <Model>DiscountedCashflows</Model>
    <ModelParameters/>
    <Engine>DiscountingSwapEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product Swap, Model DiscountedCashflows, Engine DiscountingSwapEngine}
\label{lst:peconfig_Swap_DiscountedCashflows_DiscountingSwapEngine}
\end{longlisting}

DiscountedCashflows/DiscountingSwapEngineOptimised builds a DiscountingSwapEngineOptimised. This is a speed-optimized
version of the DiscountingSwapEngine. In general, results should be validated against DiscountingSwapEngine.A sample
configuration is shown in listing \ref{lst:peconfig_Swap_DiscountedCashflows_DiscountingSwapEngineOptimised}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="Swap">
    <Model>DiscountedCashflows</Model>
    <ModelParameters/>
    <Engine>DiscountingSwapEngineOptimised</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product Swap, Model DiscountedCashflows, Engine DiscountingSwapEngineOptimised}
\label{lst:peconfig_Swap_DiscountedCashflows_DiscountingSwapEngineOptimised}
\end{longlisting}

CrossAssetModel/AMC builds a McLgmSwapEngine for use in AMC simulations. We refer to the AMC module documentation for
further details.

%--------------------------------------------------------
\subsubsection{Product Type: CurrencySwap}
%--------------------------------------------------------

Used by trade type: Swap for cross-currency swaps

Available Model/Engine pairs:

\begin{itemize}
\item DiscountedCashflows/DiscountingCrossCurrencySwapEngine
\item CrossAssetModel/AMC
\end{itemize}

Engine description:

DiscountedCashflows/DiscountingCrossCurrencySwapEngine builds a DiscountingCurrencySwapEngine. A sample configuration is
shown in listing \ref{lst:peconfig_Swap_DiscountedCashflows_DiscountingCurrencySwapEngine}

The parameters have the following meaning:

\begin{itemize}
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}
<Product type="CurrencySwap">
    <Model>DiscountedCashflows</Model>
    <ModelParameters/>
    <Engine>DiscountingCurrencySwapEngine</Engine>
    <EngineParameters>
        <Parameter name="SensitivityTemplate">IR_Analytical</Parameter>
    </EngineParameters>
</Product>
\end{minted}
\caption{Configuration for Product Swap, Model DiscountedCashflows, Engine DiscountingCurrencySwapEngine}
\label{lst:peconfig_Swap_DiscountedCashflows_DiscountingCurrencySwapEngine}
\end{longlisting}

CrossAssetModel/AMC builds a McCamCurrencySwapEngine for use in AMC simulations. We refer to the AMC module
documentation for further details.

% ===================== template ========================

%--------------------------------------------------------
\subsubsection{Product Type: }
%--------------------------------------------------------

Used by trade type:

Available Model/Engine pairs:

Engine description:

 builds a . A sample configuration is shown in listing \ref{lst:peconfig_}

The parameters have the following meaning:

\begin{itemize}
\item 
\item SensitivityTemplate [optional]: the sensitivity template to use 
\end{itemize}

\begin{longlisting}
\begin{minted}[fontsize=\footnotesize]{xml}

\end{minted}
\caption{Configuration for Product , Model , Engine }
\label{lst:peconfig_}
\end{longlisting}



%--------------------------------------------------------
\subsubsection{Global Parameters}
%--------------------------------------------------------

In addition to product specific settings there is also a block with global parameters with the following meaning:

\begin{itemize}
\item ContinueOnCalibrationError: If set to true an exceedence of a prescribed model calibration tolerance (for e.g. the
  LGM model) will not cause the trade building to fail, instead a warning is logged and the trade is processed
  anyway. Optional, defaults to false.
\item Calibrate: If false, model calibration is disabled. This flag is usually not present in a user configuration, but
  only used internally for certain workflows within ORE which do not require a model calibration. Optional, defaults to
  true.
\item GenerateAdditionalResults: If false, the generation of additional results within pricing engines will be
  suppressed (for those pricing engines which support this). This flag is usually not present in a user configuration,
  but only used internally to improve the performance for processes which only rely on the NPV as a result from pricing
  engines, e.g. when repricing trades under sensitivity or stress scenarios. Option, defaults to false.
\item RunType: Set automatically. One of NPV, SensitivityDelta, SensitivityDeltaGamma, Stress, Exposure, Capital,
  TradeDetails, PortfolioAnalyser, HistoricalPnL, BondSpreadImply, AbsMaturityUpdate depending on the context for which
  a portfolio was built. Might also be left empty. This is used by some pricing engines to adapt to certain run
  types. E.g. a first order sensitivity pnl expansion might be used for a SensitivityDelta run by an engine which is
  able to compute analytical or AAD first order sensitivities.
\end{itemize}
